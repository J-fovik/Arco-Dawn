import{n as u,d as T,q as ee,E as te,s as ae,v as oe,M as ne,I as k,x as le,y as re,r as d,o as f,e as se,g as o,w as n,c as e,z as h,l as w,i as C,f as ie,k as N,A as de,Y as ue,X as D}from"./index-8a2cb146.js";import{_ as ce}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{F as z}from"./fleet-3200ffd1.js";import"./index-2bbe694f.js";const pe=()=>[{title:"车队名称",dataIndex:"fleetName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:r})=>u(r.fleetName)},{title:"联系人",dataIndex:"fleetContacts",show:!0,align:"center",render:({record:r})=>u(r.fleetContacts)},{title:"联系电话",dataIndex:"fleetContactsPhone",show:!0,align:"center",render:({record:r})=>u(r.fleetContactsPhone)},{title:"所属国家",dataIndex:"country",show:!0,align:"center",render:({record:r})=>u(r.country)},{title:"所属省",dataIndex:"province",show:!0,align:"center",render:({record:r})=>u(r.province)},{title:"所属市",dataIndex:"city",show:!0,align:"center",render:({record:r})=>u(r.city)},{title:"合作期限开始",dataIndex:"periodCooperateStart",show:!0,align:"center",render:({record:r})=>u(r.periodCooperateStart)},{title:"合作期限结束",dataIndex:"periodCooperateEnd",show:!0,align:"center",render:({record:r})=>u(r.periodCooperateEnd)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],me=ie("span",{class:"mx-3"},"-",-1),fe=T({name:"FleetCooperateManage"}),Ne=T({...fe,setup(r){const{vAuthority:g}=ee(),{warningModal:A}=de(),[E,Ce]=te(null),{form:a,resetForm:$}=ae(()=>({country:"",countryCode:"",province:"",provinceCode:"",city:"",cityCode:"",periodCooperateStart:"",periodCooperateEnd:"",fleetName:""}),()=>S()),{selectRow:ge,columnsData:F,visibleColumnsData:K,tableBaseOptions:i,resetData:S,setSelectRow:_e,extendTableList:ye,changeTableColumn:U,changeTableSize:Y}=oe(pe(),()=>y()),_=async s=>{const{res:t}=await N(()=>ue.getAreaInfo(s));return(t==null?void 0:t.data)??[]},{data:V}=ne(async()=>await _({level:"1"}),[]),{data:x}=k(async()=>await _({parentNo:a.value.countryCode}),{watchSource:()=>a.value.countryCode,defaultValue:[]}),{data:I}=k(async()=>await _({parentNo:a.value.provinceCode}),{watchSource:()=>a.value.provinceCode,defaultValue:[]}),L=s=>{a.value.provinceCode="",a.value.province="",a.value.cityCode="",a.value.city="",a.value.country=V.value.find(t=>t.areaNo==s).areaName},P=s=>{a.value.cityCode="",a.value.city="",a.value.province=x.value.find(t=>t.areaNo==s).areaName},B=s=>{a.value.city=I.value.find(t=>t.areaNo==s).areaName},R=s=>{A(`确定操作选中的${i.selectedKeys.length}数据吗？`,async t=>{const{res:v}=await N(()=>z[s]({idList:i.selectedKeys}),{successMsg:"操作成功"});t(!0),v&&(i.selectedKeys=[],y())})},{data:O,loading:q,initData:y}=le(async()=>{const{res:s,err:t}=await N(()=>z.getFleetList({...a.value,periodCooperateStart:D(a.value.periodCooperateStart,"YYYYMMDD",""),periodCooperateEnd:D(a.value.periodCooperateEnd,"YYYYMMDD",""),currentPage:i.pagination.current,pageSize:i.pagination.pageSize,pagingOrNot:"1"}));return t?[]:(i.pagination.total=s.data.totalCount,s.data.list)});return re(y),(s,t)=>{const v=d("a-input"),c=d("a-form-item"),p=d("a-grid-item"),b=d("a-select"),M=d("a-date-picker"),W=d("a-grid"),X=d("a-form"),j=d("icon-plus"),m=d("a-button"),G=d("icon-close"),H=d("a-space"),J=d("a-button-group"),Q=d("a-table");return f(),se("div",null,[o(ce,{"table-columns":e(F),"table-size":e(i).size,onResetSearch:e($),onSearch:e(S),onChangeTableSize:e(Y),onChangeTableColumn:e(U)},{form:n(()=>[o(X,{model:e(a),"label-align":"left",size:"large","auto-label-width":""},{default:n(()=>[o(W,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:n(()=>[o(p,null,{default:n(()=>[o(c,{field:"fleetName",label:"车队名称:"},{default:n(()=>[o(v,{modelValue:e(a).fleetName,"onUpdate:modelValue":t[0]||(t[0]=l=>e(a).fleetName=l),modelModifiers:{trim:!0},placeholder:"请输入车队名称"},null,8,["modelValue"])]),_:1})]),_:1}),o(p,null,{default:n(()=>[o(c,{field:"country",label:"所属国家:"},{default:n(()=>[o(b,{modelValue:e(a).countryCode,"onUpdate:modelValue":t[1]||(t[1]=l=>e(a).countryCode=l),"allow-search":"",options:e(V),"field-names":{label:"areaName",value:"areaNo"},"virtual-list-props":{height:200},placeholder:"请选择所属国家",onChange:L},null,8,["modelValue","options"])]),_:1})]),_:1}),o(p,null,{default:n(()=>[o(c,{field:"province",label:"所属省:"},{default:n(()=>[o(b,{modelValue:e(a).provinceCode,"onUpdate:modelValue":t[2]||(t[2]=l=>e(a).provinceCode=l),options:e(x),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属省",onChange:P},null,8,["modelValue","options"])]),_:1})]),_:1}),o(p,null,{default:n(()=>[o(c,{field:"city",label:"所属城市:"},{default:n(()=>[o(b,{modelValue:e(a).cityCode,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).cityCode=l),options:e(I),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属市",onChange:B},null,8,["modelValue","options"])]),_:1})]),_:1}),o(p,null,{default:n(()=>[o(c,{label:"选择日期:"},{default:n(()=>[o(M,{modelValue:e(a).periodCooperateStart,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).periodCooperateStart=l),class:"flex1",placeholder:"合作期限开始日期"},null,8,["modelValue"]),me,o(M,{modelValue:e(a).periodCooperateEnd,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).periodCooperateEnd=l),class:"flex1",placeholder:"合作期限结束日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:n(()=>[o(H,null,{default:n(()=>[h((f(),w(m,{type:"outline",onClick:t[6]||(t[6]=l=>s.$router.push("/fleet/cooperateManage/operate"))},{icon:n(()=>[o(j)]),default:n(()=>[C(" 新增 ")]),_:1})),[[e(g),"FleetCooperateManageAdd"]]),h((f(),w(m,{type:"outline",status:"danger",disabled:!e(i).selectedKeys.length,loading:e(E)==="删除",onClick:t[7]||(t[7]=l=>R("delPlaneFleet"))},{icon:n(()=>[o(G)]),default:n(()=>[C(" 删除 ")]),_:1},8,["disabled","loading"])),[[e(g),"FleetCooperateManageDelete"]])]),_:1})]),table:n(()=>[o(Q,{"selected-keys":e(i).selectedKeys,"onUpdate:selectedKeys":t[8]||(t[8]=l=>e(i).selectedKeys=l),class:"zs-table","row-key":"id",data:e(O),"row-selection":e(i).rowSelection,bordered:e(i).bordered,pagination:e(i).pagination,size:e(i).size,columns:e(K),stripe:e(i).stripe,loading:e(q)},{operate:n(({record:l})=>[o(J,null,{default:n(()=>[o(m,{type:"text",status:"success",onClick:Z=>s.$router.push(`/fleet/cooperateManage/operate?id=${l.id}&isReadOnly=true`)},{default:n(()=>[C("详情")]),_:2},1032,["onClick"]),h((f(),w(m,{type:"text",onClick:Z=>s.$router.push(`/fleet/cooperateManage/operate?id=${l.id}`)},{default:n(()=>[C("编辑")]),_:2},1032,["onClick"])),[[e(g),"FleetCooperateManageEdit"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{Ne as default};

import{f as T,U as E,d as A,x as Y,h as G,i as J,k as q,r as n,o as c,l as L,w as s,a,b as e,c as v,p as k,F as te,s as ae,M as le,m as C,q as Q,n as oe,j as se,e as B}from"./index-d007178a.js";import{f as H,b as ne,c as re,_ as ie}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import"./index-13860ba0.js";const z={getExpertList:r=>T({method:"post",url:E.EXPERT.EXPERT_LIST,data:r}),addExpertList:r=>T({method:"post",url:E.EXPERT.ADD_EXPERT,data:r}),updateExpertList:r=>T({method:"post",url:E.EXPERT.UPDATE_EXPERT,data:r}),updateImg:r=>T({method:"post",url:E.EXPERT.UPDATE_IMG,data:r,headers:{"Content-Type":"multipart/form-data"}}),deleteExpert:r=>T({method:"post",url:E.EXPERT.DELETE_EXPERT,data:r}),deleteCaseImg:r=>T({method:"post",url:E.EXPERT.DELETE_IMG_EXPERT,data:r})},de=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"姓名",dataIndex:"userName",show:!0,align:"center",render:({record:r})=>H(r.userName)},{title:"职务",dataIndex:"job",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:r})=>H(r.job)},{title:"头像",dataIndex:"headImg",show:!0,tooltip:!0,ellipsis:!0,align:"center",slotName:"headImg"},{title:"添加时间",dataIndex:"headImg",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:r})=>H(ne(r.createTime,"YYYY-MM-DD HH:mm:ss","-"))},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],ue={key:0,style:{position:"relative"}},me={key:1,style:{width:"80px"}},ce=ae("span",{style:{color:"#999","margin-top":"5px","margin-left":"5px"}},"注：专家头像要求底色为白色或透明色，图片宽高为320 * 320",-1),pe={key:0,style:{position:"relative"}},ge={key:1,style:{position:"relative"}},fe={key:2,style:{position:"relative"}},_e={key:3,style:{position:"relative"}},be={key:4,style:{position:"relative"}},he=A({name:"zsAddExpert"}),ve=A({...he,props:{data:{default:()=>({})}},emits:["close","success"],setup(r,{emit:S}){const _=r,{warningModal:x}=Q(),p=Y(),[M,h]=G(null),{form:t,formRef:V}=J(()=>({..._.data})),i={userName:{required:!0,message:"请输入姓名"},job:{required:!0,message:"请输入职务"}};q("");let b=q([]),I=q([]);_.data.headImg&&I.value.push(_.data.headImg);const $=()=>{V.value.validate(d=>{if(!d){if(I.value.length<=0){le.info("请选择专家头像");return}_.data.id?N("updateExpertList"):N("addExpertList")}})},R=async d=>new Promise((l,o)=>{l(!0)}),X=()=>{x("确定删除该图片吗",async d=>{t.value.headImg="",I.value=[],d(!0)})},w=(d,l)=>{x("确定删除该图片吗",async o=>{t.value[d]="",await C(()=>z.deleteCaseImg({path:l}),{after:()=>h(null),before:()=>h("上传图片")}),o(!0)})},K=async d=>{const{res:l,err:o}=await C(()=>z.updateImg({file:d.at(-1).file}),{after:()=>h("删除成功"),before:()=>h(null)});o||(I.value.push(l==null?void 0:l.data),t.value.headImg=I.value[0])},O=async d=>{const{res:l,err:o}=await C(()=>z.updateImg({file:d.at(-1).file}),{after:()=>h(null),before:()=>h("上传图片")});o||b.value.push(l==null?void 0:l.data)},N=async d=>{const{err:l}=await C(()=>z[d]({...t.value,caseImgOne:b.value[0]||t.value.caseImgOne,caseImgTwo:b.value[1]||t.value.caseImgTwo,caseImgThree:b.value[2]||t.value.caseImgThree,caseImgFour:b.value[3]||t.value.caseImgFour,caseImgFive:b.value[4]||t.value.caseImgFive,headImg:I.value[0]||_.data.headImg,loginName:p.userInfo.loginName}),{before:()=>h("okLoading"),after:()=>h(null)});l||(S("success"),S("close"))};return(d,l)=>{const o=n("a-input"),g=n("a-form-item"),f=n("a-image"),y=n("icon-close-circle-fill"),D=n("a-upload"),F=n("a-textarea"),j=n("a-input-number"),P=n("a-form"),U=n("a-modal");return c(),L(U,{top:"10%",width:"60vw",title:e(re)("专家",!!_.data.id),"unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(M)==="okLoading",onCancel:l[10]||(l[10]=u=>S("close")),onOk:$},{default:s(()=>[a(P,{ref_key:"formRef",ref:V,model:e(t),"label-align":"left",size:"large","auto-label-width":"",rules:i},{default:s(()=>[a(g,{field:"userName",label:"专家姓名:",required:""},{default:s(()=>[a(o,{modelValue:e(t).userName,"onUpdate:modelValue":l[0]||(l[0]=u=>e(t).userName=u),modelModifiers:{trim:!0},placeholder:"请输入姓名","max-length":5},null,8,["modelValue"])]),_:1}),a(g,{field:"job",label:"职务:",required:""},{default:s(()=>[a(o,{modelValue:e(t).job,"onUpdate:modelValue":l[1]||(l[1]=u=>e(t).job=u),modelModifiers:{trim:!0},placeholder:"请输入职务","max-length":6},null,8,["modelValue"])]),_:1}),a(g,{label:"头像:",required:""},{default:s(()=>[e(t).headImg?(c(),v("div",ue,[a(f,{disabled:_.data.id,src:e(t).headImg,width:"80",style:{"margin-right":"10px"}},null,8,["disabled","src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:X})])):(c(),v("div",me,[a(D,{"default-file-list":e(I),"list-type":"picture-card",disabled:e(I).length>=1,ref:"uploadRef","auto-upload":!1,"show-cancel-button":!1,"show-remove-button":!1,"show-link":!1,"show-file-list":!0,accept:".png,.jpg,.jpeg","image-preview":"",onChange:K,onOnBeforeUpload:R},null,8,["default-file-list","disabled"])])),ce]),_:1}),a(g,{field:"photoArray",label:"案例图片:"},{default:s(()=>[e(t).caseImgOne||e(t).caseImgTwo||e(t).caseImgThree||e(t).caseImgFour||e(t).caseImgFive?(c(),v(te,{key:0},[e(t).caseImgOne?(c(),v("div",pe,[a(f,{src:e(t).caseImgOne,width:"80",style:{"margin-right":"10px"}},null,8,["src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:l[2]||(l[2]=u=>w("caseImgOne",e(t).caseImgOne))})])):k("",!0),e(t).caseImgTwo?(c(),v("div",ge,[a(f,{src:e(t).caseImgTwo,width:"80",style:{"margin-right":"10px"}},null,8,["src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:l[3]||(l[3]=u=>w("caseImgTwo",e(t).caseImgTwo))})])):k("",!0),e(t).caseImgThree?(c(),v("div",fe,[a(f,{src:e(t).caseImgThree,width:"80",style:{"margin-right":"10px"}},null,8,["src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:l[4]||(l[4]=u=>w("caseImgThree",e(t).caseImgThree))})])):k("",!0),e(t).caseImgFour?(c(),v("div",_e,[a(f,{src:e(t).caseImgFour,width:"80",style:{"margin-right":"10px"}},null,8,["src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:l[5]||(l[5]=u=>w("caseImgFour",e(t).caseImgFour))})])):k("",!0),e(t).caseImgFive?(c(),v("div",be,[a(f,{src:e(t).caseImgFive,width:"80",style:{"margin-right":"10px"}},null,8,["src"]),a(y,{size:"20",style:{position:"absolute",right:"9px",top:"0"},onClick:l[6]||(l[6]=u=>w("caseImgFive",e(t).caseImgFive))})])):k("",!0)],64)):(c(),L(D,{key:1,"default-file-list":e(b),"list-type":"picture-card",disabled:!!_.data.id||e(b).length>=5,ref:"uploadRef","auto-upload":!1,"show-cancel-button":!1,"show-remove-button":!1,"show-link":!1,"show-file-list":!0,accept:".png,.jpg,.jpeg","image-preview":"",onChange:O},null,8,["default-file-list","disabled"]))]),_:1}),a(g,{field:"expertDescription",label:"专家描述:"},{default:s(()=>[a(F,{modelValue:e(t).expertDescription,"onUpdate:modelValue":l[7]||(l[7]=u=>e(t).expertDescription=u),placeholder:"请输入专家描述"},null,8,["modelValue"])]),_:1}),a(g,{field:"zjSort",label:"排序:"},{default:s(()=>[a(j,{modelValue:e(t).zjSort,"onUpdate:modelValue":l[8]||(l[8]=u=>e(t).zjSort=u),placeholder:"请输入顺序"},null,8,["modelValue"])]),_:1}),a(g,{field:"bz",label:"备注:"},{default:s(()=>[a(F,{modelValue:e(t).bz,"onUpdate:modelValue":l[9]||(l[9]=u=>e(t).bz=u),placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),Ie={key:1},ye=A({name:"ExpertList"}),ke=A({...ye,setup(r){Y();const{warningModal:S}=Q(),[_,x]=G(null),{form:p,resetForm:M}=J(()=>({userName:"",createStartTime:"",createEndTime:""}),()=>b()),{selectRow:h,columnsData:t,visibleColumnsData:V,tableBaseOptions:i,resetData:b,extendTableList:I,createRowNo:$,setSelectRow:R,changeTableColumn:X,changeTableSize:w}=oe(de(),()=>d()),K=()=>{S(`确定删除选中的${i.selectedKeys.length}数据吗？`,async l=>{const{err:o}=await C(()=>z.deleteExpert({ids:i.selectedKeys}),{successMsg:"操作成功"});o||(l(!0),i.selectedKeys=[],d())})},{data:O,loading:N,initData:d}=se(async()=>{const{res:l,err:o}=await C(()=>z.getExpertList({...p.value,createStartTime:p.value.createStartTime,createEndTime:p.value.createEndTime,currentPage:i.pagination.current,pageSize:i.pagination.pageSize,pagingOrNot:"1"}));return o?[]:(i.pagination.total=l.data.totalCount,l.data.resultList.map((g,f)=>({sortTableNo:$(f),...g,zjSort:Number(g.zjSort)})))});return(l,o)=>{const g=n("icon-plus"),f=n("a-button"),y=n("icon-close"),D=n("a-space"),F=n("a-input"),j=n("a-form-item"),P=n("a-grid-item"),U=n("a-date-picker"),u=n("a-grid"),W=n("a-form"),Z=n("a-image"),ee=n("a-table");return c(),v("div",null,[a(ie,{"table-columns":e(t),"table-size":e(i).size,onResetSearch:e(M),onSearch:e(b),onChangeTableSize:e(w),onChangeTableColumn:e(X)},{operate:s(()=>[a(D,null,{default:s(()=>[a(f,{type:"outline",onClick:o[0]||(o[0]=m=>e(x)("zsAddExpert"))},{icon:s(()=>[a(g)]),default:s(()=>[B(" 新增 ")]),_:1}),a(f,{type:"outline",status:"danger",disabled:!e(i).selectedKeys.length,loading:e(_)==="删除",onClick:K},{icon:s(()=>[a(y)]),default:s(()=>[B(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),form:s(()=>[a(W,{model:e(p),"label-align":"left",size:"large","auto-label-width":""},{default:s(()=>[a(u,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:s(()=>[a(P,null,{default:s(()=>[a(j,{label:"专家姓名:"},{default:s(()=>[a(F,{class:"flex1",modelValue:e(p).userName,"onUpdate:modelValue":o[1]||(o[1]=m=>e(p).userName=m),modelModifiers:{trim:!0},placeholder:"请输入专家姓名"},null,8,["modelValue"])]),_:1})]),_:1}),a(P,null,{default:s(()=>[a(j,{label:"添加时间范围:"},{default:s(()=>[a(U,{style:{width:"200px"},modelValue:e(p).createStartTime,"onUpdate:modelValue":o[2]||(o[2]=m=>e(p).createStartTime=m)},null,8,["modelValue"]),a(U,{style:{width:"200px"},modelValue:e(p).createEndTime,"onUpdate:modelValue":o[3]||(o[3]=m=>e(p).createEndTime=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),table:s(()=>[a(ee,{"selected-keys":e(i).selectedKeys,"onUpdate:selectedKeys":o[4]||(o[4]=m=>e(i).selectedKeys=m),class:"zs-table","row-key":"id",data:e(O),"row-selection":e(i).rowSelection,bordered:e(i).bordered,pagination:e(i).pagination,size:e(i).size,columns:e(V),stripe:e(i).stripe,loading:e(N)},{headImg:s(({record:m})=>[m.headImg?(c(),L(Z,{key:0,src:m.headImg,width:"100"},null,8,["src"])):(c(),v("div",Ie,"--"))]),operate:s(({record:m})=>[a(f,{type:"text",onClick:we=>e(R)(m,()=>e(x)("zsAddExpert"))},{default:s(()=>[B("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(_)==="zsAddExpert"?(c(),L(ve,{key:0,data:e(h),onSuccess:e(d),onClose:o[5]||(o[5]=m=>e(R)({},()=>e(x)(null)))},null,8,["data","onSuccess"])):k("",!0)])}}});export{ke as default};

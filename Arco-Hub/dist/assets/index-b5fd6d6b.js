import{d as I,E as N,s as R,r as u,o as f,l as m,w as a,g as l,c as e,k as z,u as V,C as Z,b as h,i as r,t as _,n as v,h as y,f as E,e as q,F as A}from"./index-8a2cb146.js";import{Z as K}from"./index-2bbe694f.js";import{B as $}from"./bid-5ab5e053.js";const P=I({name:"ZsExamineBid"}),C=I({...P,props:{data:{default:()=>({})},type:{default:"success"}},emits:["close","success"],setup(B,{emit:b}){const p=B,g=b,[F,o]=N(null),{form:k,formRef:n}=R(()=>({auditDesc:""})),s={auditDesc:{validator:(d,t)=>{!d&&p.type==="fail"&&t("审核驳回时备注必填")}}},c=()=>{n.value.validate(d=>{d||i()})},i=async()=>{const{err:d}=await z(()=>$.examineRecord({id:p.data.id,state:p.type==="success"?"2":"1",...k.value}),{before:()=>o("okLoading"),after:()=>o(""),successMsg:"操作成功"});d||(g("success"),g("close"))};return(d,t)=>{const D=u("a-textarea"),L=u("a-form-item"),S=u("a-form"),x=u("a-modal");return f(),m(x,{width:"600px",top:"10%","unmount-on-close":"",visible:"","align-center":!1,title:`审核${d.type==="success"?"通过":"驳回"}`,"mask-closable":!1,"ok-loading":e(F)==="okLoading",onCancel:t[1]||(t[1]=w=>g("close")),onOk:c},{default:a(()=>[l(S,{ref_key:"formRef",ref:n,model:e(k),"label-align":"left",size:"large","auto-label-width":"",rules:s},{default:a(()=>[l(L,{field:"auditDesc",label:"备注:"},{default:a(()=>[l(D,{modelValue:e(k).auditDesc,"onUpdate:modelValue":t[0]||(t[0]=w=>e(k).auditDesc=w),modelModifiers:{trim:!0},placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),T=E("div",{style:{height:"100px"}},null,-1),M={class:"orderSubmit-footer box-flex jc-fe"},O=I({name:"BidRecordsManageOperate"}),H=I({...O,setup(B){const b=V(),{jumpTabName:p}=Z(),[g,F]=N(""),{data:o,loading:k}=h(async()=>{const{res:n,err:s}=await z(()=>$.getRecordDetail({id:b.query.id}));if(s)return;const c=(n==null?void 0:n.data.applyInfoFileList)??[],i=(n==null?void 0:n.data.sealInfoFileList)??[],d=(n==null?void 0:n.data.bidDocFileList)??[];return{...n==null?void 0:n.data,sealInfoFileList:i.map(t=>({name:t.attName,url:t.attPath,status:"done",uid:t.id,attSize:t.attSize})),applyInfoFileList:c.map(t=>({name:t.attName,url:t.attPath,status:"done",uid:t.id,attSize:t.attSize})),bidDocFileList:d.map(t=>({name:t.attName,url:t.attPath,status:"done",uid:t.id,attSize:t.attSize}))}},{sealInfoFileList:[],applyInfoFileList:[],bidDocFileList:[]});return(n,s)=>{const c=u("a-tag"),i=u("a-descriptions-item"),d=u("a-descriptions"),t=u("a-card"),D=u("a-upload"),L=u("a-button"),S=u("a-space");return f(),m(K,null,{default:a(()=>[l(t,{title:"结算详情",loading:e(k),bordered:!1,class:"general-card"},{default:a(()=>[l(d,{size:"large",column:3},{default:a(()=>[l(i,{label:"营业部："},{default:a(()=>[l(c,null,{default:a(()=>[r(_(e(v)(e(o).departName)),1)]),_:1})]),_:1}),l(i,{label:"申请人："},{default:a(()=>[l(c,null,{default:a(()=>[r(_(e(v)(e(o).applyAccount)),1)]),_:1})]),_:1}),l(i,{label:"申请人身份证号："},{default:a(()=>[l(c,null,{default:a(()=>[r(_(e(v)(e(o).applyIdNumber)),1)]),_:1})]),_:1}),l(i,{label:"申领文件名称："},{default:a(()=>[l(c,null,{default:a(()=>[r(_(e(v)(e(o).applyFileName)),1)]),_:1})]),_:1}),l(i,{label:"是否加盖公章："},{default:a(()=>[l(c,null,{default:a(()=>[r(_(e(o).isOfficialSeal==="1"?"是":"否"),1)]),_:1})]),_:1}),l(i,{label:"用途："},{default:a(()=>[r(_(e(v)(e(o).useDesc)),1)]),_:1}),e(o).auditDesc?(f(),m(i,{key:0,label:"驳回原因："},{default:a(()=>[r(_(e(v)(e(o).auditDesc)),1)]),_:1})):y("",!0)]),_:1})]),_:1},8,["loading"]),e(o).sealInfoFileList.length?(f(),m(t,{key:0,title:"用印资料文件列表",bordered:!1,class:"general-card margin-top"},{default:a(()=>[l(D,{"file-list":e(o).sealInfoFileList,"auto-upload":!1,limit:1,"show-remove-button":!1,"show-retry-button":!1},null,8,["file-list"])]),_:1})):y("",!0),e(o).applyInfoFileList.length?(f(),m(t,{key:1,title:"申领资料文件列表",bordered:!1,class:"general-card margin-top"},{default:a(()=>[l(D,{"file-list":e(o).applyInfoFileList,"auto-upload":!1,limit:1,"show-remove-button":!1,"show-retry-button":!1},null,8,["file-list"])]),_:1})):y("",!0),e(o).bidDocFileList.length?(f(),m(t,{key:2,title:"电子标书文件列表",bordered:!1,class:"general-card margin-top"},{default:a(()=>[l(D,{"file-list":e(o).bidDocFileList,"auto-upload":!1,limit:1,"show-remove-button":!1,"show-retry-button":!1},null,8,["file-list"])]),_:1})):y("",!0),T,E("div",M,[l(S,null,{default:a(()=>[e(b).query.isExamine?(f(),q(A,{key:0},[l(L,{type:"primary",onClick:s[0]||(s[0]=x=>e(F)("ZsExamineBidSuccess"))},{default:a(()=>[r("通过")]),_:1}),l(L,{status:"danger",onClick:s[1]||(s[1]=x=>e(F)("ZsExamineBidFail"))},{default:a(()=>[r("驳回")]),_:1})],64)):y("",!0),l(L,{onClick:s[2]||(s[2]=()=>e(p)())},{default:a(()=>[r("返回")]),_:1})]),_:1})]),e(g)==="ZsExamineBidSuccess"?(f(),m(C,{key:3,data:{id:e(b).query.id},type:"success",onClose:s[3]||(s[3]=x=>e(F)("")),onSuccess:s[4]||(s[4]=()=>e(p)())},null,8,["data"])):y("",!0),e(g)==="ZsExamineBidFail"?(f(),m(C,{key:4,data:{id:e(b).query.id},type:"fail",onClose:s[5]||(s[5]=x=>e(F)("")),onSuccess:s[6]||(s[6]=()=>e(p)())},null,8,["data"])):y("",!0)]),_:1})}}});export{H as default};

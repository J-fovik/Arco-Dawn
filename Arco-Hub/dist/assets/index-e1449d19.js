import{d as U,u as j,C as A,E,s as K,r,o as x,l as h,w as e,g as a,c as i,W as O,i as f,f as p,h as Z,k as q,S as D}from"./index-8a2cb146.js";import{Z as F}from"./index-2bbe694f.js";const P=[{title:"编码",dataIndex:"detailCode",slotName:"detailCode"},{title:"编码名称",dataIndex:"detailName",slotName:"detailName"},{title:"备注",dataIndex:"remake",slotName:"remake"},{title:"操作",dataIndex:"operate",align:"center",width:100,slotName:"operate"}],W={class:"box-flex"},Y={class:"box-flex"},G=p("div",{style:{height:"100px"}},null,-1),H={class:"orderSubmit-footer box-flex jc-fe"},J=U({name:"SystemDictionaryOperate"}),ae=U({...J,setup(Q){const u=j(),{jumpTabName:C}=A(),[L,V]=E(null),{form:o,formRef:b}=K(()=>({typeCode:"",typeName:"",remark:"",detailList:[]})),_={typeCode:{required:!0,message:"请输入编号"},typeName:{required:!0,message:"请输入名称"},detailCode:{required:!0,validator:(d,t)=>{o.value.detailList.filter(s=>s.detailCode===d).length>1&&t("子项编码不允许重复")}},detailName:{required:!0,validator:(d,t)=>{o.value.detailList.filter(s=>s.detailName===d).length>1&&t("子项名称不允许重复")}}},S=async()=>{const{res:d,err:t}=await q(()=>D.getDictionaryDetail({id:u.query.id}));t||(o.value=d==null?void 0:d.data)},I=()=>{o.value.detailList.push({detailCode:"",detailName:""})},M=d=>{o.value.detailList.splice(d,1)},T=()=>{b.value.validate(d=>{d||(u.query.id?N("editDictionary"):N("addDictionary"))})},N=async d=>{const{err:t}=await q(()=>D[d](o.value),{before:()=>V("确定"),after:()=>V(null),successMsg:"保存成功"});t||C()};return u.query.id&&S(),(d,t)=>{const s=r("a-input"),m=r("a-form-item"),y=r("a-grid-item"),v=r("a-textarea"),w=r("a-grid"),k=r("a-card"),z=r("icon-plus"),c=r("a-button"),R=r("a-table"),B=r("a-form"),$=r("a-space");return x(),h(F,null,{default:e(()=>[a(B,{ref_key:"formRef",ref:b,model:i(o),"label-align":"left",size:"large","auto-label-width":"",rules:_},{default:e(()=>[a(k,{title:i(O)("字典",!!i(u).query.id),bordered:!1,class:"general-card"},{default:e(()=>[a(w,{cols:3,"col-gap":12},{default:e(()=>[a(y,null,{default:e(()=>[a(m,{label:"编码:",field:"typeCode",required:""},{default:e(()=>[a(s,{modelValue:i(o).typeCode,"onUpdate:modelValue":t[0]||(t[0]=l=>i(o).typeCode=l),modelModifiers:{trim:!0},placeholder:"请输入编码"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,null,{default:e(()=>[a(m,{label:"名称:",field:"typeName"},{default:e(()=>[a(s,{modelValue:i(o).typeName,"onUpdate:modelValue":t[1]||(t[1]=l=>i(o).typeName=l),modelModifiers:{trim:!0},placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,null,{default:e(()=>[a(m,{field:"remark",label:"备注:"},{default:e(()=>[a(v,{modelValue:i(o).remark,"onUpdate:modelValue":t[2]||(t[2]=l=>i(o).remark=l),modelModifiers:{trim:!0},"auto-size":"",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title"]),a(k,{title:"字典明细",bordered:!1,class:"general-card margin-top"},{extra:e(()=>[a(c,{type:"outline",onClick:I},{icon:e(()=>[a(z)]),default:e(()=>[f(" 添加子项 ")]),_:1})]),default:e(()=>[a(R,{size:"large",columns:i(P),data:i(o).detailList,pagination:!1,bordered:!1},{detailCode:e(({record:l,rowIndex:n})=>[a(m,{field:`detailList[${n}].detailCode`,rules:[{validator:_.detailCode.validator}],"hide-label":"","hide-asterisk":""},{default:e(()=>[a(s,{modelValue:l.detailCode,"onUpdate:modelValue":g=>l.detailCode=g,size:"large",placeholder:"请输入子项编码"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","rules"])]),detailName:e(({record:l,rowIndex:n})=>[p("div",W,[a(m,{field:`detailList[${n}].detailName`,rules:[{validator:_.detailName.validator}],"hide-label":"","hide-asterisk":""},{default:e(()=>[a(s,{modelValue:l.detailName,"onUpdate:modelValue":g=>l.detailName=g,size:"large",placeholder:"请输入子项名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","rules"])])]),remake:e(({record:l})=>[p("div",Y,[a(v,{modelValue:l.remark,"onUpdate:modelValue":n=>l.remark=n,modelModifiers:{trim:!0},"auto-size":"",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])]),operate:e(({rowIndex:l})=>[a(c,{type:"text",status:"danger",onClick:n=>M(l)},{default:e(()=>[f("删除")]),_:2},1032,["onClick"])]),_:1},8,["columns","data"])]),_:1})]),_:1},8,["model"]),G,p("div",H,[a($,null,{default:e(()=>[i(u).query.isReadOnly?Z("",!0):(x(),h(c,{key:0,type:"primary",loading:i(L)==="确定",onClick:T},{default:e(()=>[f("确定")]),_:1},8,["loading"])),a(c,{onClick:t[3]||(t[3]=()=>i(C)())},{default:e(()=>[f("返回")]),_:1})]),_:1})])]),_:1})}}});export{ae as default};

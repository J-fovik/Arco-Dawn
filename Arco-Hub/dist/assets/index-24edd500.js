import{a as H,n as p,p as se,X as re,T as ie,d as R,E as J,s as j,r as d,o as g,l as N,w as a,g as n,c as e,k as w,A as X,q as ue,R as de,v as ce,b as q,e as me,z as B,i as C,h as M,V as E,L as pe,J as ge,S as fe}from"./index-8a2cb146.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{B as D}from"./business-b0ce0e8a.js";import"./index-2bbe694f.js";const be=()=>{const{getDictionaryItem:I}=H();return[{title:"团号",dataIndex:"groupNo",show:!0,align:"center",render:({record:r})=>p(r.groupNo)},{title:"营业部名称",dataIndex:"departName",show:!0,align:"center",render:({record:r})=>p(r.departName)},{title:"被保人",dataIndex:"signingName",show:!0,align:"center",render:({record:r})=>p(r.signingName)},{title:"交易流水号",dataIndex:"channelTradeSerialNo",show:!0,align:"center",ellipsis:!0,tooltip:!0,render:({record:r})=>p(r.channelTradeSerialNo)},{title:"保单号",dataIndex:"policyNo",show:!0,align:"center",render:({record:r})=>p(r.policyNo)},{title:"产品名称",dataIndex:"productName",show:!0,align:"center",ellipsis:!0,tooltip:!0,render:({record:r})=>p(r.productName)},{title:"状态",dataIndex:"state",show:!0,align:"center",render:({record:r})=>se(ie,{color:"blue"},{default:()=>{var m;return p((m=I("tbState",r.state))==null?void 0:m.detailName)}})},{title:"创建时间",dataIndex:"createTime",show:!0,align:"center",render:({record:r})=>p(re(r.createTime,"YYYY-MM-DD HH:mm:ss"))},{title:"操作",width:300,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ye=R({name:"zsViewRecord"}),Ne=R({...ye,props:{data:{default:()=>({})}},emits:["close","success"],setup(I,{emit:r}){const{warningModal:m}=X(),S=I,[f,$]=J(null),{form:o,formRef:h}=j(()=>({})),L={policyNo:{required:!0,message:"请输入保单号"}},k=r,U=()=>{h.value.validate(v=>{v||K()})},K=()=>{m("确定提交吗?",async v=>{v(!0);const{err:s}=await w(()=>D.batchApplyOrderInsure({insurContractIdList:S.data,policyNo:o.value.policyNo}),{successMsg:"操作成功"});s||(k("success"),k("close"))})};return(v,s)=>{const x=d("a-input"),A=d("a-form-item"),_=d("a-grid-item"),F=d("a-grid"),O=d("a-form"),Y=d("a-modal");return g(),N(Y,{title:"请输入保单","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(f)==="okLoading",top:"20vh",onCancel:s[1]||(s[1]=T=>k("close")),onOk:U},{default:a(()=>[n(O,{ref_key:"formRef",ref:h,model:e(o),"label-align":"left",size:"large","auto-label-width":"",rules:L},{default:a(()=>[n(F,{cols:1,"col-gap":24},{default:a(()=>[n(_,null,{default:a(()=>[n(A,{field:"policyNo",label:"保单号:"},{default:a(()=>[n(x,{modelValue:e(o).policyNo,"onUpdate:modelValue":s[0]||(s[0]=T=>e(o).policyNo=T)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),ke=R({name:"BusinessInsuranceDocking"}),Ce=R({...ke,setup(I){const{getDictionaryInfo:r}=H(),{vAuthority:m}=ue(),{warningModal:S}=X(),[f,$]=J(null),{form:o,resetForm:h}=j(()=>({groupNo:"",channelTradeSerialNo:"",departName:"",departNo:"",areaNo:"",signingName:"",state:""}),()=>x()),L=()=>{s.selectedKeys=[],z()},k=de([]),{selectRow:U,columnsData:K,visibleColumnsData:v,tableBaseOptions:s,resetData:x,extendTableList:A,setSelectRow:_,changeTableColumn:F,changeTableSize:O}=ce(be(),()=>z()),Y=l=>{S("确定操作选中的数据吗？",async t=>{const{err:c}=await w(()=>D.cancelBusiness({id:l}),{successMsg:"操作成功"});if(c)return t(!0);t(!0),z()})},T=l=>{S("确定操作数据吗？",async t=>{if(l.id==null||l.id=="")return E.error("主键不能为空！"),t(!0),!1;if(l.state==null||l.state=="")return E.error("状态不能为空！"),t(!0),!1;if(l.state!="4")return E.error("状态为[出单失败]的才可以重新投保！"),t(!0),!1;const{err:c}=await w(()=>D.batchReviewInsure({ids:[l.id]}),{successMsg:"操作成功"});if(c)return t(!0);t(!0),z()})},G=()=>{S("确定操作数据吗？",async l=>{_(s.selectedKeys,()=>$("zsBalance")),l(!0)})},Q=async l=>{const{res:t,err:c}=await w(()=>D.contractDownLoad({id:l}));c||pe(t,"BDFJ_"+ge().valueOf()+".pdf")};q(async()=>{const{err:l,res:t}=await w(()=>fe.getDepartmentList({departType:"1"}));return l?[]:t==null?void 0:t.data},[]);const{data:W,loading:Z,initData:z}=q(async()=>{const{res:l,err:t}=await w(()=>D.getDeckingList({...o.value,currentPage:s.pagination.current,pageSize:s.pagination.pageSize}),{successMsg:""});if(!t)return k.value=l==null?void 0:l.data.regionList,s.pagination.total=l.data.totalCount,A(l==null?void 0:l.data.dataList)});return(l,t)=>{const c=d("a-input"),b=d("a-form-item"),y=d("a-grid-item"),P=d("a-select"),ee=d("a-grid"),te=d("a-form"),ae=d("icon-plus"),V=d("a-button"),ne=d("a-space"),le=d("a-button-group"),oe=d("a-table");return g(),me("div",null,[n(_e,{fold:"","table-columns":e(K),"table-size":e(s).size,onResetSearch:e(h),onSearch:e(x),onChangeTableSize:e(O),onChangeTableColumn:e(F)},{form:a(({collapsed:i})=>[n(te,{model:e(o),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[n(ee,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!i},{default:a(()=>[n(y,null,{default:a(()=>[n(b,{label:"团号:"},{default:a(()=>[n(c,{modelValue:e(o).groupNo,"onUpdate:modelValue":t[0]||(t[0]=u=>e(o).groupNo=u),placeholder:"请输入团号"},null,8,["modelValue"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"交易流水号:"},{default:a(()=>[n(c,{modelValue:e(o).channelTradeSerialNo,"onUpdate:modelValue":t[1]||(t[1]=u=>e(o).channelTradeSerialNo=u),placeholder:"请输入交易流水号"},null,8,["modelValue"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"地区:"},{default:a(()=>[n(P,{modelValue:e(o).areaNo,"onUpdate:modelValue":t[2]||(t[2]=u=>e(o).areaNo=u),placeholder:"请选择地区",options:k.value,"field-names":{label:"cityName",value:"provinceCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"被保人:"},{default:a(()=>[n(c,{modelValue:e(o).signingName,"onUpdate:modelValue":t[3]||(t[3]=u=>e(o).signingName=u),placeholder:"请输入被保人"},null,8,["modelValue"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"投保状态:"},{default:a(()=>[n(P,{modelValue:e(o).state,"onUpdate:modelValue":t[4]||(t[4]=u=>e(o).state=u),placeholder:"请选择投保状态",options:e(r)("tbState"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"部门名称:"},{default:a(()=>[n(c,{modelValue:e(o).departName,"onUpdate:modelValue":t[5]||(t[5]=u=>e(o).departName=u),modelModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),n(y,null,{default:a(()=>[n(b,{label:"部门代码:"},{default:a(()=>[n(c,{modelValue:e(o).departNo,"onUpdate:modelValue":t[6]||(t[6]=u=>e(o).departNo=u),modelModifiers:{trim:!0},placeholder:"请输入部门代码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:a(()=>[n(ne,null,{default:a(()=>[B((g(),N(V,{type:"outline",status:"warning",disabled:!e(s).selectedKeys.length,loading:e(f)==="手动批量投保",onClick:t[7]||(t[7]=i=>G())},{icon:a(()=>[n(ae)]),default:a(()=>[C(" 手动批量投保 ")]),_:1},8,["disabled","loading"])),[[e(m),"BusinessInsuranceDockingBatchInsure"]])]),_:1})]),table:a(()=>[n(oe,{"selected-keys":e(s).selectedKeys,"onUpdate:selectedKeys":t[8]||(t[8]=i=>e(s).selectedKeys=i),class:"zs-table","row-key":"id",data:e(W),"row-selection":e(s).rowSelection,bordered:e(s).bordered,pagination:e(s).pagination,size:e(s).size,columns:e(v),stripe:e(s).stripe,loading:e(Z)},{operate:a(({record:i})=>[n(le,null,{default:a(()=>[i.id?(g(),N(V,{key:0,type:"text",status:"success",onClick:u=>l.$router.push(`/business/insuranceDocking/operate?id=${i.id}&isReadOnly=true`)},{default:a(()=>[C("详情")]),_:2},1032,["onClick"])):M("",!0),i.state=="1"?B((g(),N(V,{key:1,type:"text",status:"danger",loading:e(f)==="撤保",onClick:u=>e(_)(i,()=>Y(i.id))},{default:a(()=>[C(" 撤保 ")]),_:2},1032,["loading","onClick"])),[[e(m),"BusinessInsuranceDockingPullInsure"]]):M("",!0),B((g(),N(V,{type:"text",status:"warning",loading:e(f)==="下载",disabled:!i.id,onClick:u=>e(_)(i,()=>Q(i.id))},{default:a(()=>[C(" 下载 ")]),_:2},1032,["loading","disabled","onClick"])),[[e(m),"BusinessInsuranceDockingDownload"]]),i.state=="3"||i.state=="4"?B((g(),N(V,{key:2,type:"text",loading:e(f)==="重新投保",onClick:u=>e(_)(i,()=>T(i))},{default:a(()=>[C(" 重新投保 ")]),_:2},1032,["loading","onClick"])),[[e(m),"BusinessInsuranceDockingReInsure"]]):M("",!0)]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(f)==="zsBalance"?(g(),N(Ne,{key:0,data:e(U),onSuccess:L,onClose:t[9]||(t[9]=i=>e(_)({},()=>e($)(null)))},null,8,["data"])):M("",!0)])}}});export{Ce as default};

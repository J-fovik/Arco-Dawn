import{d as O,h as H,i as J,k as v,n as Q,j as W,r as i,o as T,c as X,a as t,w as a,b as e,v as Z,l as N,e as I,p as k,m as V}from"./index-d007178a.js";import{A as h}from"./options-aafac76d.js";import{g as ee}from"./opt-6460dd95.js";import{f as u,t as z,a as U,_ as te}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{V as w}from"./vip-3bf0329d.js";import"./index-13860ba0.js";const ae=[{label:"待激活",value:"0"},{label:"已激活",value:"1"}],le=[{label:"正常",value:"0"},{label:"冻结",value:"1"}],ne=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"代理商名称",dataIndex:"agentName",show:!0,align:"center",render:({record:n})=>u(n.agentName)},{title:"销售人员",dataIndex:"sellingUser",show:!0,align:"center",render:({record:n})=>u(n.sellingUser)},{title:"批次号",dataIndex:"batchCode",show:!0,align:"center",render:({record:n})=>u(n.batchCode)},{title:"卡号",dataIndex:"cardNo",show:!0,align:"center",render:({record:n})=>u(n.cardNo)},{title:"商品大类",dataIndex:"cardLargeCategory",show:!0,align:"center",render:({record:n})=>u(n.cardLargeCategory)},{title:"商品类型",dataIndex:"cardType",show:!0,align:"center",render:({record:n})=>u(n.cardType)},{title:"原始价格",dataIndex:"originalPrice",show:!0,align:"right",render:({record:n})=>z(U(n.originalPrice))},{title:"销售价格",dataIndex:"sellingPrice",show:!0,align:"right",render:({record:n})=>z(U(n.sellingPrice))},{title:"发卡时间",dataIndex:"createTm",show:!0,align:"center",render:({record:n})=>u(n.createTm)},{title:"激活状态",dataIndex:"activateStatus",show:!0,align:"center",render:({record:n})=>u(n.activateStatus=="1"?"已激活":"待激活")},{title:"状态",dataIndex:"status",show:!0,align:"center",render:({record:n})=>u(n.status=="1"?"冻结":"正常")},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],oe=O({name:"VipAgentManage"}),ge=O({...oe,setup(n){H(null);const{form:o,resetForm:P}=J(()=>({cardType:"",agentName:"",sellingUser:"",batchCode:"",createTmStart:"",createTmEnd:"",cardNo:"",activateStatus:"",status:""}),()=>x());let g=v([]);const A=s=>{o.value.createTmStart=s[0],o.value.createTmEnd=s[1]},C=v([]);ee().then(s=>{C.value=s});const{selectRow:re,columnsData:L,visibleColumnsData:M,tableBaseOptions:d,resetData:x,extendTableList:D,setSelectRow:se,changeTableColumn:R,changeTableSize:B}=Q(ne(),()=>_()),{data:E,loading:F,initData:_}=W(async()=>{const{res:s,err:l}=await V(()=>w.getVipCard({...o.value,currentPage:d.pagination.current,pageSize:d.pagination.pageSize,pagingOrNot:"1"}));return l?[]:(d.pagination.total=s.data.totalCount,D(s.data.list))}),K=async s=>{const{err:l}=await V(()=>w.freezeVipCard({id:s.id}),{successMsg:"操作成功"});if(l)return[];_()},$=async s=>{const{err:l}=await V(()=>w.thawVipCard({id:s.id}),{successMsg:"操作成功"});if(l)return[];_()};return(s,l)=>{const j=i("a-range-picker"),c=i("a-form-item"),m=i("a-grid-item"),f=i("a-input"),b=i("a-select"),q=i("a-grid"),Y=i("a-form"),y=i("a-button"),S=i("a-popconfirm"),G=i("a-table");return T(),X("div",null,[t(te,{fold:"","table-columns":e(L),"table-size":e(d).size,onResetSearch:e(P),onSearch:e(x),onChangeTableSize:e(B),onChangeTableColumn:e(R)},{form:a(({collapsed:p})=>[t(Y,{model:e(o),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[t(q,{cols:{md:3,lg:3,xl:3,xxl:3},"col-gap":12,collapsed:!p},{default:a(()=>[t(m,null,{default:a(()=>[t(c,{label:"发卡时间:"},{default:a(()=>[t(j,{class:"flex1",modelValue:e(g),"onUpdate:modelValue":l[0]||(l[0]=r=>Z(g)?g.value=r:g=r),onChange:A},null,8,["modelValue"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"代理商名称:"},{default:a(()=>[t(f,{modelValue:e(o).agentName,"onUpdate:modelValue":l[1]||(l[1]=r=>e(o).agentName=r),modelModifiers:{trim:!0},placeholder:"请输入代理商名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"销售人员:"},{default:a(()=>[t(f,{modelValue:e(o).sellingUser,"onUpdate:modelValue":l[2]||(l[2]=r=>e(o).sellingUser=r),modelModifiers:{trim:!0},placeholder:"请输入销售人员"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"批次号:"},{default:a(()=>[t(f,{modelValue:e(o).batchCode,"onUpdate:modelValue":l[3]||(l[3]=r=>e(o).batchCode=r),modelModifiers:{trim:!0},placeholder:"请输入批次号"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"商品类型:"},{default:a(()=>[t(b,{modelValue:e(o).cardType,"onUpdate:modelValue":l[4]||(l[4]=r=>e(o).cardType=r),options:[...e(h),...C.value]},null,8,["modelValue","options"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"卡号:"},{default:a(()=>[t(f,{modelValue:e(o).cardNo,"onUpdate:modelValue":l[5]||(l[5]=r=>e(o).cardNo=r),modelModifiers:{trim:!0},placeholder:"请输入卡号"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"激活状态:"},{default:a(()=>[t(b,{modelValue:e(o).activateStatus,"onUpdate:modelValue":l[6]||(l[6]=r=>e(o).activateStatus=r),options:[...e(h),...e(ae)]},null,8,["modelValue","options"])]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(c,{label:"状态:"},{default:a(()=>[t(b,{modelValue:e(o).status,"onUpdate:modelValue":l[7]||(l[7]=r=>e(o).status=r),options:[...e(h),...e(le)]},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),table:a(()=>[t(G,{"selected-keys":e(d).selectedKeys,"onUpdate:selectedKeys":l[8]||(l[8]=p=>e(d).selectedKeys=p),class:"zs-table","row-key":"id",data:e(E),"row-selection":e(d).rowSelection,bordered:e(d).bordered,pagination:e(d).pagination,size:e(d).size,columns:e(M),stripe:e(d).stripe,loading:e(F)},{operate:a(({record:p})=>[p.status==="0"?(T(),N(S,{key:0,content:"确认冻结吗?",onOk:r=>K(p)},{default:a(()=>[t(y,{type:"text",status:"danger"},{default:a(()=>[I("冻结")]),_:1})]),_:2},1032,["onOk"])):k("",!0),p.status==="1"?(T(),N(S,{key:1,content:"确认解冻吗?",onOk:r=>$(p)},{default:a(()=>[t(y,{type:"text",status:"success"},{default:a(()=>[I("解冻")]),_:1})]),_:2},1032,["onOk"])):k("",!0)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{ge as default};

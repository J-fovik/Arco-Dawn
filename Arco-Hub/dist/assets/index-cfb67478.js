import{a as J,n as $,p as F,O as S,P as O,d as q,E as W,s as X,R as Y,r,o as x,l as D,w as a,g as e,c as t,f as ee,i as y,e as ae,j as le,F as oe,V as Z,k as G,G as se,H as re,_ as ue,q as de,v as ie,x as ce,y as pe,z as j,h as me,A as _e}from"./index-8a2cb146.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{B as H}from"./business-b0ce0e8a.js";import"./index-2bbe694f.js";const ge=()=>{const{getDictionaryItem:h}=J();return[{title:"保险产品编号",dataIndex:"productCode",show:!0,align:"center",render:({record:d})=>$(d.productCode)},{title:"保险天数",dataIndex:"insuranceDays",show:!0,align:"center",render:({record:d})=>$(d.insuranceDays)},{title:"保险类别",dataIndex:"insuranceType",show:!0,align:"center",render:({record:d})=>$(h("insuranceType",d.insuranceType).detailName)},{title:"保险名称",dataIndex:"productName",show:!0,align:"center",tooltip:!0,ellipsis:!0,render:({record:d})=>$(d.productName)},{title:"保险公司名称",dataIndex:"company",show:!0,align:"center",tooltip:!0,ellipsis:!0,render:({record:d})=>$(d.company)},{title:"成本价格（元）",dataIndex:"costPrice",show:!0,align:"right",tooltip:!0,ellipsis:!0,render:({record:d})=>F("span",{class:"text-red text-price"},S(O(d.costPrice)))},{title:"同行价格（元）",dataIndex:"peerPrice",show:!0,align:"right",tooltip:!0,ellipsis:!0,render:({record:d})=>F("span",{class:"text-red text-price"},S(O(d.peerPrice)))},{title:"散客价格（元）",dataIndex:"individualPrice",show:!0,align:"right",tooltip:!0,ellipsis:!0,render:({record:d})=>F("span",{class:"text-red text-price"},S(O(d.individualPrice)))},{title:"操作",width:230,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ye=h=>(se("data-v-395bfe9e"),h=h(),re(),h),ve=ye(()=>ee("div",{style:{height:"20px","background-color":"#f8f8f8"}},null,-1)),be={style:{padding:"0 40px"}},Ve=q({name:"ZsAddUser"}),xe=q({...Ve,props:{regionList:{default:()=>({})}},emits:["close","success"],setup(h,{emit:d}){const{getDictionaryInfo:T}=J(),[M,B]=W(null),{form:i,formRef:N}=X(()=>({ageStart:1,ageEnd:150,areaName:"",productName:"",productCode:"",company:"",insuranceType:"",areaNo:"",insurancetDesc:""})),n=Y([]),E={productName:{required:!0,message:"请输入保险名称"},company:{required:!0,message:"请输入保险公司名称"},insuranceType:{required:!0,message:"请选择保险类别"},areaName:{required:!0,message:"请选择地区"},productCode:{required:!0,message:"请输入产品编号"},ageStart:{required:!0,message:"请输入承保年龄开始"},ageEnd:{required:!0,message:"请输入承保年龄结束"}},P=d,L=()=>{n.value.push({insuranceDays:n.value.length+1,costPrice:void 0,peerPrice:void 0,individualPrice:void 0})},f=v=>{n.value.splice(v,1)},C=(v,o)=>{o=="insuranceDays"?v||Z.error("天数不能为空！"):v||Z.error("价格不能为空！")},k=()=>{N.value.validate(v=>{if(v)return;if(!n.value.every(V=>Object.values(V).every(g=>g!==void 0&&g!=="")))return Z.error("天数价格不能为空！");z()})},z=async()=>{const{res:v,err:o}=await G(()=>H.addInsurAnce({...i.value,daysInfoList:n.value}),{before:()=>B("okLoading"),after:()=>B(null)});o||(P("success"),P("close"))};return(v,o)=>{const V=r("a-input"),g=r("a-form-item"),c=r("a-col"),I=r("a-select"),p=r("a-input-number"),u=r("a-row"),U=r("icon-plus"),w=r("a-button"),b=r("a-card"),A=r("icon-close"),R=r("a-form"),K=r("a-modal");return x(),D(K,{fullscreen:"",title:"新增保险","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":t(M)==="okLoading",onCancel:o[7]||(o[7]=m=>P("close")),onOk:k},{default:a(()=>[e(R,{ref_key:"formRef",ref:N,model:t(i),"label-align":"left",size:"large","auto-label-width":"",rules:E},{default:a(()=>[e(u,{gutter:24},{default:a(()=>[e(c,{span:8},{default:a(()=>[e(g,{field:"productName",label:"保险名称:",required:"",width:"100"},{default:a(()=>[e(V,{modelValue:t(i).productName,"onUpdate:modelValue":o[0]||(o[0]=m=>t(i).productName=m),placeholder:"请输入保险名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"company",label:"保险公司名称:",required:""},{default:a(()=>[e(V,{modelValue:t(i).company,"onUpdate:modelValue":o[1]||(o[1]=m=>t(i).company=m),placeholder:"请输入保险公司名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"insuranceType",label:"保险类别:",required:""},{default:a(()=>[e(I,{modelValue:t(i).insuranceType,"onUpdate:modelValue":o[2]||(o[2]=m=>t(i).insuranceType=m),placeholder:"请选择保险类别",options:t(T)("insuranceType"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"productCode",label:"产品编号:",required:""},{default:a(()=>[e(V,{modelValue:t(i).productCode,"onUpdate:modelValue":o[3]||(o[3]=m=>t(i).productCode=m),placeholder:"请输入产品编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"insurancetDesc",label:"详情信息:"},{default:a(()=>[e(V,{modelValue:t(i).insurancetDesc,"onUpdate:modelValue":o[4]||(o[4]=m=>t(i).insurancetDesc=m),placeholder:"请输入详情信息"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"ageStart",label:"承保年龄开始:"},{default:a(()=>[e(p,{modelValue:t(i).ageStart,"onUpdate:modelValue":o[5]||(o[5]=m=>t(i).ageStart=m),precision:0,"hide-button":"",min:0,max:150,placeholder:"请输入承保年龄开始"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(g,{field:"ageEnd",label:"承保年龄结束:"},{default:a(()=>[e(p,{modelValue:t(i).ageEnd,"onUpdate:modelValue":o[6]||(o[6]=m=>t(i).ageEnd=m),precision:0,"hide-button":"",min:0,max:150,placeholder:"请输入承保年龄结束"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ve,ee("div",be,[e(w,{type:"outline",style:{float:"right"},class:"mt20",onClick:L},{icon:a(()=>[e(U)]),default:a(()=>[y(" 新增天数 ")]),_:1})]),e(u,{gutter:24,style:{padding:"0 40px"},class:"mt20"},{default:a(()=>[e(c,{span:4},{default:a(()=>[e(b,{class:"cardBox"},{default:a(()=>[y("天数(天)")]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(b,{class:"cardBox"},{default:a(()=>[y("散客价格")]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(b,{class:"cardBox"},{default:a(()=>[y("同行价格")]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(b,{class:"cardBox"},{default:a(()=>[y("散客价格")]),_:1})]),_:1}),e(c,{span:2},{default:a(()=>[e(b,{class:"cardBox",style:{width:"100%"}},{default:a(()=>[y("操作")]),_:1})]),_:1})]),_:1}),(x(!0),ae(oe,null,le(n.value,(m,s)=>(x(),D(u,{gutter:24,style:{padding:"0 40px"},class:"mt20",key:s},{default:a(()=>[e(c,{span:4},{default:a(()=>[e(p,{class:"mt20",modelValue:n.value[s].insuranceDays,"onUpdate:modelValue":l=>n.value[s].insuranceDays=l,placeholder:"请输入保险天数",error:!n.value[s].insuranceDays,precision:0,onBlur:l=>C(n.value[s].insuranceDays,"insuranceDays")},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])]),_:2},1024),e(c,{span:6},{default:a(()=>[e(p,{class:"mt20",modelValue:n.value[s].costPrice,"onUpdate:modelValue":l=>n.value[s].costPrice=l,placeholder:"请输入散客价格(元)",error:!n.value[s].costPrice,formatter:l=>t(S)(l,""),parser:l=>l.replace(/,/g,""),precision:2,onBlur:l=>C(n.value[s].costPrice)},null,8,["modelValue","onUpdate:modelValue","error","formatter","parser","onBlur"])]),_:2},1024),e(c,{span:6},{default:a(()=>[e(p,{class:"mt20",modelValue:n.value[s].peerPrice,"onUpdate:modelValue":l=>n.value[s].peerPrice=l,placeholder:"请输入同行价格(元)",formatter:l=>t(S)(l,""),parser:l=>l.replace(/,/g,""),precision:2,error:!n.value[s].peerPrice,onBlur:l=>C(n.value[s].peerPrice)},null,8,["modelValue","onUpdate:modelValue","formatter","parser","error","onBlur"])]),_:2},1024),e(c,{span:6},{default:a(()=>[e(p,{class:"mt20",modelValue:n.value[s].individualPrice,"onUpdate:modelValue":l=>n.value[s].individualPrice=l,placeholder:"请输入散客价格(元)",formatter:l=>t(S)(l,""),parser:l=>l.replace(/,/g,""),precision:2,error:!n.value[s].individualPrice,onBlur:l=>C(n.value[s].individualPrice)},null,8,["modelValue","onUpdate:modelValue","formatter","parser","error","onBlur"])]),_:2},1024),e(c,{span:2,class:"delButton"},{default:a(()=>[e(w,{type:"outline",status:"danger",class:"mt20",onClick:l=>f(s)},{icon:a(()=>[e(A)]),default:a(()=>[y(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}});const he=ue(xe,[["__scopeId","data-v-395bfe9e"]]),Ce=q({name:"BusinessInsuranceManage"}),Te=q({...Ce,setup(h){const{warningModal:d}=_e(),{vAuthority:T}=de(),{getDictionaryInfo:M}=J(),[B,i]=W(null),N=Y([]),{form:n,resetForm:E}=X(()=>({insuranceType:"",productName:"",company:"",areaName:""}),()=>C()),{columnsData:P,visibleColumnsData:L,tableBaseOptions:f,resetData:C,extendTableList:k,setSelectRow:z,changeTableColumn:v,changeTableSize:o}=ie(ge(),()=>I()),V=p=>{d("确定删除该数据吗？",async u=>{const{res:U}=await G(()=>H.delInsurAnce({id:p}),{successMsg:"操作成功"});u(!0),U&&I()})},{data:g,loading:c,initData:I}=ce(async()=>{const{res:p,err:u}=await G(()=>H.getInsurAnceList({...n.value,currentPage:f.pagination.current,pageSize:f.pagination.pageSize}),{successMsg:""});return u?[]:(N.value=p.data.regionList,f.pagination.total=p.data.totalCount,k(p==null?void 0:p.data.dataList))});return pe(I),(p,u)=>{const U=r("a-select"),w=r("a-form-item"),b=r("a-grid-item"),A=r("a-input"),R=r("a-grid"),K=r("a-form"),m=r("icon-plus"),s=r("a-button"),l=r("a-space"),te=r("a-button-group"),ne=r("a-table");return x(),ae("div",null,[e(fe,{"table-columns":t(P),"table-size":t(f).size,onResetSearch:t(E),onSearch:t(C),onChangeTableSize:t(o),onChangeTableColumn:t(v)},{form:a(()=>[e(K,{model:t(n),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[e(R,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[e(b,null,{default:a(()=>[e(w,{label:"保险类型:"},{default:a(()=>[e(U,{modelValue:t(n).insuranceType,"onUpdate:modelValue":u[0]||(u[0]=_=>t(n).insuranceType=_),placeholder:"请选择保险类型",options:t(M)("insuranceType"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(w,{label:"保险名称:"},{default:a(()=>[e(A,{modelValue:t(n).productName,"onUpdate:modelValue":u[1]||(u[1]=_=>t(n).productName=_),modelModifiers:{trim:!0},placeholder:"请输入保险名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(w,{label:"保险公司名称:"},{default:a(()=>[e(A,{modelValue:t(n).company,"onUpdate:modelValue":u[2]||(u[2]=_=>t(n).company=_),modelModifiers:{trim:!0},placeholder:"请输入保险公司名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[e(l,null,{default:a(()=>[j((x(),D(s,{type:"outline",onClick:u[3]||(u[3]=_=>t(i)("ZsAddInsurance"))},{icon:a(()=>[e(m)]),default:a(()=>[y(" 新增 ")]),_:1})),[[t(T),"BusinessInsuranceManageAdd"]])]),_:1})]),table:a(()=>[e(ne,{"selected-keys":t(f).selectedKeys,"onUpdate:selectedKeys":u[4]||(u[4]=_=>t(f).selectedKeys=_),class:"zs-table","row-key":"id",data:t(g),"row-selection":t(f).rowSelection,bordered:t(f).bordered,pagination:t(f).pagination,size:t(f).size,columns:t(L),stripe:t(f).stripe,loading:t(c)},{operate:a(({record:_})=>[e(te,null,{default:a(()=>[j((x(),D(s,{type:"text",status:"danger",loading:t(B)==="删除",onClick:Q=>t(z)(_,()=>V(_.id))},{default:a(()=>[y(" 删除 ")]),_:2},1032,["loading","onClick"])),[[t(T),"BusinessInsuranceManageDelete"]]),e(s,{type:"text",status:"success",onClick:Q=>p.$router.push(`/business/insuranceManage/operate?id=${_.id}&isReadOnly=true`)},{default:a(()=>[y("详情")]),_:2},1032,["onClick"]),j((x(),D(s,{type:"text",onClick:Q=>p.$router.push(`/business/insuranceManage/operate?id=${_.id}`)},{default:a(()=>[y("编辑")]),_:2},1032,["onClick"])),[[t(T),"BusinessInsuranceManageEdit"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),t(B)==="ZsAddInsurance"?(x(),D(he,{key:0,"region-list":N.value,onSuccess:t(I),onClose:u[5]||(u[5]=_=>t(z)({},()=>t(i)(null)))},null,8,["region-list","onSuccess"])):me("",!0)])}}});export{Te as default};

import{d as E,a as U,E as w,s as z,r,o as p,l as b,w as t,g as a,e as D,c as e,F as N,j as B,O as M,h as R,k as F,i as f,t as c,u as K,C as j,b as L,f as g}from"./index-8a2cb146.js";import{Z as P}from"./index-2bbe694f.js";import{O as h}from"./order-70291d37.js";const G=E({name:"ZsExamineSettlement"}),q=E({...G,props:{data:{default:()=>({})},isRemake:{type:Boolean,default:!1},type:{}},emits:["close","success"],setup($,{emit:v}){const{getDictionaryInfo:x}=U(),k=$,_=v,[n,A]=w(null),{form:s,formRef:l}=z(()=>({applyDesc:"",setMode:"",setMethod:"",sxf:void 0})),u={setMode:{required:!0,message:"请选择结算方式"},setMethod:{required:!0,message:"请选择手动方式"},sxf:{required:!0,message:"请输入手续费"},applyDesc:{validator:(m,d)=>{!m&&k.isRemake&&d("审核驳回时备注必填")}}},i=()=>{l.value.validate(m=>{m||(k.type==="success"?V("financeSettlementExamineSuccess"):V("financeSettlementExamineFail"))})},V=async m=>{const{err:d}=await F(()=>h[m]({batchId:k.data.id,...s.value}),{before:()=>A("okLoading"),after:()=>A(""),successMsg:"操作成功"});d||(_("success"),_("close"))};return(m,d)=>{const S=r("a-radio"),C=r("a-radio-group"),y=r("a-form-item"),Z=r("a-input-number"),I=r("a-textarea"),O=r("a-form"),T=r("a-modal");return p(),b(T,{width:"600px",top:"10%","unmount-on-close":"",visible:"","align-center":!1,title:`审核${m.type==="success"?"通过":"驳回"}`,"mask-closable":!1,"ok-loading":e(n)==="okLoading",onCancel:d[4]||(d[4]=o=>_("close")),onOk:i},{default:t(()=>[a(O,{ref_key:"formRef",ref:l,model:e(s),"label-align":"left",size:"large","auto-label-width":"",rules:u},{default:t(()=>[m.type==="success"?(p(),D(N,{key:0},[a(y,{field:"setMode",label:"结算方式:"},{default:t(()=>[a(C,{modelValue:e(s).setMode,"onUpdate:modelValue":d[0]||(d[0]=o=>e(s).setMode=o)},{default:t(()=>[(p(!0),D(N,null,B(e(x)("setMode"),o=>(p(),b(S,{value:o.detailCode},{default:t(()=>[f(c(o.detailName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),a(y,{field:"setMethod",label:"手动方式:"},{default:t(()=>[a(C,{modelValue:e(s).setMethod,"onUpdate:modelValue":d[1]||(d[1]=o=>e(s).setMethod=o)},{default:t(()=>[(p(!0),D(N,null,B(e(x)("setMethod"),o=>(p(),b(S,{value:o.detailCode},{default:t(()=>[f(c(o.detailName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),a(y,{field:"sxf",label:"手续费:"},{default:t(()=>[a(Z,{modelValue:e(s).sxf,"onUpdate:modelValue":d[2]||(d[2]=o=>e(s).sxf=o),formatter:o=>e(M)(o,""),parser:o=>o.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入手续费"},null,8,["modelValue","formatter","parser"])]),_:1})],64)):R("",!0),a(y,{field:"applyDesc",label:"备注:"},{default:t(()=>[a(I,{modelValue:e(s).applyDesc,"onUpdate:modelValue":d[3]||(d[3]=o=>e(s).applyDesc=o),modelModifiers:{trim:!0},placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),H={class:"text-red text-price"},J={class:"text-red text-price"},Q={class:"text-red text-price"},W={class:"text-red text-price"},X=g("div",{style:{height:"100px"}},null,-1),Y={class:"orderSubmit-footer box-flex jc-fe"},ee=E({name:"OrderFinanceSettlementExamineOperate"}),se=E({...ee,setup($){const v=K(),{jumpTabName:x}=j(),[k,_]=w(""),{data:n,loading:A}=L(async()=>{const{res:s,err:l}=await F(()=>h.getFinanceSettlementExamineDetail({batchId:v.query.id}));if(!l)return{...s==null?void 0:s.data,invoiceMap:s==null?void 0:s.data.invoiceMap.all.map(u=>({name:u.attName,url:u.attPath,status:"done",uid:u.id,attSize:u.attSize}))}},{invoiceMap:[],settleRecordApply:{}});return(s,l)=>{const u=r("a-tag"),i=r("a-descriptions-item"),V=r("a-descriptions"),m=r("a-card"),d=r("a-upload"),S=r("a-button"),C=r("a-space");return p(),b(P,null,{default:t(()=>[a(m,{title:"结算详情",loading:e(A),bordered:!1,class:"general-card"},{default:t(()=>[a(V,{size:"large",column:3},{default:t(()=>[a(i,{label:"结算团号："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).groupIds),1)]),_:1})]),_:1}),a(i,{label:"供应商："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).settleRecordApply.supName),1)]),_:1})]),_:1}),a(i,{label:"订单同行总费用："},{default:t(()=>[g("span",H,c(e(M)(`${e(n).settleRecordApply.supsigCost??0}`)),1)]),_:1}),a(i,{label:"供应商结算费用："},{default:t(()=>[g("span",J,c(e(M)(`${e(n).settleRecordApply.moneyTotal??0}`)),1)]),_:1}),a(i,{label:"已结算金额："},{default:t(()=>[g("span",Q,c(e(M)(`${e(n).settleRecordApply.totalSettledAmount??0}`)),1)]),_:1}),a(i,{label:"本次申请结算金额："},{default:t(()=>[g("span",W,c(e(M)(`${e(n).settleRecordApply.money??0}`)),1)]),_:1}),a(i,{label:"户名："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).settleRecordApply.receiveUserName),1)]),_:1})]),_:1}),a(i,{label:"账号："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).settleRecordApply.receiveNum),1)]),_:1})]),_:1}),a(i,{label:"开户行："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).settleRecordApply.receiveBankName),1)]),_:1})]),_:1}),a(i,{label:"联行号："},{default:t(()=>[a(u,null,{default:t(()=>[f(c(e(n).settleRecordApply.receiveSettleBankNo),1)]),_:1})]),_:1}),e(n).settleRecordApply.applyDesc?(p(),b(i,{key:0,label:"平台经理审核备注："},{default:t(()=>[g("span",null,c(e(n).settleRecordApply.receiveSettleBankNo),1)]),_:1})):R("",!0)]),_:1})]),_:1},8,["loading"]),e(n).invoiceMap.length?(p(),b(m,{key:0,title:"发票信息",bordered:!1,class:"general-card margin-top"},{default:t(()=>[a(d,{"file-list":e(n).invoiceMap,"auto-upload":!1,limit:1,"show-remove-button":!1,"show-retry-button":!1},null,8,["file-list"])]),_:1})):R("",!0),X,g("div",Y,[a(C,null,{default:t(()=>[e(v).query.isExamine?(p(),D(N,{key:0},[a(S,{type:"primary",onClick:l[0]||(l[0]=y=>e(_)("ZsExamineSettlementSuccess"))},{default:t(()=>[f("通过")]),_:1}),a(S,{status:"danger",onClick:l[1]||(l[1]=y=>e(_)("ZsExamineSettlementFail"))},{default:t(()=>[f("驳回")]),_:1})],64)):R("",!0),a(S,{onClick:l[2]||(l[2]=()=>e(x)())},{default:t(()=>[f("返回")]),_:1})]),_:1})]),e(k)==="ZsExamineSettlementSuccess"?(p(),b(q,{key:1,data:{id:e(v).query.id},type:"success","is-remake":!1,onClose:l[3]||(l[3]=y=>e(_)("")),onSuccess:l[4]||(l[4]=()=>e(x)())},null,8,["data"])):R("",!0),e(k)==="ZsExamineSettlementFail"?(p(),b(q,{key:2,data:{id:e(v).query.id},type:"fail","is-remake":!0,onClose:l[5]||(l[5]=y=>e(_)("")),onSuccess:l[6]||(l[6]=()=>e(x)())},null,8,["data"])):R("",!0)]),_:1})}}});export{se as default};

import{n as c,d as D,q as ee,E as te,s as ae,v as oe,M as ne,I as x,x as le,y as re,r as d,o as g,e as ie,g as o,w as n,c as e,z as b,l as h,i as _,f as se,k as w,A as de,Y as ce,X as I}from"./index-8a2cb146.js";import{_ as ue}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{T as M}from"./ticket-f7c21268.js";import"./index-2bbe694f.js";const pe=()=>[{title:"供应商名称",dataIndex:"planeTicketName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:r})=>c(r.planeTicketName)},{title:"联系人",dataIndex:"planeTicketContacts",show:!0,align:"center",render:({record:r})=>c(r.planeTicketContacts)},{title:"联系电话",dataIndex:"planeTicketContactsPhone",show:!0,align:"center",render:({record:r})=>c(r.planeTicketContactsPhone)},{title:"所属国家",dataIndex:"country",show:!0,align:"center",render:({record:r})=>c(r.country)},{title:"所属省",dataIndex:"province",show:!0,align:"center",render:({record:r})=>c(r.province)},{title:"所属市",dataIndex:"city",show:!0,align:"center",render:({record:r})=>c(r.city)},{title:"合作期限开始",dataIndex:"periodCooperateStart",show:!0,align:"center",render:({record:r})=>c(r.periodCooperateStart)},{title:"合作期限结束",dataIndex:"periodCooperateEnd",show:!0,align:"center",render:({record:r})=>c(r.periodCooperateEnd)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],me=se("span",{class:"mx-3"},"-",-1),Ce=D({name:"TicketCooperateManage"}),ke=D({...Ce,setup(r){const{vAuthority:f}=ee(),{warningModal:z}=de(),[A,ge]=te(null),{form:a,resetForm:E}=ae(()=>({country:"",countryCode:"",province:"",provinceCode:"",city:"",cityCode:"",planeTicketName:"",periodCooperateStart:"",periodCooperateEnd:""}),()=>k()),{selectRow:_e,columnsData:$,visibleColumnsData:K,tableBaseOptions:s,resetData:k,setSelectRow:fe,extendTableList:ye,changeTableColumn:U,changeTableSize:Y}=oe(pe(),()=>v()),y=async i=>{const{res:t}=await w(()=>ce.getAreaInfo(i));return(t==null?void 0:t.data)??[]},{data:T}=ne(async()=>await y({level:"1"}),[]),{data:N}=x(async()=>await y({parentNo:a.value.countryCode}),{watchSource:()=>a.value.countryCode,defaultValue:[]}),{data:S}=x(async()=>await y({parentNo:a.value.provinceCode}),{watchSource:()=>a.value.provinceCode,defaultValue:[]}),P=i=>{a.value.provinceCode="",a.value.province="",a.value.cityCode="",a.value.city="",a.value.country=T.value.find(t=>t.areaNo==i).areaName},B=i=>{a.value.cityCode="",a.value.city="",a.value.province=N.value.find(t=>t.areaNo==i).areaName},L=i=>{a.value.city=S.value.find(t=>t.areaNo==i).areaName},R=i=>{z(`确定操作选中的${s.selectedKeys.length}数据吗？`,async t=>{const{res:u}=await w(()=>M[i]({idList:s.selectedKeys}),{successMsg:"操作成功"});t(!0),u&&(s.selectedKeys=[],v())})},{data:O,loading:q,initData:v}=le(async()=>{const{res:i,err:t}=await w(()=>M.getTicketList({...a.value,periodCooperateStart:I(a.value.periodCooperateStart,"YYYYMMDD",""),periodCooperateEnd:I(a.value.periodCooperateEnd,"YYYYMMDD",""),currentPage:s.pagination.current,pageSize:s.pagination.pageSize,pagingOrNot:"1"}));return t?[]:(s.pagination.total=i.data.totalCount,i.data.list)});return re(v),(i,t)=>{const u=d("a-select"),p=d("a-form-item"),m=d("a-grid-item"),F=d("a-input"),V=d("a-date-picker"),W=d("a-grid"),X=d("a-form"),j=d("icon-plus"),C=d("a-button"),G=d("icon-close"),H=d("a-space"),J=d("a-button-group"),Q=d("a-table");return g(),ie("div",null,[o(ue,{"table-columns":e($),"table-size":e(s).size,onResetSearch:e(E),onSearch:e(k),onChangeTableSize:e(Y),onChangeTableColumn:e(U)},{form:n(()=>[o(X,{model:e(a),"label-align":"left",size:"large","auto-label-width":""},{default:n(()=>[o(W,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:n(()=>[o(m,null,{default:n(()=>[o(p,{field:"country",label:"所属国家:"},{default:n(()=>[o(u,{modelValue:e(a).countryCode,"onUpdate:modelValue":t[0]||(t[0]=l=>e(a).countryCode=l),"allow-search":"",options:e(T),"field-names":{label:"areaName",value:"areaNo"},"virtual-list-props":{height:200},placeholder:"请选择所属国家",onChange:P},null,8,["modelValue","options"])]),_:1})]),_:1}),o(m,null,{default:n(()=>[o(p,{field:"province",label:"所属省:"},{default:n(()=>[o(u,{modelValue:e(a).provinceCode,"onUpdate:modelValue":t[1]||(t[1]=l=>e(a).provinceCode=l),options:e(N),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属省",onChange:B},null,8,["modelValue","options"])]),_:1})]),_:1}),o(m,null,{default:n(()=>[o(p,{field:"city",label:"所属城市:"},{default:n(()=>[o(u,{modelValue:e(a).cityCode,"onUpdate:modelValue":t[2]||(t[2]=l=>e(a).cityCode=l),options:e(S),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属市",onChange:L},null,8,["modelValue","options"])]),_:1})]),_:1}),o(m,null,{default:n(()=>[o(p,{field:"planeTicketName",label:"供应商名称:"},{default:n(()=>[o(F,{modelValue:e(a).planeTicketName,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).planeTicketName=l),modelModifiers:{trim:!0},placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1})]),_:1}),o(m,null,{default:n(()=>[o(p,{label:"选择日期:"},{default:n(()=>[o(V,{modelValue:e(a).periodCooperateStart,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).periodCooperateStart=l),class:"flex1",placeholder:"合作期限开始日期"},null,8,["modelValue"]),me,o(V,{modelValue:e(a).periodCooperateEnd,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).periodCooperateEnd=l),class:"flex1",placeholder:"合作期限结束日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:n(()=>[o(H,null,{default:n(()=>[b((g(),h(C,{type:"outline",onClick:t[6]||(t[6]=l=>i.$router.push("/ticket/cooperateManage/operate"))},{icon:n(()=>[o(j)]),default:n(()=>[_(" 新增 ")]),_:1})),[[e(f),"TicketCooperateManageAdd"]]),b((g(),h(C,{type:"outline",status:"danger",disabled:!e(s).selectedKeys.length,loading:e(A)==="删除",onClick:t[7]||(t[7]=l=>R("delPlaneTicket"))},{icon:n(()=>[o(G)]),default:n(()=>[_(" 删除 ")]),_:1},8,["disabled","loading"])),[[e(f),"TicketCooperateManageDelete"]])]),_:1})]),table:n(()=>[o(Q,{"selected-keys":e(s).selectedKeys,"onUpdate:selectedKeys":t[8]||(t[8]=l=>e(s).selectedKeys=l),class:"zs-table","row-key":"id",data:e(O),"row-selection":e(s).rowSelection,bordered:e(s).bordered,pagination:e(s).pagination,size:e(s).size,columns:e(K),stripe:e(s).stripe,loading:e(q)},{operate:n(({record:l})=>[o(J,null,{default:n(()=>[o(C,{type:"text",status:"success",onClick:Z=>i.$router.push(`/ticket/cooperateManage/operate?id=${l.id}&isReadOnly=true`)},{default:n(()=>[_("详情")]),_:2},1032,["onClick"]),b((g(),h(C,{type:"text",onClick:Z=>i.$router.push(`/ticket/cooperateManage/operate?id=${l.id}`)},{default:n(()=>[_("编辑")]),_:2},1032,["onClick"])),[[e(f),"TicketCooperateManageEdit"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{ke as default};

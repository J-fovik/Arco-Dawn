import{d as M,h as $,i as h,D as W,r as s,o as K,l as q,w as t,a as l,b as e,s as X,m as B,n as Y,j as L,c as ee,e as I,p as le,q as ae}from"./index-d007178a.js";import{f as z,t as U,c as te,_ as oe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{A as ne}from"./options-aafac76d.js";import{M as C}from"./major-b28f8c7d.js";import"./index-13860ba0.js";const de=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"专业门类",dataIndex:"xkml",show:!0,align:"center",render:({record:p})=>z(p.xkml)},{title:"专业大类",dataIndex:"zyl",show:!0,align:"center",render:({record:p})=>z(p.zyl)},{title:"专业名称",dataIndex:"zymc",show:!0,align:"center",render:({record:p})=>z(p.zymc)},{title:"专业层次",dataIndex:"cc",show:!0,align:"center",render:({record:p})=>z(p.cc)},{title:"修业年限",dataIndex:"xyNx",show:!0,align:"center",render:({record:p})=>z(p.xyNx)},{title:"专业代码",dataIndex:"zydm",show:!0,align:"center",render:({record:p})=>z(p.zydm)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],O=[{label:"专科",value:"专科"},{label:"本科",value:"本科"}],ue=X("div",{style:{padding:"0 10px"}},":",-1),se=M({name:"ZsAddMajor"}),re=M({...se,props:{data:{default:()=>({})}},emits:["close","success"],setup(p,{emit:w}){const V=p,[v,c]=$(null),{form:o,formRef:k}=h(()=>({...V.data})),T={zymc:{required:!0,message:"请输入专业名称"},xkml:{required:!0,message:"请输入专业门类"},zyl:{required:!0,message:"请输入专业大类"},cc:{required:!0,message:"请输入专业层次"}},S=()=>{k.value.validate(y=>{y||(V.data.id?m("editMajor"):m("addMajor"))})},m=async y=>{const{err:n}=await B(()=>C[y]({majorEntity:{...o.value,xbBl:o.value.nBl!==void 0?`${o.value.nBl}:${o.value.vBl}`:null}}),{before:()=>c("okLoading"),after:()=>c(null)});n||(w("success"),w("close"))};return W(()=>o.value.nBl,y=>{o.value.vBl=100-y}),(y,n)=>{const i=s("a-input"),d=s("a-form-item"),u=s("a-grid-item"),N=s("a-select"),g=s("a-input-number"),R=s("a-input-group"),x=s("a-textarea"),j=s("a-grid"),f=s("a-form"),r=s("a-modal");return K(),q(r,{title:e(te)("专业",!!V.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"80vw","align-center":!1,"mask-closable":!1,"ok-loading":e(v)==="okLoading",onCancel:n[21]||(n[21]=a=>w("close")),onOk:S},{default:t(()=>[l(f,{ref_key:"formRef",ref:k,model:e(o),"label-align":"left",size:"large","auto-label-width":"",rules:T},{default:t(()=>[l(j,{cols:2,"col-gap":24},{default:t(()=>[l(u,null,{default:t(()=>[l(d,{field:"zymc",label:"专业名称:"},{default:t(()=>[l(i,{modelValue:e(o).zymc,"onUpdate:modelValue":n[0]||(n[0]=a=>e(o).zymc=a),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"xkml",label:"专业门类:"},{default:t(()=>[l(i,{modelValue:e(o).xkml,"onUpdate:modelValue":n[1]||(n[1]=a=>e(o).xkml=a),placeholder:"请输入专业门类"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"zyl",label:"专业大类:"},{default:t(()=>[l(i,{modelValue:e(o).zyl,"onUpdate:modelValue":n[2]||(n[2]=a=>e(o).zyl=a),placeholder:"请输入专业大类"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"cc",label:"专业层次:"},{default:t(()=>[l(N,{modelValue:e(o).cc,"onUpdate:modelValue":n[3]||(n[3]=a=>e(o).cc=a),options:e(O),placeholder:"请输入专业层次"},null,8,["modelValue","options"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"zydm",label:"专业代码:"},{default:t(()=>[l(i,{modelValue:e(o).zydm,"onUpdate:modelValue":n[4]||(n[4]=a=>e(o).zydm=a),placeholder:"请输入专业代码"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"xyNx",label:"修业年限:"},{default:t(()=>[l(i,{modelValue:e(o).xyNx,"onUpdate:modelValue":n[5]||(n[5]=a=>e(o).xyNx=a),placeholder:"请输入修业年限"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"xkJy",label:"选考建议:"},{default:t(()=>[l(i,{modelValue:e(o).xkJy,"onUpdate:modelValue":n[6]||(n[6]=a=>e(o).xkJy=a),placeholder:"请输入选考（学科）建议"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"dyyx",label:"第一印象:"},{default:t(()=>[l(i,{modelValue:e(o).dyyx,"onUpdate:modelValue":n[7]||(n[7]=a=>e(o).dyyx=a),placeholder:"请输入第一印象"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"xbBl",label:"男女比例:"},{default:t(()=>[l(R,null,{default:t(()=>[l(g,{modelValue:e(o).nBl,"onUpdate:modelValue":n[8]||(n[8]=a=>e(o).nBl=a),formatter:a=>e(U)(a,""),parser:a=>a.replace(/,/g,""),precision:0,min:0,max:100,"hide-button":"",placeholder:"男性比例"},null,8,["modelValue","formatter","parser"]),ue,l(g,{modelValue:e(o).vBl,"onUpdate:modelValue":n[9]||(n[9]=a=>e(o).vBl=a),formatter:a=>e(U)(a,""),parser:a=>a.replace(/,/g,""),precision:0,min:0,max:100,disabled:"","hide-button":"",placeholder:"女性比例"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"jyl",label:"就业率:"},{default:t(()=>[l(g,{modelValue:e(o).jyl,"onUpdate:modelValue":n[10]||(n[10]=a=>e(o).jyl=a),formatter:a=>e(U)(a,""),parser:a=>a.replace(/,/g,""),precision:2,min:0,max:.99,"hide-button":"",placeholder:"请输入就业率"},null,8,["modelValue","formatter","parser","max"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"jyQx",label:"就业去向:"},{default:t(()=>[l(i,{modelValue:e(o).jyQx,"onUpdate:modelValue":n[11]||(n[11]=a=>e(o).jyQx=a),placeholder:"请输入就业去向"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"jyDq",label:"就业地区分布:"},{default:t(()=>[l(i,{modelValue:e(o).jyDq,"onUpdate:modelValue":n[12]||(n[12]=a=>e(o).jyDq=a),placeholder:"请输入就业地区分布"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"jyHy",label:"就业行业分布:"},{default:t(()=>[l(i,{modelValue:e(o).jyHy,"onUpdate:modelValue":n[13]||(n[13]=a=>e(o).jyHy=a),placeholder:"请输入就业行业分布"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"jyGw",label:"就业岗位分布:"},{default:t(()=>[l(i,{modelValue:e(o).jyGw,"onUpdate:modelValue":n[14]||(n[14]=a=>e(o).jyGw=a),placeholder:"请输入就业岗位分布"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"syxw",label:"授予学位:"},{default:t(()=>[l(i,{modelValue:e(o).syxw,"onUpdate:modelValue":n[15]||(n[15]=a=>e(o).syxw=a),placeholder:"请输入授予学位"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(d,{field:"pjxz",label:"平均薪资:"},{default:t(()=>[l(g,{modelValue:e(o).pjxz,"onUpdate:modelValue":n[16]||(n[16]=a=>e(o).pjxz=a),formatter:a=>e(U)(a,""),parser:a=>a.replace(/,/g,""),precision:2,min:0,"hide-button":"",placeholder:"请输入平均薪资"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(d,{field:"ssm",label:"专业是什么:"},{default:t(()=>[l(x,{modelValue:e(o).ssm,"onUpdate:modelValue":n[17]||(n[17]=a=>e(o).ssm=a),"auto-size":{minRows:4},placeholder:"请输入专业是什么"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(d,{field:"xsm",label:"专业学什么:"},{default:t(()=>[l(x,{modelValue:e(o).xsm,"onUpdate:modelValue":n[18]||(n[18]=a=>e(o).xsm=a),"auto-size":{minRows:4},placeholder:"请输入专业学什么"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(d,{field:"gsm",label:"专业干什么:"},{default:t(()=>[l(x,{modelValue:e(o).gsm,"onUpdate:modelValue":n[19]||(n[19]=a=>e(o).gsm=a),"auto-size":{minRows:4},placeholder:"请输入专业干什么"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(d,{field:"xj",label:"专业详解:"},{default:t(()=>[l(x,{modelValue:e(o).xj,"onUpdate:modelValue":n[20]||(n[20]=a=>e(o).xj=a),"auto-size":{minRows:4},placeholder:"请输入专业详解"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),me=M({name:"MajorMajorManage"}),be=M({...me,setup(p){const{warningModal:w}=ae(),[V,v]=$(null),{form:c,resetForm:o}=h(()=>({types:[],zymc:"",cc:""}),()=>y()),{selectRow:k,columnsData:T,visibleColumnsData:S,tableBaseOptions:m,resetData:y,createRowNo:n,setSelectRow:i,changeTableColumn:d,changeTableSize:u}=Y(de(),()=>j()),N=()=>{w(`确定删除选中的${m.selectedKeys.length}数据吗？`,async f=>{const{err:r}=await B(()=>C.deleteMajor({ids:m.selectedKeys}),{successMsg:"操作成功"});r||(f(!0),m.selectedKeys=[],j())})},{data:g}=L(async()=>{const{res:f,err:r}=await B(()=>C.getMajorTypeList({}));return r?[]:f.data.map(a=>({label:a.xkml,value:a.xkml,children:a.childs.map(b=>({label:b.zyl,value:b.zyl}))}))}),{data:R,loading:x,initData:j}=L(async()=>{const{res:f,err:r}=await B(()=>C.getMajorList({...c.value,currentPage:m.pagination.current,pageSize:m.pagination.pageSize,pagingOrNot:"1",zumc:c.value.types[0]??"",zyl:c.value.types[1]??""}));return r?[]:(m.pagination.total=f.data.totalCount,f==null?void 0:f.data.majorList.map((a,b)=>({sortTableNo:n(b),...a,nBl:a.xbBl?a.xbBl.split(":")[0]*1:void 0,vBl:a.xbBl?a.xbBl.split(":")[1]*1:void 0})))});return(f,r)=>{const a=s("a-input"),b=s("a-form-item"),A=s("a-grid-item"),J=s("a-select"),E=s("a-cascader"),P=s("a-grid"),G=s("a-form"),H=s("icon-plus"),D=s("a-button"),Q=s("icon-close"),F=s("a-space"),Z=s("a-table");return K(),ee("div",null,[l(oe,{"table-columns":e(T),"table-size":e(m).size,onResetSearch:e(o),onSearch:e(y),onChangeTableSize:e(u),onChangeTableColumn:e(d)},{form:t(()=>[l(G,{model:e(c),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[l(P,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:t(()=>[l(A,null,{default:t(()=>[l(b,{label:"专业名称:"},{default:t(()=>[l(a,{modelValue:e(c).zymc,"onUpdate:modelValue":r[0]||(r[0]=_=>e(c).zymc=_),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(A,null,{default:t(()=>[l(b,{label:"专业层次:"},{default:t(()=>[l(J,{modelValue:e(c).cc,"onUpdate:modelValue":r[1]||(r[1]=_=>e(c).cc=_),options:[...e(ne),...e(O)],placeholder:"请选择专业层次"},null,8,["modelValue","options"])]),_:1})]),_:1}),l(A,null,{default:t(()=>[l(b,{label:"专业类:"},{default:t(()=>[l(E,{modelValue:e(c).types,"onUpdate:modelValue":r[2]||(r[2]=_=>e(c).types=_),placeholder:"请选择专业类","path-mode":"","allow-search":"","allow-clear":"",options:e(g)},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:t(()=>[l(F,null,{default:t(()=>[l(D,{type:"outline",onClick:r[3]||(r[3]=_=>e(v)("zsAddMajor"))},{icon:t(()=>[l(H)]),default:t(()=>[I(" 新增 ")]),_:1}),l(D,{type:"outline",status:"danger",disabled:!e(m).selectedKeys.length,loading:e(V)==="删除",onClick:N},{icon:t(()=>[l(Q)]),default:t(()=>[I(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:t(()=>[l(Z,{"selected-keys":e(m).selectedKeys,"onUpdate:selectedKeys":r[4]||(r[4]=_=>e(m).selectedKeys=_),class:"zs-table","row-key":"id",data:e(R),"row-selection":e(m).rowSelection,bordered:e(m).bordered,pagination:e(m).pagination,size:e(m).size,columns:e(S),stripe:e(m).stripe,loading:e(x)},{operate:t(({record:_})=>[l(D,{type:"text",onClick:ie=>e(i)(_,()=>e(v)("zsAddMajor"))},{default:t(()=>[I("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(V)==="zsAddMajor"?(K(),q(re,{key:0,data:e(k),onSuccess:e(j),onClose:r[5]||(r[5]=_=>e(i)({},()=>e(v)(null)))},null,8,["data","onSuccess"])):le("",!0)])}}});export{be as default};

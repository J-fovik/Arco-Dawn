import{a as Y,n as p,X as F,p as K,O as q,P as X,d as k,m as G,q as H,E as J,s as Q,v as W,M as Z,x as ee,y as te,r as d,o as f,e as ae,g as a,w as r,c as e,l as S,i as h,h as y,z as w,V as re,A as le,k as T}from"./index-8a2cb146.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{B as oe}from"./business-b0ce0e8a.js";import{R as se}from"./reconciliation-6ca30c07.js";import"./index-2bbe694f.js";const ie=()=>{const{getDictionaryItem:_}=Y();return[{title:"团号",dataIndex:"groupId",show:!0,align:"center",render:({record:l})=>p(l.groupId)},{title:"营业部名称",dataIndex:"departName",show:!0,align:"center",ellipsis:!0,tooltip:!0,render:({record:l})=>p(l.departName)},{title:"线路名称",dataIndex:"routeName",show:!0,align:"center",ellipsis:!0,tooltip:!0,render:({record:l})=>p(l.routeName)},{title:"目的地",dataIndex:"arrival",show:!0,align:"center",ellipsis:!0,tooltip:!0,render:({record:l})=>p(l.arrival)},{title:"创建时间",dataIndex:"createTime",show:!0,align:"center",render:({record:l})=>F(l.createTime,"YYYY-MM-DD")},{title:"报名总费用",dataIndex:"signCost",show:!0,align:"right",render:({record:l})=>K("span",{class:"text-red text-price"},q(X(l.signCost)))},{title:"结算状态",dataIndex:"settleType",show:!0,align:"center",render:({record:l})=>p(_("new_settlement_type",l.settleType).detailName)},{title:"订单状态",dataIndex:"state",show:!0,align:"center",render:({record:l})=>p(_("new_trade_order",l.state).detailName)},{title:"调账状态",dataIndex:"transferState",show:!0,align:"center",render:({record:l})=>p(_("travelRouteAdjustmentState",l.transferState).detailName)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ue=k({name:"ReconciliationSupplierOrder"}),_e=k({...ue,setup(_){const l=G(),{vAuthority:I}=H(),{warningModal:V}=le();J(null);const{form:i,resetForm:v}=Q(()=>({groupId:"",departName:"",departNo:"",routeName:"",arrival:""}),()=>x()),{selectRow:de,columnsData:R,visibleColumnsData:z,tableBaseOptions:u,resetData:x,setSelectRow:C,extendTableList:D,changeTableColumn:O,changeTableSize:A}=W(ie(),()=>N());Z(async()=>{const{err:o,res:t}=await T(()=>oe.getDepartsBox({}));if(!o)return t==null?void 0:t.data});const M=o=>{if(o.settleType!="0"){re.error("当前团已经开始结算或结算完成，不允许进行调账！");return}l.push(`/reconciliation/supplierOrder/operate?groupId=${o.groupId}&isReadOnly=true`)},$=o=>{V("确认要通过?",async t=>{t(!0)})},{data:B,loading:U,initData:N}=ee(async()=>{const{res:o,err:t}=await T(()=>se.getSupplierList({...i.value,currentPage:u.pagination.current,pageSize:u.pagination.pageSize,pagingOrNot:"1"}));return t?[]:(u.pagination.total=o.data.totalCount,D(o==null?void 0:o.data.signupRecordList))});return te(N),(o,t)=>{const c=d("a-input"),m=d("a-form-item"),g=d("a-grid-item"),E=d("a-grid"),j=d("a-form"),b=d("a-button"),L=d("a-button-group"),P=d("a-table");return f(),ae("div",null,[a(ne,{fold:"","table-columns":e(R),"table-size":e(u).size,onResetSearch:e(v),onSearch:e(x),onChangeTableSize:e(A),onChangeTableColumn:e(O)},{form:r(({collapsed:n})=>[a(j,{model:e(i),"label-align":"left",size:"large","auto-label-width":""},{default:r(()=>[a(E,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!n},{default:r(()=>[a(g,null,{default:r(()=>[a(m,{label:"团号:"},{default:r(()=>[a(c,{modelValue:e(i).groupId,"onUpdate:modelValue":t[0]||(t[0]=s=>e(i).groupId=s),modelModifiers:{trim:!0},placeholder:"请输入团号"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:r(()=>[a(m,{label:"部门名称:"},{default:r(()=>[a(c,{modelValue:e(i).departName,"onUpdate:modelValue":t[1]||(t[1]=s=>e(i).departName=s),modelModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:r(()=>[a(m,{label:"部门代码:"},{default:r(()=>[a(c,{modelValue:e(i).departNo,"onUpdate:modelValue":t[2]||(t[2]=s=>e(i).departNo=s),modelModifiers:{trim:!0},placeholder:"请输入部门代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:r(()=>[a(m,{label:"线路名称:"},{default:r(()=>[a(c,{modelValue:e(i).routeName,"onUpdate:modelValue":t[3]||(t[3]=s=>e(i).routeName=s),modelModifiers:{trim:!0},placeholder:"请输入线路名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:r(()=>[a(m,{label:"目的地:"},{default:r(()=>[a(c,{modelValue:e(i).arrival,"onUpdate:modelValue":t[4]||(t[4]=s=>e(i).arrival=s),modelModifiers:{trim:!0},placeholder:"请输入目的地"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),table:r(()=>[a(P,{"selected-keys":e(u).selectedKeys,"onUpdate:selectedKeys":t[5]||(t[5]=n=>e(u).selectedKeys=n),class:"zs-table","row-key":"id",data:e(B),"row-selection":e(u).rowSelection,bordered:e(u).bordered,pagination:e(u).pagination,size:e(u).size,columns:e(z),stripe:e(u).stripe,loading:e(U)},{operate:r(({record:n})=>[a(L,null,{default:r(()=>[["2","5"].includes(n.transferState)?(f(),S(b,{key:0,type:"text",status:"success",onClick:s=>o.$router.push(`/reconciliation/supplierOrder/operate?groupId=${n.groupId}`)},{default:r(()=>[h("详情")]),_:2},1032,["onClick"])):y("",!0),["2","3","5"].includes(n.transferState)?y("",!0):w((f(),S(b,{key:1,type:"text",status:"warning",onClick:s=>e(C)(n,()=>M(n))},{default:r(()=>[h("调账")]),_:2},1032,["onClick"])),[[e(I),"ReconciliationSupplierOrderAdjustAccount"]]),n.transferState=="4"?w((f(),S(b,{key:2,type:"text",status:"danger",onClick:s=>e(C)(n,()=>$(n))},{default:r(()=>[h("确定驳回")]),_:2},1032,["onClick"])),[[e(I),"ReconciliationSupplierOrderReject"]]):y("",!0),n.transferState=="5"?w((f(),S(b,{key:3,type:"text",onClick:s=>o.$router.push(`/reconciliation/supplierOrder/operate?groupId=${n.groupId}&isSure=true`)},{default:r(()=>[h("审核")]),_:2},1032,["onClick"])),[[e(I),"ReconciliationSupplierOrderExamine"]]):y("",!0)]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{_e as default};

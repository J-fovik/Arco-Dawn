import{d as E,h as q,i as M,n as G,k as P,j as H,r as u,o as w,l as C,w as o,s as T,t as j,b as e,a as n,v as ee,m as R,x as te,c as ae,p as I,e as Y}from"./index-d007178a.js";import{f as i,t as N,a as ne,_ as oe,d as le}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{C as B}from"./customer-dc025a69.js";import"./index-13860ba0.js";const re=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"高考年份",dataIndex:"gkYear",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.gkYear)},{title:"顾客昵称",dataIndex:"nickName",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.nickName)},{title:"省份",dataIndex:"province",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.province)},{title:"分数",dataIndex:"score",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.score)},{title:"手机号",dataIndex:"phone",show:!0,align:"center",render:({record:t})=>i(t.phone)},{title:"选科",dataIndex:"xk",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.xk)},{title:"科类",dataIndex:"kl",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.kl)},{title:"代理商名称",dataIndex:"agentName",show:!0,align:"center",render:({record:t})=>i(t.agentName)},{title:"绑定时间",dataIndex:"agentExCodeBindingTime",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>i(t.agentExCodeBindingTime)},{title:"付款记录",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],se=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"交易时间",dataIndex:"createtime",show:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.createtime)},{title:"交易类型",dataIndex:"transtype",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.transtype)},{title:"交易金额(元)",dataIndex:"amount",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>N(ne(t.amount))},{title:"提成(元)",dataIndex:"agentCommission",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>N(t.agentCommission)},{title:"交易订单号",dataIndex:"transno",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:t})=>i(t.transno)},{title:"顾客手机号码",dataIndex:"phone",show:!0,align:"center",render:({record:t})=>i(t.phone)}],ie={style:{display:"flex","align-items":"center","justify-content":"end"}},de=T("span",null,"交易金额合计(元)：",-1),ue={class:"text-red text-price",style:{"font-size":"20px"}},ce=T("span",{style:{"margin-left":"20px"}},"提成合计(元)：",-1),me={class:"text-red text-price",style:{"font-size":"20px"}},pe=E({name:"zsViewRecord"}),ge=E({...pe,props:{data:{default:()=>({})}},emits:["close","success"],setup(t,{emit:x}){const k=t,[y,l]=q(null),{form:v,resetForm:D}=M(()=>({...k.data})),{selectRow:U,columnsData:A,visibleColumnsData:s,tableBaseOptions:m,resetData:$,extendTableList:J,createRowNo:S,setSelectRow:K,changeTableColumn:L,changeTableSize:O}=G(se(),()=>a()),V=P(""),z=P(""),{data:g,loading:_,initData:a}=H(async()=>{const{res:c,err:r}=await R(()=>B.getSpendingRecord({userId:v.value.id,agentExCodeBindingTime:v.value.agentExCodeBindingTime,currentPage:m.pagination.current,pageSize:m.pagination.pageSize,pagingOrNot:"1"}));return r?[]:(V.value=c.data.totalAmount,z.value=c.data.totalAgentCommission,m.pagination.total=c.data.totalCount,c.data.resultList.map((p,f)=>({sortTableNo:S(f),...p})))});return(c,r)=>{const p=u("a-table"),f=u("a-modal");return w(),C(f,{title:"付款记录一览","unmount-on-close":"",visible:"","ok-text":"关闭","align-center":!1,"mask-closable":!1,"hide-cancel":"",width:"80vw","ok-loading":e(y)==="okLoading",onCancel:r[1]||(r[1]=h=>x("close")),onOk:r[2]||(r[2]=h=>x("close"))},{default:o(()=>[T("div",ie,[de,T("span",ue,j(e(N)(V.value)),1),ce,T("span",me,j(e(N)(z.value)),1)]),n(p,{modelValue:e(g),"onUpdate:modelValue":r[0]||(r[0]=h=>ee(g)?g.value=h:null),class:"zs-table","row-key":"id",data:e(g),bordered:e(m).bordered,size:e(m).size,columns:e(s),stripe:e(m).stripe,loading:e(_)},null,8,["modelValue","data","bordered","size","columns","stripe","loading"])]),_:1},8,["ok-loading"])}}}),_e=E({name:"customerList"}),he=E({..._e,setup(t){const x=te(),[k,y]=q(null),{form:l,resetForm:v}=M(()=>({phone:"",createStartTime:"",createEndTime:"",nickName:"",dedicatedCode:"",agentName:""}),()=>m()),{selectRow:D,columnsData:U,visibleColumnsData:A,tableBaseOptions:s,resetData:m,extendTableList:$,createRowNo:J,setSelectRow:S,changeTableColumn:K,changeTableSize:L}=G(re(),()=>g()),O=async()=>{const{res:_,err:a}=await R(()=>B.customerInfoExport({...l.value,createStartTime:l.value.createStartTime,createEndTime:l.value.createEndTime}));if(a)return[];le(_,"顾客信息.xlsx")},{data:V,loading:z,initData:g}=H(async()=>{const{res:_,err:a}=await R(()=>B.getBoundUser({...l.value,createStartTime:l.value.createStartTime,createEndTime:l.value.createEndTime,currentPage:s.pagination.current,pageSize:s.pagination.pageSize,pagingOrNot:"1"}));return a?[]:(s.pagination.total=_.data.totalCount,$(_.data.resultList))});return(_,a)=>{const c=u("a-input"),r=u("a-form-item"),p=u("a-grid-item"),f=u("a-date-picker"),h=u("a-grid"),Q=u("a-form"),W=u("icon-share-external"),F=u("a-button"),X=u("a-space"),Z=u("a-table");return w(),ae("div",null,[n(oe,{fold:"","table-columns":e(U),"table-size":e(s).size,onResetSearch:e(v),onSearch:e(m),onChangeTableSize:e(L),onChangeTableColumn:e(K)},{form:o(({collapsed:b})=>[n(Q,{model:e(l),"label-align":"left",size:"large","auto-label-width":""},{default:o(()=>[n(h,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!b},{default:o(()=>[n(p,null,{default:o(()=>[n(r,{label:"顾客昵称:"},{default:o(()=>[n(c,{modelValue:e(l).nickName,"onUpdate:modelValue":a[0]||(a[0]=d=>e(l).nickName=d),placeholder:"请输入顾客昵称"},null,8,["modelValue"])]),_:1})]),_:1}),n(p,null,{default:o(()=>[n(r,{label:"手机号:"},{default:o(()=>[n(c,{modelValue:e(l).phone,"onUpdate:modelValue":a[1]||(a[1]=d=>e(l).phone=d),placeholder:"请输入顾客手机号"},null,8,["modelValue"])]),_:1})]),_:1}),n(p,null,{default:o(()=>[n(r,{label:"绑定日期:"},{default:o(()=>[n(f,{style:{width:"200px"},modelValue:e(l).createStartTime,"onUpdate:modelValue":a[2]||(a[2]=d=>e(l).createStartTime=d)},null,8,["modelValue"]),n(f,{style:{width:"200px"},modelValue:e(l).createEndTime,"onUpdate:modelValue":a[3]||(a[3]=d=>e(l).createEndTime=d)},null,8,["modelValue"])]),_:1})]),_:1}),e(x).userInfo.roleCode!="dls"?(w(),C(p,{key:0},{default:o(()=>[n(r,{label:"代理商名称:"},{default:o(()=>[n(c,{modelValue:e(l).agentName,"onUpdate:modelValue":a[4]||(a[4]=d=>e(l).agentName=d),placeholder:"请输入代理商名称"},null,8,["modelValue"])]),_:1})]),_:1})):I("",!0),e(x).userInfo.roleCode!="dls"?(w(),C(p,{key:1},{default:o(()=>[n(r,{label:"代理商专属码:"},{default:o(()=>[n(c,{modelValue:e(l).dedicatedCode,"onUpdate:modelValue":a[5]||(a[5]=d=>e(l).dedicatedCode=d),placeholder:"请输入代理商专属码"},null,8,["modelValue"])]),_:1})]),_:1})):I("",!0)]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:o(()=>[e(x).userInfo.roleCode!="dls"?(w(),C(X,{key:0},{default:o(()=>[n(F,{type:"outline",loading:e(k)==="导出",onClick:O},{icon:o(()=>[n(W)]),default:o(()=>[Y(" 导出 ")]),_:1},8,["loading"])]),_:1})):I("",!0)]),table:o(()=>[n(Z,{"selected-keys":e(s).selectedKeys,"onUpdate:selectedKeys":a[6]||(a[6]=b=>e(s).selectedKeys=b),class:"zs-table","row-key":"id",data:e(V),"row-selection":e(s).rowSelection,bordered:e(s).bordered,pagination:e(s).pagination,size:e(s).size,columns:e(A),stripe:e(s).stripe,loading:e(z)},{operate:o(({record:b})=>[n(F,{type:"text",onClick:d=>e(S)(b,()=>e(y)("zsViewRecord"))},{default:o(()=>[Y("查看")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(k)==="zsViewRecord"?(w(),C(ge,{key:0,data:e(D),onSuccess:e(g),onClose:a[7]||(a[7]=b=>e(S)({},()=>e(y)(null)))},null,8,["data","onSuccess"])):I("",!0)])}}});export{he as default};

import{d as F,u as de,C as re,E as ue,D as L,R as oe,s as ie,a1 as se,M as ne,r as n,o as T,l as j,w as l,g as e,c as r,O as D,h as U,i as s,e as O,F as w,j as pe,f as h,V as x,k as B,G as me,H as fe,X as ce,t as ve,ac as ge,_ as _e}from"./index-8a2cb146.js";import{Z as be}from"./index-2bbe694f.js";import{Z as ye}from"./zsRoutePrice-e3a5f38b.js";import{L as Ve}from"./line-7661aa01.js";import{S as Te}from"./supplier-c338fe4b.js";const k=M=>(me("data-v-cd1bd78b"),M=M(),fe(),M),xe=k(()=>h("div",{style:{padding:"0 10px"}},"-",-1)),he=k(()=>h("div",{style:{padding:"0 10px"}},"-",-1)),qe=k(()=>h("div",{style:{padding:"0 10px"}},"-",-1)),Ae={class:"box-flex"},De=k(()=>h("div",{style:{height:"100px"}},null,-1)),Me={class:"orderSubmit-footer box-flex jc-fe"},Se=F({name:"LineAdjustmentTourismOperate"}),Pe=F({...Se,setup(M){const E=de(),{jumpTabName:I}=re(),[Z,je]=ue(""),S=L(null),g=oe([]),_=L([]),{form:d,formRef:N}=ie(()=>({routeName:"",travelType:"",routeType:"",groupType:"1",isBefore:"1",beforeDays:void 0,idType:[],vehicle:[],travelDays:void 0,adultAgeMin:void 0,adultAgeMax:void 0,ageOfTheElderlyMin:void 0,ageOfTheElderlyMax:105,childrenSAgeMin:void 0,childrenSAgeMax:void 0,arrival:"",supplierId:"",isReturnPoint:"1",isSubstrPoint:"1",addRebate:void 0,rebate:void 0,areaList:[],deposit:void 0,allTimeArr:[],routePrice:{crmsjg:void 0,crtxjg:void 0,crdffcmsj:void 0,crdrfctxj:void 0,crqtjg:void 0,lrmsjg:void 0,lrtxjg:void 0,lrdffcmsj2:void 0,lrdrfctxj:void 0,lrqtjg:void 0,etmsjg:void 0,ettxjg:void 0,etdffcmsj:void 0,etqtjg:void 0,zccrdrfctxj:void 0,zcrtdffcmsj:void 0,zcettxjg:void 0,zcetmsjg:void 0,zcetdrfctxj:void 0,zcetqtjg:void 0,qtjg:void 0,qtjg2:void 0,qtjg3:void 0,qtjg4:void 0,remark:""}})),K=L({routeTripList:[],businessDepartList:[],attachList:[],other:{}}),C=se(()=>q.value.routeTypeList.filter(u=>u.lineVer===d.value.travelType)),G={routeName:{required:!0,message:"请输入登录名"},travelType:{required:!0,message:"请选择旅行类型"},routeType:{required:!0,message:"请选择线路类型"},deposit:{required:!0,message:"请输入押金"},beforeDays:{required:!0,message:"请输入提前报名天数"},idType:{required:!0,message:"请选择支持证件"},vehicle:{required:!0,message:"请选择交通工具"},travelDays:{required:!0,message:"请输入天数"},adultAge:{required:!0,validator:(u,a)=>{!d.value.adultAgeMin&&!d.value.adultAgeMax&&a("请输入正确的年龄")}},ageOfTheElderly:{required:!0,validator:(u,a)=>{!d.value.ageOfTheElderlyMin&&!d.value.ageOfTheElderlyMax&&a("请输入正确的年龄")}},childrenSAge:{required:!0,validator:(u,a)=>{!d.value.childrenSAgeMin&&!d.value.childrenSAgeMax&&a("请输入正确的年龄")}},supplierId:{required:!0,message:"请选择供应商"},allTimeArr:{required:!0,message:"请选择发团日期"}},{data:q}=ne(async()=>{const{err:u,res:a}=await B(()=>Ve.getTouristRoutesDetail({id:E.query.id??"",mark:E.query.mark??"0"}));return u?{}:(H(a==null?void 0:a.data),a==null?void 0:a.data)},{departType:"",ass:"",regionList:[],travelTypeList:[],supplierList:[],routeTypeList:[]}),H=({travelRoute:u,priceList:a,routeTripList:c,validDateList:i,regionList:o,attachList:A,specialPriceList:m,visibleDepart:v})=>{const b=u.adultAge.split("-"),f=u.elderlyAge.split("-"),V=u.childAge.split("-");d.value={routeName:u.routeName,travelType:u.travelType,routeType:u.routeType,groupType:u.groupType,isBefore:u.isBefore,beforeDays:u.beforeDays,travelDays:u.travelDays,arrival:u.arrival,supplierId:u.arrival,isReturnPoint:u.isReturnPoint,isSubstrPoint:u.isSubstrPoint,addRebate:u.addRebate,rebate:u.rebate,deposit:u.deposit,adultAgeMin:b[0]*1,adultAgeMax:b[1]*1,ageOfTheElderlyMin:f[0]*1,ageOfTheElderlyMax:f[1]*1,childrenSAgeMin:V[0]*1,childrenSAgeMax:V[1]*1,idType:u.idtype.split(","),vehicle:u.vehicle.split(","),allTimeArr:i.map(p=>ce(p)),areaList:o.map(p=>p.provinceCode),routePrice:a[0]},K.value={other:{routeFeature:u.routeFeature,costIncludes:u.costIncludes,costExcludes:u.costExcludes,selfExpense:u.selfExpense,reminder:u.reminder,visaNotice:u.visaNotice,needingMsg:u.needingMsg,reception:u.reception,totalInfo1:u.totalInfo1,remark:u.remark},routeTripList:c.map(p=>({...p,imgList:p.pictureList.map(y=>({name:y.attName,url:y.attPath,status:"done",uid:y.id,attSize:y.attSize}))})),attachList:A.map(p=>({name:p.attName,url:p.attPath,status:"done",uid:p.id,attSize:p.attSize})),businessDepartList:v.split(",")},_.value=m},X=u=>{if(g.value=u,u.length){const a=_.value.find(c=>c.validDate===u.at(-1));S.value.setFormData({...a})}},J=()=>{if(!g.value.length)return x.warning("请先选择要还原日期");_.value=_.value.map(u=>g.value.includes(u.validDate)?{...d.value.routePrice,validDate:u.validDate}:u),g.value=[],x.success("还原成功!")},Q=()=>{if(!g.value.length)return x.warning("请先选择要修改的日期");_.value=_.value.map(u=>g.value.includes(u.validDate)?{...S.value.getFormData(),validDate:u.validDate}:u),g.value=[],x.success("修改成功!")},W=u=>{d.value.travelType=u,d.value.routeType="",d.value.arrival=""},Y=u=>{var a;d.value.routeType=u,d.value.arrival=((a=C.value.find(c=>c.lineId===u))==null?void 0:a.lineDesc)??""},$=async()=>{await N.value.validate()||await S.value.validateData()||R()},R=async()=>{const u=x.loading({content:"正在上传数据",duration:6e4}),a={id:E.query.id,priceList:_.value},{err:c}=await B(()=>Te.editApplicationPrice(a));u.close(),!c&&(x.success("操作成功"),I())};return(u,a)=>{const c=n("a-input"),i=n("a-form-item"),o=n("a-grid-item"),A=n("a-select"),m=n("a-input-number"),v=n("a-radio"),b=n("a-radio-group"),f=n("a-checkbox"),V=n("a-checkbox-group"),p=n("a-input-group"),y=n("a-grid"),z=n("a-card"),ee=n("a-tag"),P=n("a-button"),le=n("a-button-group"),ae=n("a-form"),te=n("a-space");return T(),j(be,null,{default:l(()=>[e(ae,{ref_key:"formRef",ref:N,"label-align":"left",size:"large",layout:"vertical","auto-label-width":"","scroll-to-first-error":"",model:r(d),rules:G},{default:l(()=>[e(z,{title:"路由线路时间添加",bordered:!1,class:"general-card"},{default:l(()=>[e(y,{cols:3,"col-gap":12},{default:l(()=>[e(o,null,{default:l(()=>[e(i,{label:"线路名称:",field:"routeName",required:""},{default:l(()=>[e(c,{modelValue:r(d).routeName,"onUpdate:modelValue":a[0]||(a[0]=t=>r(d).routeName=t),modelModifiers:{trim:!0},disabled:!0,placeholder:"请输入线路名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"旅行类型:",field:"travelType",required:""},{default:l(()=>[e(A,{"model-value":r(d).travelType,options:r(q).travelTypeList,disabled:!0,"field-names":{label:"detailName",value:"lineVer"},placeholder:"请输入旅行类型",onChange:W},null,8,["model-value","options"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"线路类型:",field:"routeType",required:""},{default:l(()=>[e(A,{"model-value":r(d).routeType,options:C.value,disabled:!0,"field-names":{label:"linename",value:"lineId"},placeholder:"请选择线路类型",onChange:Y},null,8,["model-value","options"])]),_:1})]),_:1}),r(d).travelType==="C00001"?(T(),j(o,{key:0},{default:l(()=>[e(i,{label:"押金:",field:"deposit",required:""},{default:l(()=>[e(m,{modelValue:r(d).deposit,"onUpdate:modelValue":a[1]||(a[1]=t=>r(d).deposit=t),modelModifiers:{trim:!0},disabled:!0,formatter:t=>r(D)(t,""),parser:t=>t.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入押金"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1})):U("",!0),e(o,null,{default:l(()=>[e(i,{label:"成团类别:",field:"groupType",required:""},{default:l(()=>[e(b,{modelValue:r(d).groupType,"onUpdate:modelValue":a[2]||(a[2]=t=>r(d).groupType=t),disabled:!0},{default:l(()=>[e(v,{value:"1"},{default:l(()=>[s("单团")]),_:1}),e(v,{value:"2"},{default:l(()=>[s("散客")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),r(q).departType!=="2"?(T(),j(o,{key:1},{default:l(()=>[e(i,{label:"是否提前报名:",field:"isBefore",required:""},{default:l(()=>[e(b,{modelValue:r(d).isBefore,"onUpdate:modelValue":a[3]||(a[3]=t=>r(d).isBefore=t),disabled:!0},{default:l(()=>[e(v,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(v,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):U("",!0),e(o,null,{default:l(()=>[e(i,{label:"提前报名天数:",field:"beforeDays",required:""},{default:l(()=>[e(m,{modelValue:r(d).beforeDays,"onUpdate:modelValue":a[4]||(a[4]=t=>r(d).beforeDays=t),modelModifiers:{trim:!0},disabled:!0,formatter:t=>r(D)(t,""),parser:t=>t.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入提前报名天数"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"支持证件:",field:"idType",required:""},{default:l(()=>[e(V,{modelValue:r(d).idType,"onUpdate:modelValue":a[5]||(a[5]=t=>r(d).idType=t),disabled:!0},{default:l(()=>[e(f,{value:"1"},{default:l(()=>[s("身份证")]),_:1}),e(f,{value:"2"},{default:l(()=>[s("户口本")]),_:1}),e(f,{value:"3"},{default:l(()=>[s("护照")]),_:1}),e(f,{value:"4"},{default:l(()=>[s("驾驶证")]),_:1}),e(f,{value:"5"},{default:l(()=>[s("暂住证")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"交通工具:",field:"vehicle",required:""},{default:l(()=>[e(V,{modelValue:r(d).vehicle,"onUpdate:modelValue":a[6]||(a[6]=t=>r(d).vehicle=t),disabled:!0},{default:l(()=>[e(f,{value:"1"},{default:l(()=>[s("飞机")]),_:1}),e(f,{value:"2"},{default:l(()=>[s("火车")]),_:1}),e(f,{value:"3"},{default:l(()=>[s("大巴")]),_:1}),e(f,{value:"4"},{default:l(()=>[s("轮船")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"天数:",field:"travelDays",required:""},{default:l(()=>[e(m,{modelValue:r(d).travelDays,"onUpdate:modelValue":a[7]||(a[7]=t=>r(d).travelDays=t),disabled:!0,formatter:t=>r(D)(t,""),parser:t=>t.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入天数"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"成人价年龄:",field:"adultAge",required:""},{default:l(()=>[e(p,{class:"flex1"},{default:l(()=>[e(m,{modelValue:r(d).adultAgeMin,"onUpdate:modelValue":a[8]||(a[8]=t=>r(d).adultAgeMin=t),disabled:!0,min:0,placeholder:"最小年龄"},null,8,["modelValue"]),xe,e(m,{modelValue:r(d).adultAgeMax,"onUpdate:modelValue":a[9]||(a[9]=t=>r(d).adultAgeMax=t),disabled:!0,min:0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"老人价年龄:",field:"ageOfTheElderly",required:""},{default:l(()=>[e(p,{class:"flex1"},{default:l(()=>[e(m,{modelValue:r(d).ageOfTheElderlyMin,"onUpdate:modelValue":a[10]||(a[10]=t=>r(d).ageOfTheElderlyMin=t),max:105,disabled:!0,min:0,placeholder:"最小年龄"},null,8,["modelValue"]),he,e(m,{modelValue:r(d).ageOfTheElderlyMax,"onUpdate:modelValue":a[11]||(a[11]=t=>r(d).ageOfTheElderlyMax=t),max:105,disabled:!0,min:0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"儿童价年龄:",field:"childrenSAge"},{default:l(()=>[e(p,{class:"flex1"},{default:l(()=>[e(m,{modelValue:r(d).childrenSAgeMin,"onUpdate:modelValue":a[12]||(a[12]=t=>r(d).childrenSAgeMin=t),min:0,disabled:!0,placeholder:"最小年龄"},null,8,["modelValue"]),qe,e(m,{modelValue:r(d).childrenSAgeMax,"onUpdate:modelValue":a[13]||(a[13]=t=>r(d).childrenSAgeMax=t),min:0,disabled:!0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"目的地:",field:"arrival"},{default:l(()=>[e(c,{modelValue:r(d).arrival,"onUpdate:modelValue":a[14]||(a[14]=t=>r(d).arrival=t),modelModifiers:{trim:!0},readonly:"",disabled:!0,placeholder:"请输入目的地"},null,8,["modelValue"])]),_:1})]),_:1}),r(q).ass==="1"?(T(),O(w,{key:2},[e(o,null,{default:l(()=>[e(i,{label:"外交供应商:",field:"supplierId"},{default:l(()=>[e(A,{modelValue:r(d).supplierId,"onUpdate:modelValue":a[15]||(a[15]=t=>r(d).supplierId=t),options:r(q).supplierList,disabled:!0,"field-names":{label:"supName",value:"id"},placeholder:"请选择辅助外交供应商"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"是否供应商返点:",field:"isReturnPoint",required:""},{default:l(()=>[e(b,{modelValue:r(d).isReturnPoint,"onUpdate:modelValue":a[16]||(a[16]=t=>r(d).isReturnPoint=t),disabled:!0},{default:l(()=>[e(v,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(v,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"是否营业部扣点:",field:"isSubstrPoint",required:""},{default:l(()=>[e(b,{modelValue:r(d).isSubstrPoint,"onUpdate:modelValue":a[17]||(a[17]=t=>r(d).isSubstrPoint=t),disabled:!0},{default:l(()=>[e(v,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(v,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"供应商返点(%):",field:"addRebate",required:""},{default:l(()=>[e(m,{modelValue:r(d).addRebate,"onUpdate:modelValue":a[18]||(a[18]=t=>r(d).addRebate=t),modelModifiers:{trim:!0},formatter:t=>r(D)(t,""),parser:t=>t.replace(/,/g,""),precision:2,disabled:!0,"hide-button":"",placeholder:"空默认为不扣供应商点"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(i,{label:"营业部扣点(%):",required:""},{default:l(()=>[e(m,{modelValue:r(d).rebate,"onUpdate:modelValue":a[19]||(a[19]=t=>r(d).rebate=t),modelModifiers:{trim:!0},formatter:t=>r(D)(t,""),parser:t=>t.replace(/,/g,""),precision:2,disabled:!0,"hide-button":"",placeholder:"空默认为不扣营业部点"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1})],64)):U("",!0)]),_:1})]),_:1}),e(z,{title:"发团日期选择",bordered:!1,class:"general-card margin-top"},{default:l(()=>[e(y,{cols:3,"col-gap":20},{default:l(()=>[e(o,{span:1},{default:l(()=>[e(i,{field:"allTimeArr","hide-label":"","hide-asterisk":""},{default:l(()=>[e(V,{modelValue:g.value,"onUpdate:modelValue":a[20]||(a[20]=t=>g.value=t),onChange:X},{default:l(()=>[(T(!0),O(w,null,pe(r(d).allTimeArr,t=>(T(),j(f,{key:t,value:t,style:{"margin-bottom":"10px"}},{default:l(()=>[e(ee,{size:"large"},{default:l(()=>[s(ve(r(ge)(t)),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(o,{span:2},{default:l(()=>[e(ye,{ref_key:"routePriceRef",ref:S,"default-data":r(d).routePrice},null,8,["default-data"]),h("div",Ae,[e(le,null,{default:l(()=>[e(P,{size:"large",type:"primary",onClick:Q},{default:l(()=>[s("保存")]),_:1}),e(P,{size:"large",onClick:J},{default:l(()=>[s("还原")]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),De,h("div",Me,[e(te,null,{default:l(()=>[e(P,{type:"primary",loading:r(Z)==="保存",onClick:$},{default:l(()=>[s("保存")]),_:1},8,["loading"]),e(P,{onClick:a[21]||(a[21]=()=>r(I)())},{default:l(()=>[s("返回")]),_:1})]),_:1})])]),_:1})}}});const Ne=_e(Pe,[["__scopeId","data-v-cd1bd78b"]]);export{Ne as default};

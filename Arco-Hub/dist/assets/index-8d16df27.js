import{d as w,g as B,h as M,i as U,D as J,r as o,o as K,l as E,w as a,a as t,b as e,m as D,n as G,j as H,c as Q,e as I,p as W,q as X}from"./index-d007178a.js";import{f as T,t as Y,c as Z,_ as ee}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{M as R}from"./major-b28f8c7d.js";import"./index-13860ba0.js";const te=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"专业名称",dataIndex:"zymc",show:!0,align:"center",render:({record:m})=>T(m.zymc)},{title:"行业",dataIndex:"hy",show:!0,align:"center",render:({record:m})=>T(m.hy)},{title:"比例",dataIndex:"percent",show:!0,align:"center",render:({record:m})=>T(m.percent)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],ae=w({name:"zsAddEmploymentIndustry"}),le=w({...ae,props:{data:{default:()=>({})}},emits:["close","success"],setup(m,{emit:y}){const p=m;B();const[b,u]=M(null),{form:s,formRef:z}=U(()=>({...p.data})),v={zyId:{required:!0,message:"请输入专业ID"},percent:{required:!0,message:"请输入比例"},hySort:{required:!0,message:"请输入排序"},zymc:{required:!0,message:"请输入专业名称"},hy:{required:!0,message:"请输入所在行业"}},V=()=>{z.value.validate(i=>{i||(p.data.id?n("editIndustry"):n("addIndustry"))})},n=async i=>{const{err:r}=await D(()=>R[i](s.value),{before:()=>u("okLoading"),after:()=>u(null)});r||(y("success"),y("close"))};return J(()=>s.value.nBl,i=>{s.value.vBl=100-i}),(i,r)=>{const _=o("a-input"),f=o("a-form-item"),g=o("a-grid-item"),C=o("a-input-number"),S=o("a-grid"),k=o("a-form"),h=o("a-modal");return K(),E(h,{title:e(Z)("就业行业占比",!!p.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"80vw","align-center":!1,"mask-closable":!1,"ok-loading":e(b)==="okLoading",onCancel:r[4]||(r[4]=l=>y("close")),onOk:V},{default:a(()=>[t(k,{ref_key:"formRef",ref:z,model:e(s),"label-align":"left",size:"large","auto-label-width":"",rules:v},{default:a(()=>[t(S,{cols:2,"col-gap":24},{default:a(()=>[t(g,null,{default:a(()=>[t(f,{field:"zymc",label:"专业名称:"},{default:a(()=>[t(_,{modelValue:e(s).zymc,"onUpdate:modelValue":r[0]||(r[0]=l=>e(s).zymc=l),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"hy",label:"行业:"},{default:a(()=>[t(_,{modelValue:e(s).hy,"onUpdate:modelValue":r[1]||(r[1]=l=>e(s).hy=l),placeholder:"请输入行业"},null,8,["modelValue"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"percent",label:"比例:"},{default:a(()=>[t(C,{modelValue:e(s).percent,"onUpdate:modelValue":r[2]||(r[2]=l=>e(s).percent=l),formatter:l=>e(Y)(l,""),parser:l=>l.replace(/,/g,""),precision:2,min:0,max:100,"hide-button":"",placeholder:"请输入比例"},null,8,["modelValue","formatter","parser","max"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"hySort",label:"排序:"},{default:a(()=>[t(_,{modelValue:e(s).hySort,"onUpdate:modelValue":r[3]||(r[3]=l=>e(s).hySort=l),placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),ne=w({name:"MajorEmploymentIndustry"}),ie=w({...ne,setup(m){const{warningModal:y}=X(),[p,b]=M(null);B();const{form:u,resetForm:s}=U(()=>({hy:"",zymc:""}),()=>i()),{selectRow:z,columnsData:v,visibleColumnsData:V,tableBaseOptions:n,resetData:i,extendTableList:r,setSelectRow:_,changeTableColumn:f,changeTableSize:g}=G(te(),()=>h()),C=()=>{y(`确定删除选中的${n.selectedKeys.length}数据吗？`,async l=>{const{err:d}=await D(()=>R.deleteIndustry({ids:n.selectedKeys}),{successMsg:"操作成功"});d||(l(!0),n.selectedKeys=[],h())})},{data:S,loading:k,initData:h}=H(async()=>{const{res:l,err:d}=await D(()=>R.getIndustryList({...u.value,currentPage:n.pagination.current,pageSize:n.pagination.pageSize,pagingOrNot:"1"}));return d?[]:(n.pagination.total=l.data.totalCount,r(l==null?void 0:l.data.resultList))});return(l,d)=>{const A=o("a-input"),$=o("a-form-item"),q=o("a-grid-item"),N=o("a-grid"),L=o("a-form"),O=o("icon-plus"),x=o("a-button"),P=o("icon-close"),j=o("a-space"),F=o("a-table");return K(),Q("div",null,[t(ee,{"table-columns":e(v),"table-size":e(n).size,onResetSearch:e(s),onSearch:e(i),onChangeTableSize:e(g),onChangeTableColumn:e(f)},{form:a(()=>[t(L,{model:e(u),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[t(N,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[t(q,null,{default:a(()=>[t($,{label:"专业名称:"},{default:a(()=>[t(A,{modelValue:e(u).zymc,"onUpdate:modelValue":d[0]||(d[0]=c=>e(u).zymc=c),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(q,null,{default:a(()=>[t($,{label:"行业:"},{default:a(()=>[t(A,{modelValue:e(u).hy,"onUpdate:modelValue":d[1]||(d[1]=c=>e(u).hy=c),placeholder:"请输入行业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[t(j,null,{default:a(()=>[t(x,{type:"outline",onClick:d[2]||(d[2]=c=>e(b)("zsAddEmploymentIndustry"))},{icon:a(()=>[t(O)]),default:a(()=>[I(" 新增 ")]),_:1}),t(x,{type:"outline",status:"danger",disabled:!e(n).selectedKeys.length,loading:e(p)==="删除",onClick:C},{icon:a(()=>[t(P)]),default:a(()=>[I(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:a(()=>[t(F,{"selected-keys":e(n).selectedKeys,"onUpdate:selectedKeys":d[3]||(d[3]=c=>e(n).selectedKeys=c),class:"zs-table","row-key":"id",data:e(S),"row-selection":e(n).rowSelection,bordered:e(n).bordered,pagination:e(n).pagination,size:e(n).size,columns:e(V),stripe:e(n).stripe,loading:e(k)},{operate:a(({record:c})=>[t(x,{type:"text",onClick:oe=>e(_)(c,()=>e(b)("zsAddEmploymentIndustry"))},{default:a(()=>[I("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(p)==="zsAddEmploymentIndustry"?(K(),E(le,{key:0,data:e(z),onSuccess:e(h),onClose:d[4]||(d[4]=c=>e(_)({},()=>e(b)(null)))},null,8,["data","onSuccess"])):W("",!0)])}}});export{ie as default};

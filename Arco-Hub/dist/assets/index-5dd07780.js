import{d as B,g as M,h as P,i as q,D as Z,r as a,o as N,l as F,w as t,a as l,b as e,m as C,n as ee,j as le,c as te,e as z,p as ae,q as oe}from"./index-d007178a.js";import{f as V,c as ne,_ as se}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{f as de,A as S}from"./options-aafac76d.js";import{R as L}from"./recruit-3c2f52ae.js";import"./index-13860ba0.js";const O=[{label:"文科",value:"文科"},{label:"理科",value:"理科"},{label:"综合",value:"综合"},{label:"物理",value:"物理"},{label:"历史",value:"历史"}],re=()=>[{title:"序号",width:100,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"省份",dataIndex:"sf",show:!0,align:"center",render:({record:r})=>V(r.sf)},{title:"年份",dataIndex:"nf",show:!0,align:"center",render:({record:r})=>V(r.nf)},{title:"批次",dataIndex:"pc",show:!0,align:"center",render:({record:r})=>V(r.pc)},{title:"科类",dataIndex:"kl",show:!0,align:"center",render:({record:r})=>{var f;return V((f=de(O,r.kl))==null?void 0:f.label)}},{title:"分数线",dataIndex:"score",show:!0,align:"center",render:({record:r})=>V(r.score)},{title:"专业分",dataIndex:"zyf",show:!0,align:"center",render:({record:r})=>V(r.zyf)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],ie=B({name:"zsAddBatchLine"}),ue=B({...ie,props:{data:{default:()=>({})}},emits:["close","success"],setup(r,{emit:f}){const b=r,w=M(),[T,u]=P(null),{form:o,formRef:k}=q(()=>({...b.data})),I={nf:{required:!0,message:"请输入年份"},score:{required:!0,message:"请输入分数"}},R=()=>{k.value.validate(m=>{m||(b.data.id?n("editBatchLine"):n("addBatchLine"))})},n=async m=>{const{err:s}=await C(()=>L[m](o.value),{before:()=>u("okLoading"),after:()=>u(null)});s||(f("success"),f("close"))};return Z(()=>o.value.nBl,m=>{o.value.vBl=100-m}),(m,s)=>{const v=a("a-select"),_=a("a-form-item"),g=a("a-grid-item"),h=a("a-input"),U=a("a-grid"),A=a("a-form"),y=a("a-modal");return N(),F(y,{title:e(ne)("批次线",!!b.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"80vw","align-center":!1,"mask-closable":!1,"ok-loading":e(T)==="okLoading",onCancel:s[6]||(s[6]=i=>f("close")),onOk:R},{default:t(()=>[l(A,{ref_key:"formRef",ref:k,model:e(o),"label-align":"left",size:"large","auto-label-width":"",rules:I},{default:t(()=>[l(U,{cols:2,"col-gap":24},{default:t(()=>[l(g,null,{default:t(()=>[l(_,{field:"sf",label:"省份:"},{default:t(()=>[l(v,{modelValue:e(o).sf,"onUpdate:modelValue":s[0]||(s[0]=i=>e(o).sf=i),placeholder:"请输入省份","allow-search":"",options:[...e(S),...e(w).provinceList]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(g,null,{default:t(()=>[l(_,{field:"nf",label:"年份:"},{default:t(()=>[l(h,{modelValue:e(o).nf,"onUpdate:modelValue":s[1]||(s[1]=i=>e(o).nf=i),placeholder:"请输入年份"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,null,{default:t(()=>[l(_,{field:"pc",label:"批次:"},{default:t(()=>[l(h,{modelValue:e(o).pc,"onUpdate:modelValue":s[2]||(s[2]=i=>e(o).pc=i),placeholder:"请输入批次"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,null,{default:t(()=>[l(_,{label:"科类:"},{default:t(()=>[l(v,{modelValue:e(o).kl,"onUpdate:modelValue":s[3]||(s[3]=i=>e(o).kl=i),placeholder:"请选择科类","allow-clear":"",options:[...e(S),...e(O)]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(g,null,{default:t(()=>[l(_,{field:"score",label:"分数线:"},{default:t(()=>[l(h,{modelValue:e(o).score,"onUpdate:modelValue":s[4]||(s[4]=i=>e(o).score=i),placeholder:"请输入分数线"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,null,{default:t(()=>[l(_,{field:"zyf",label:"专业分:"},{default:t(()=>[l(h,{modelValue:e(o).zyf,"onUpdate:modelValue":s[5]||(s[5]=i=>e(o).zyf=i),placeholder:"请输入专业分"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),ce=B({name:"RecruitBatchLine"}),we=B({...ce,setup(r){const{warningModal:f}=oe(),[b,w]=P(null),T=M(),{form:u,resetForm:o}=q(()=>({sf:"",nf:"",kl:""}),()=>m()),{selectRow:k,columnsData:I,visibleColumnsData:R,tableBaseOptions:n,resetData:m,extendTableList:s,setSelectRow:v,changeTableColumn:_,changeTableSize:g}=ee(re(),()=>y()),h=()=>{f(`确定删除选中的${n.selectedKeys.length}数据吗？`,async p=>{const{err:d}=await C(()=>L.deleteBatchLine({ids:n.selectedKeys}),{successMsg:"操作成功"});d||(p(!0),n.selectedKeys=[],y())})},{data:U,loading:A,initData:y}=le(async()=>{const{res:p,err:d}=await C(()=>L.getBatchLineList({...u.value,currentPage:n.pagination.current,pageSize:n.pagination.pageSize,pagingOrNot:"1"}));return d?[]:(n.pagination.total=p.data.totalCount,s(p==null?void 0:p.data.resultList))}),i=async p=>{const{err:d}=await C(()=>L.daoruBatchLine({path:p.at(-1).file}),{after:()=>w(null),before:()=>w("批量上传")});d||y()};return(p,d)=>{const $=a("a-select"),K=a("a-form-item"),D=a("a-grid-item"),E=a("a-input"),j=a("a-grid"),W=a("a-form"),Y=a("icon-plus"),x=a("a-button"),G=a("icon-close"),H=a("icon-upload"),J=a("a-upload"),Q=a("a-space"),X=a("a-table");return N(),te("div",null,[l(se,{"table-columns":e(I),"table-size":e(n).size,onResetSearch:e(o),onSearch:e(m),onChangeTableSize:e(g),onChangeTableColumn:e(_)},{form:t(()=>[l(W,{model:e(u),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[l(j,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:t(()=>[l(D,null,{default:t(()=>[l(K,{field:"sf",label:"省份:"},{default:t(()=>[l($,{modelValue:e(u).sf,"onUpdate:modelValue":d[0]||(d[0]=c=>e(u).sf=c),placeholder:"请输入省份","allow-search":"",options:[...e(S),...e(T).provinceList]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(D,null,{default:t(()=>[l(K,{label:"年份:"},{default:t(()=>[l(E,{modelValue:e(u).nf,"onUpdate:modelValue":d[1]||(d[1]=c=>e(u).nf=c),placeholder:"请输入年份"},null,8,["modelValue"])]),_:1})]),_:1}),l(D,null,{default:t(()=>[l(K,{label:"科类:"},{default:t(()=>[l($,{modelValue:e(u).kl,"onUpdate:modelValue":d[2]||(d[2]=c=>e(u).kl=c),placeholder:"请选择科类","allow-clear":"",options:[...e(S),...e(O)]},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:t(()=>[l(Q,null,{default:t(()=>[l(x,{type:"outline",onClick:d[3]||(d[3]=c=>e(w)("zsAddBatchLine"))},{icon:t(()=>[l(Y)]),default:t(()=>[z(" 新增 ")]),_:1}),l(x,{type:"outline",status:"danger",disabled:!e(n).selectedKeys.length,loading:e(b)==="删除",onClick:h},{icon:t(()=>[l(G)]),default:t(()=>[z(" 删除 ")]),_:1},8,["disabled","loading"]),l(J,{"list-type":"text","auto-upload":!1,"show-cancel-button":!1,"show-link":!1,"show-file-list":!1,accept:".xlsx,.xls",onChange:i},{"upload-button":t(()=>[l(x,{type:"outline",loading:e(b)==="批量上传",status:"warning"},{icon:t(()=>[l(H)]),default:t(()=>[z(" 批量上传 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),table:t(()=>[l(X,{"selected-keys":e(n).selectedKeys,"onUpdate:selectedKeys":d[4]||(d[4]=c=>e(n).selectedKeys=c),class:"zs-table","row-key":"id",data:e(U),"row-selection":e(n).rowSelection,bordered:e(n).bordered,pagination:e(n).pagination,size:e(n).size,columns:e(R),stripe:e(n).stripe,loading:e(A)},{operate:t(({record:c})=>[l(x,{type:"text",onClick:me=>e(v)(c,()=>e(w)("zsAddBatchLine"))},{default:t(()=>[z("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(b)==="zsAddBatchLine"?(N(),F(ue,{key:0,data:e(k),onSuccess:e(y),onClose:d[5]||(d[5]=c=>e(v)({},()=>e(w)(null)))},null,8,["data","onSuccess"])):ae("",!0)])}}});export{we as default};

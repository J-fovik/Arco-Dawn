import{n as p,p as m,O as g,a as te,P as h,d as I,u as F,m as G,v as M,b as O,r as u,o as w,l as E,w as o,g as r,i as R,c as e,k as A,q as ae,E as re,s as oe,y as ne,e as le,f as Z,t as se,z as ie,h as ue,S as de}from"./index-8a2cb146.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{O as q}from"./order-70291d37.js";import"./index-2bbe694f.js";const ce=()=>[{title:"团号",slotName:"groupId",show:!0,ellipsis:!0,tooltip:!0,align:"center"},{title:"供应商",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>p(n.supName)},{title:"订单同行总费用",dataIndex:"supsigCost",show:!0,align:"right",render:({record:n})=>m("span",{class:"text-red text-price"},g(`${n.supsigCost??0}`))},{title:"供应商结算费用",dataIndex:"moneyTotal",show:!0,align:"right",render:({record:n})=>m("span",{class:"text-red text-price"},g(`${n.moneyTotal??0}`))},{title:"已结算金额",dataIndex:"totalSettledAmount",show:!0,align:"right",render:({record:n})=>m("span",{class:"text-red text-price"},g(`${n.totalSettledAmount??0}`))},{title:"本次申请结算金额",dataIndex:"money",show:!0,align:"right",render:({record:n})=>m("span",{class:"text-red text-price"},g(`${n.money??0}`))},{title:"申请时间",dataIndex:"createTime",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>p(n.createTime)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],me=()=>{const{getDictionaryItem:n}=te();return[{title:"团号",dataIndex:"groupId",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.groupId)},{title:"供应商",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.supName)},{title:"营业部名称",dataIndex:"departName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.departName)},{title:"线路名称",dataIndex:"routeName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.routeName)},{title:"人数",dataIndex:"totalNumber",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.totalNumber)},{title:"订单同行费用",dataIndex:"signCost",show:!0,width:120,align:"right",render:({record:t})=>m("span",{class:"text-red text-price"},g(h(t.signCost)))},{title:"扣点（%）",dataIndex:"ratio",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>m("span",{class:"text-green"},g(h(t.ratio)))},{title:"保险费用",dataIndex:"insuranceCost",show:!0,ellipsis:!0,tooltip:!0,align:"right",render:({record:t})=>m("span",{class:"text-red text-price"},g(h(t.insuranceCost)))},{title:"供应商结算金额",dataIndex:"setValue",show:!0,ellipsis:!0,tooltip:!0,align:"right",render:({record:t})=>m("span",{class:"text-red text-price"},g(h(t.setValue)))},{title:"结算状态",dataIndex:"settleType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(n("signupSettleType",t.settleType).detailName)},{title:"订单状态",dataIndex:"state",show:!0,align:"center",render:({record:t})=>p(n("new_trade_order",t.state).detailName)},{title:"创建时间",dataIndex:"createTimeStr",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.createTimeStr)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ge=I({name:"ZsGroupOrder"}),_e=I({...ge,props:{data:{default:()=>({})}},emits:["close"],setup(n,{emit:t}){const S=n,C=t,y=F(),x=G(),{visibleColumnsData:d,tableBaseOptions:c}=M(me(),()=>T()),{data:N,initData:T,loading:v}=O(async()=>{const{res:a,err:_}=await A(()=>q.getPlatFormList({groupIdList:S.data.groupNo.split(","),currentPage:c.pagination.current,pageSize:c.pagination.pageSize,pagingOrNot:"1"}));return _?[]:(c.pagination.total=a.data.totalCount,a==null?void 0:a.data.dataList)}),$=a=>{x.push(`/order/platformManage/operate/?&groupId=${a.groupId}&name=${y.name}`)};return(a,_)=>{const f=u("a-button"),L=u("a-table"),k=u("a-modal");return w(),E(k,{width:"1200px","unmount-on-close":"",visible:"",title:"订单列表","mask-closable":!1,onCancel:_[0]||(_[0]=b=>C("close")),footer:!1,"render-to-body":!1},{default:o(()=>[r(L,{class:"zs-table","row-key":"id",data:e(N),bordered:e(c).bordered,size:e(c).size,columns:e(d),stripe:e(c).stripe,loading:e(v)},{operate:o(({record:b})=>[r(f,{type:"text",onClick:P=>$(b)},{default:o(()=>[R("查看")]),_:2},1032,["onClick"])]),_:1},8,["data","bordered","size","columns","stripe","loading"])]),_:1})}}}),xe=Z("span",{class:"mx-3"},"-",-1),fe=["onClick"],be=I({name:"OrderPlatformSettlementExamine"}),Ce=I({...be,setup(n){const{vAuthority:t}=ae(),S=G(),C=F(),[y,x]=re(""),{form:d,resetForm:c}=oe(()=>({groupId:"",supId:"",startDate:"",endDate:""}),()=>_()),{data:N}=O(async()=>{const{res:i,err:l}=await A(()=>de.getSupplierList({pagingOrNot:"0"}));return l?[]:i==null?void 0:i.data.supplierList},[]),{selectRow:T,columnsData:v,visibleColumnsData:$,tableBaseOptions:a,resetData:_,setSelectRow:f,extendTableList:L,changeTableColumn:k,changeTableSize:b}=M(ce(),()=>z()),{data:P,loading:Y,initData:z}=O(async()=>{const{res:i,err:l}=await A(()=>q.getPlatformSettlementExamineList({...d.value,currentPage:a.pagination.current,pageSize:a.pagination.pageSize,pagingOrNot:"1"}));return l?[]:(a.pagination.total=i.data.totalCount,i==null?void 0:i.data.settleRecordApplyBatchList)}),j=i=>{i.groupNo.indexOf(",")>-1?f(i,()=>x("ZsGroupOrder")):S.push(`/order/platformManage/operate/?groupId=${i.groupNo}&name=${C.name}`)};return ne(z),(i,l)=>{const H=u("a-input"),D=u("a-form-item"),V=u("a-grid-item"),J=u("a-select"),B=u("a-date-picker"),Q=u("a-grid"),W=u("a-form"),U=u("a-button"),X=u("a-button-group"),ee=u("a-table");return w(),le("div",null,[r(pe,{"table-columns":e(v),"table-size":e(a).size,onResetSearch:e(c),onSearch:e(_),onChangeTableSize:e(b),onChangeTableColumn:e(k)},{form:o(()=>[r(W,{model:e(d),"label-align":"left",size:"large","auto-label-width":""},{default:o(()=>[r(Q,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:o(()=>[r(V,null,{default:o(()=>[r(D,{field:"groupNo",label:"团号:"},{default:o(()=>[r(H,{modelValue:e(d).groupId,"onUpdate:modelValue":l[0]||(l[0]=s=>e(d).groupId=s),placeholder:"请输入团号"},null,8,["modelValue"])]),_:1})]),_:1}),r(V,null,{default:o(()=>[r(D,{label:"供应商名称:"},{default:o(()=>[r(J,{modelValue:e(d).supId,"onUpdate:modelValue":l[1]||(l[1]=s=>e(d).supId=s),options:e(N),"field-names":{label:"supName",value:"id"},"virtual-list-props":{height:200},"allow-search":"",placeholder:"请选择供应商名称"},null,8,["modelValue","options"])]),_:1})]),_:1}),r(V,null,{default:o(()=>[r(D,{label:"出团日期:"},{default:o(()=>[r(B,{modelValue:e(d).startDate,"onUpdate:modelValue":l[2]||(l[2]=s=>e(d).startDate=s),class:"flex1",placeholder:"出团日期(开始)"},null,8,["modelValue"]),xe,r(B,{modelValue:e(d).endDate,"onUpdate:modelValue":l[3]||(l[3]=s=>e(d).endDate=s),class:"flex1",placeholder:"出团日期(结束)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),table:o(()=>[r(ee,{"selected-keys":e(a).selectedKeys,"onUpdate:selectedKeys":l[4]||(l[4]=s=>e(a).selectedKeys=s),class:"zs-table","row-key":"id",data:e(P),"row-selection":e(a).rowSelection,bordered:e(a).bordered,pagination:e(a).pagination,size:e(a).size,columns:e($),stripe:e(a).stripe,loading:e(Y)},{groupId:o(({record:s})=>[Z("span",{class:"text-link",onClick:K=>j(s)},se(s.groupNo),9,fe)]),operate:o(({record:s})=>[r(X,null,{default:o(()=>[r(U,{type:"text",status:"success",onClick:K=>i.$router.push(`/order/platformSettlementExamine/operate?id=${s.id}`)},{default:o(()=>[R("详情")]),_:2},1032,["onClick"]),ie((w(),E(U,{type:"text",onClick:K=>i.$router.push(`/order/platformSettlementExamine/operate?id=${s.id}&isExamine=true`)},{default:o(()=>[R("审核")]),_:2},1032,["onClick"])),[[e(t),"OrderPlatformSettlementExamineExamine"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(y)==="ZsGroupOrder"?(w(),E(_e,{key:0,data:e(T),onClose:l[5]||(l[5]=s=>e(f)({},()=>e(x)(""))),onSuccess:e(z)},null,8,["data","onSuccess"])):ue("",!0)])}}});export{Ce as default};

import{n as b,p as q,O as P,P as U,d as I,u as M,E as Q,s as G,r as p,o as V,l as D,w as a,g as e,c as t,k as $,A,C as L,b as K,i as d,t as c,X as h,f as Y,h as B}from"./index-8a2cb146.js";import{Z as O}from"./index-2bbe694f.js";import{_ as j}from"./zsPreviewDumplingDate.vue_vue_type_script_setup_true_name_ZsPreviewDumplingDate_lang-410dbbba.js";import{Q as S}from"./quitGroup-313e3abb.js";import"./zsRoutePrice-e3a5f38b.js";import"./line-7661aa01.js";const z=n=>{if(n.otherType==="1"){if(n.diffPrice==="1")switch(n.priceType){case"0":return"成人单房差其他价格";case"3":return"老人单房差其他价格";case"6":return"儿童单房差其他价格";case"10":return"占床儿童单房差其他价格";default:return"未知单房差其他价格"}if(n.diffPrice==="0")switch(n.priceType){case"0":return"成人其他价格";case"3":return"老人其他价格";case"6":return"儿童其他价格";case"10":return"占床儿童其他价格";default:return"未知其他价格"}}if(n.otherType==="0"){if(n.diffPrice==="1")switch(n.priceType){case"0":return"成人单房差价格";case"3":return"老人单房差价格";case"6":return"儿童单房差价格";case"10":return"占床儿童单房差价格";default:return"未知单房差价格"}if(n.diffPrice==="0")switch(n.priceType){case"0":return"成人同行价格";case"3":return"老人同行价格";case"6":return"儿童同行价格";case"10":return"占床儿童同行价格";default:return"未知同行价格"}}return"未知价格"},F=[{title:"姓名",dataIndex:"name",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:n})=>b(n.name)},{title:"性别",dataIndex:"gender",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>b(n.gender)},{title:"联系电话",dataIndex:"phone",show:!0,align:"center",render:({record:n})=>b(n.phone)},{title:"证件类型",dataIndex:"idType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>b(n.idType)},{title:"证件号码",dataIndex:"idNumber",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>b(n.idNumber)},{title:"年龄",dataIndex:"age",show:!0,align:"right",render:({record:n})=>b(n.age)},{title:"类别",dataIndex:"priceType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>b(n.name==="总计"?"-":z(n))},{title:"订单保险费",dataIndex:"insuranceCost",show:!0,align:"right",render:({record:n})=>q("span",{class:"text-red text-price"},P(U(n.insuranceCost)))},{title:"订单总费用",dataIndex:"allCost",show:!0,align:"right",render:({record:n})=>q("span",{class:"text-red text-price"},P(U(n.supSigCost)))}],E=I({name:"ZsConfirmRefund"}),X=I({...E,emits:["close","success"],setup(n,{emit:v}){const N=v,{warningModal:x}=A(),g=M(),[s,C]=Q(""),{form:o,formRef:i}=G(()=>({settleDesc:"",quitTotal:0,signupNo:"",routeName:"",supName:"",departName:"",outNum:0,signCost:0,settleTotal:0,totalNumber:1,signoutType:"",leaveNumber:0,departNo:"",isSubstrPoint:"",rebate:""})),m=async()=>{const{res:l,err:r}=await $(()=>S.getBusinessConfirmQuitGroupDetail({groupId:g.query.groupId,state:g.query.state,id:g.query.id}));r||(o.value={...l==null?void 0:l.data.signoutRecord,departName:l==null?void 0:l.data.signupRecord.departName,routeName:l==null?void 0:l.data.signupRecord.routeName,supName:l==null?void 0:l.data.signupRecord.supName,totalNumber:l==null?void 0:l.data.signupRecord.totalNumber,signCost:l==null?void 0:l.data.signCost,departNo:l==null?void 0:l.data.signupRecord.departNo,rebate:l==null?void 0:l.data.signupRecord.rebate,isSubstrPoint:l==null?void 0:l.data.signupRecord.rebate})},f=()=>{i.value.validate(l=>{l||w()})},w=()=>{x("确定退团？",async l=>{const{err:r}=await $(()=>S.confirmBusinessQuitGroup({groupId:g.query.groupId,id:g.query.id,signoutType:o.value.signoutType,leaveNumber:o.value.outNum,settleTotal:o.value.settleTotal,settleDesc:o.value.settleDesc,departNo:o.value.departNo,departName:o.value.departName,isSubstrPoint:o.value.isSubstrPoint,rebate:o.value.rebate}),{successMsg:"操作成功",after:()=>C(""),before:()=>C("okLoading")});l(!0),!r&&(N("success"),N("close"))})};return m(),(l,r)=>{const y=p("a-input"),_=p("a-form-item"),T=p("a-input-number"),k=p("a-textarea"),R=p("a-form"),Z=p("a-modal");return V(),D(Z,{top:"10%",width:"600px",title:"营业部确认","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":t(s)==="okLoading",onCancel:r[8]||(r[8]=u=>N("close")),onOk:f},{default:a(()=>[e(R,{model:t(o),ref_key:"formRef",ref:i,"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[e(_,{field:"signupNo",label:"团号:"},{default:a(()=>[e(y,{modelValue:t(o).signupNo,"onUpdate:modelValue":r[0]||(r[0]=u=>t(o).signupNo=u),readonly:"",placeholder:"请输入团号"},null,8,["modelValue"])]),_:1}),e(_,{field:"routeName",label:"线路名称:"},{default:a(()=>[e(y,{modelValue:t(o).routeName,"onUpdate:modelValue":r[1]||(r[1]=u=>t(o).routeName=u),readonly:"",placeholder:"请输入线路名称"},null,8,["modelValue"])]),_:1}),e(_,{field:"supName",label:"供应商名称:"},{default:a(()=>[e(y,{modelValue:t(o).supName,"onUpdate:modelValue":r[2]||(r[2]=u=>t(o).supName=u),readonly:"",placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1}),e(_,{field:"departName",label:"营业部名称:"},{default:a(()=>[e(y,{modelValue:t(o).departName,"onUpdate:modelValue":r[3]||(r[3]=u=>t(o).departName=u),readonly:"",placeholder:"请输入营业部名称"},null,8,["modelValue"])]),_:1}),e(_,{field:"outNum",label:"退团人数:"},{default:a(()=>[e(T,{modelValue:t(o).outNum,"onUpdate:modelValue":r[4]||(r[4]=u=>t(o).outNum=u),readonly:"",placeholder:"请输入退团人数"},null,8,["modelValue"])]),_:1}),e(_,{field:"signCost",label:"退团总金额:"},{default:a(()=>[e(T,{modelValue:t(o).signCost,"onUpdate:modelValue":r[5]||(r[5]=u=>t(o).signCost=u),readonly:"",precision:2,placeholder:"请输入退团总金额"},null,8,["modelValue"])]),_:1}),e(_,{field:"settleTotal",label:"总退款:"},{default:a(()=>[e(T,{modelValue:t(o).settleTotal,"onUpdate:modelValue":r[6]||(r[6]=u=>t(o).settleTotal=u),formatter:u=>t(P)(u,""),parser:u=>u.replace(/,/g,""),precision:2,max:t(o).settleTotal,min:0,placeholder:"请输入总退款"},null,8,["modelValue","formatter","parser","max"])]),_:1}),e(_,{field:"settleDesc",label:"报名退款说明:"},{default:a(()=>[e(k,{modelValue:t(o).settleDesc,"onUpdate:modelValue":r[7]||(r[7]=u=>t(o).settleDesc=u),placeholder:"请输入退款说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),H=Y("div",{style:{height:"100px"}},null,-1),J={class:"orderSubmit-footer box-flex jc-fe"},W=I({name:"QuitGroupBusinessQuitConfirm"}),re=I({...W,setup(n){const v=M(),{jumpTabName:N}=L(),[x,g]=Q(null),{data:s,loading:C}=K(async()=>{const{res:o,err:i}=await $(()=>S.getBusinessQuitGroupDetail({groupId:v.query.groupId,state:v.query.state,id:v.query.id}));return i?{}:o==null?void 0:o.data},{touristsInfoList:[],signupRecord:{},signoutRecord:{}});return(o,i)=>{const m=p("a-tag"),f=p("a-descriptions-item"),w=p("a-descriptions"),l=p("a-button"),r=p("a-space"),y=p("a-card"),_=p("a-alert"),T=p("a-table"),k=p("a-typography-title");return V(),D(O,null,{default:a(()=>[e(y,{title:"基本信息",loading:t(C),bordered:!1,class:"general-card"},{default:a(()=>[e(w,{column:{xs:1,md:2,lg:4},size:"large"},{default:a(()=>[e(f,{label:"线路名称："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.routeName),1)]),_:1})]),_:1}),e(f,{label:"供应商名称："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.supName),1)]),_:1})]),_:1}),e(f,{label:"营业部名称："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.departName),1)]),_:1})]),_:1}),e(f,{label:"团号："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.groupId),1)]),_:1})]),_:1}),e(f,{label:"所属地区："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.areaName),1)]),_:1})]),_:1}),e(f,{label:"目的地："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.arrival),1)]),_:1})]),_:1}),e(f,{label:"集合地点："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(b)(t(s).signupRecord.aggregatePlace,"--")),1)]),_:1})]),_:1}),e(f,{label:"旅行时间："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(h)(t(s).signupRecord.startDate,"YYYY-MM-DD"))+"至"+c(t(h)(t(s).signupRecord.endDate,"YYYY-MM-DD")),1)]),_:1})]),_:1}),e(f,{label:"旅行天数/天："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.travelDays),1)]),_:1})]),_:1}),e(f,{label:"旅行类型："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.travelType),1)]),_:1})]),_:1}),e(f,{label:"成团类别："},{default:a(()=>[e(m,null,{default:a(()=>[d(c(t(s).signupRecord.groupType==1?"单团":"散客"),1)]),_:1})]),_:1})]),_:1}),e(r,{class:"margin-top"},{default:a(()=>[e(l,{type:"primary",onClick:i[0]||(i[0]=R=>t(g)("ZsPreviewDumplingDate"))},{default:a(()=>[d("信息价格")]),_:1}),e(l,{type:"primary",onClick:i[1]||(i[1]=R=>o.$router.push(`/line/addTourismManage/operate?mark=2&id=${t(s).signupRecord.routeId}&isReadOnly=true&name=${o.$route.name}`))},{default:a(()=>[d("查看行程")]),_:1})]),_:1})]),_:1},8,["loading"]),e(y,{title:"游客信息",bordered:!1,class:"general-card margin-top"},{default:a(()=>[e(_,null,{default:a(()=>[d(" 当前订单总计是每个游客价格的汇总，若订单有过退团或订单调账操作，可能与实际订单金额有出入，请以订单管理页面中金额为准。 ")]),_:1}),e(T,{size:"large",class:"margin-top",columns:t(F),data:t(s).touristsInfoList,pagination:!1,bordered:!1},null,8,["columns","data"]),e(k,{heading:6,class:"box-flex jc-fe margin-top"},{default:a(()=>[d("退团游客共计： "+c(t(s).touristsInfoList.length-1)+"位",1)]),_:1})]),_:1}),H,Y("div",J,[e(r,null,{default:a(()=>[e(l,{type:"primary",onClick:i[2]||(i[2]=R=>t(g)("ZsConfirmRefund"))},{default:a(()=>[d("确定")]),_:1}),e(l,{onClick:i[3]||(i[3]=()=>t(N)())},{default:a(()=>[d("返回")]),_:1})]),_:1})]),t(x)==="ZsPreviewDumplingDate"?(V(),D(j,{key:0,data:{id:t(s).signupRecord.routeId},"default-time-arr":[t(h)(t(s).signupRecord.startDate)],onClose:i[4]||(i[4]=R=>t(g)(""))},null,8,["data","default-time-arr"])):B("",!0),t(x)==="ZsConfirmRefund"?(V(),D(X,{key:1,onClose:i[5]||(i[5]=R=>t(g)("")),onSuccess:i[6]||(i[6]=()=>t(N)())})):B("",!0)]),_:1})}}});export{re as default};

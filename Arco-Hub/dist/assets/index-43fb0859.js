import{d as x,u as U,C as I,a as M,E as j,s as P,b as E,k as m,r,o as K,l as Y,w as o,f as k,g as n,c as a,i as V,W as Z,Y as $,S as b}from"./index-8a2cb146.js";import{Z as z}from"./index-2bbe694f.js";const F={class:"box-flex"},O={class:"flex1",style:{"margin-left":"16px"}},W=x({name:"SystemLineTypeOperate"}),Q=x({...W,setup(G){const u=U(),{jumpTabName:f}=I(),{getDictionaryInfo:C}=M(),[h,p]=j(null),{form:t,formRef:_}=P(()=>({linename:"",lineVer:"",lineDesc:"",remake:"",areaLevel:"",lineAreaList:[],lineLevelList:[]})),A={linename:{required:!0,message:"请输入线路类型"},lineVer:{required:!0,message:"请选择旅游类型"},lineDesc:{required:!0,message:"请输入目的地"}},{data:c,loading:D}=E(async()=>{const{res:e,err:l}=await m(()=>$.getAreaTree());return l?[]:e==null?void 0:e.data.areaList},[]),N=()=>{_.value.validate(e=>{e||(u.query.id?y("editCooperationRoute"):y("addCooperationRoute"))})},y=async e=>{const{err:l}=await m(()=>b[e]({...t.value,areaNo:t.value.lineAreaList.map(i=>i.split("_")[0]).join(","),areaLevel:t.value.lineLevelList.join(",")}),{before:()=>p("okLoading"),after:()=>p(null)});l||f()},q=async()=>{const{res:e,err:l}=await m(()=>b.getCooperationRouteDetail({id:u.query.id}));l||(t.value={...e==null?void 0:e.data,lineAreaList:e==null?void 0:e.data.lineAreaList.map(i=>`${i.areaNo}_${i.privClass}`),lineLevelList:e==null?void 0:e.data.lineAreaList.map(i=>i.privClass)})},w=(e,l)=>{t.value.lineAreaList=e,t.value.lineLevelList=l.checkedNodes.map(i=>i.areaLevel)};return u.query.id&&q(),(e,l)=>{const i=r("a-tree"),v=r("a-card"),S=r("a-input"),d=r("a-form-item"),T=r("a-select"),L=r("a-textarea"),g=r("a-button"),R=r("a-space"),B=r("a-form");return K(),Y(z,null,{default:o(()=>[k("div",F,[n(v,{class:"general-card",loading:a(D),style:{"min-width":"600px"},title:"地区阅览"},{default:o(()=>[n(i,{"checked-keys":a(t).lineAreaList,checkable:"","show-line":"","default-expand-all":!1,"checked-strategy":"child","default-expanded-keys":a(c).length?[a(c)[0].areaNoAndLevel]:[],fieldNames:{key:"areaNoAndLevel",title:"areaName",children:"children"},data:a(c),onCheck:w},null,8,["checked-keys","default-expanded-keys","data"])]),_:1},8,["loading"]),k("div",O,[n(v,{title:a(Z)("线路",!!a(u).query.id),bordered:!1,class:"general-card"},{default:o(()=>[n(B,{ref_key:"formRef",ref:_,model:a(t),"label-align":"left",size:"large",style:{width:"800px","padding-left":"100px"},"auto-label-width":"",rules:A},{default:o(()=>[n(d,{label:"线路类型:",field:"linename",required:""},{default:o(()=>[n(S,{modelValue:a(t).linename,"onUpdate:modelValue":l[0]||(l[0]=s=>a(t).linename=s),modelModifiers:{trim:!0},placeholder:"请输入线路类型"},null,8,["modelValue"])]),_:1}),n(d,{label:"旅游类型:",field:"lineVer",required:""},{default:o(()=>[n(T,{modelValue:a(t).lineVer,"onUpdate:modelValue":l[1]||(l[1]=s=>a(t).lineVer=s),options:a(C)("travelType"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请输入旅游类型"},null,8,["modelValue","options"])]),_:1}),n(d,{label:"目的地:",field:"lineDesc",required:""},{default:o(()=>[n(L,{modelValue:a(t).lineDesc,"onUpdate:modelValue":l[2]||(l[2]=s=>a(t).lineDesc=s),placeholder:"请选择目的地",multiple:""},null,8,["modelValue"])]),_:1}),n(d,{label:"备注:",field:"remake"},{default:o(()=>[n(L,{modelValue:a(t).remake,"onUpdate:modelValue":l[3]||(l[3]=s=>a(t).remake=s),modelModifiers:{trim:!0},"max-length":200,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),n(d,null,{default:o(()=>[n(R,null,{default:o(()=>[n(g,{type:"primary",loading:a(h)==="okLoading",onClick:N},{default:o(()=>[V("确定")]),_:1},8,["loading"]),n(g,{onClick:l[4]||(l[4]=()=>a(f)())},{default:o(()=>[V("返回")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])])]),_:1})}}});export{Q as default};

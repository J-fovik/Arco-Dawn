import{d as C,E as B,s as Z,r as i,o as v,l as S,w as t,g as a,c as e,k as M,u as F,C as O,b as h,i as p,t as u,f as x,O as R,h as A,e as q,F as I}from"./index-8a2cb146.js";import{Z as T}from"./index-2bbe694f.js";import{O as V}from"./order-70291d37.js";const z=C({name:"ZsExamineSettlement"}),w=C({...z,props:{data:{default:()=>({})},isRemake:{type:Boolean,default:!1},type:{}},emits:["close","success"],setup($,{emit:f}){const m=$,_=f,[y,s]=B(null),{form:b,formRef:d}=Z(()=>({applyDesc:""})),l={applyDesc:{validator:(c,r)=>{!c&&m.isRemake&&r("审核驳回时备注必填")}}},o=()=>{d.value.validate(c=>{c||(m.type==="success"?n("platformSettlementExamineSuccess"):n("platformSettlementExamineFail"))})},n=async c=>{const{err:r}=await M(()=>V[c]({batchId:m.data.id,applyDesc:b.value.applyDesc}),{before:()=>s("okLoading"),after:()=>s(""),successMsg:"操作成功"});r||(_("success"),_("close"))};return(c,r)=>{const D=i("a-textarea"),g=i("a-form-item"),E=i("a-form"),k=i("a-modal");return v(),S(k,{width:"600px",top:"10%","unmount-on-close":"",visible:"","align-center":!1,title:`审核${c.type==="success"?"通过":"驳回"}`,"mask-closable":!1,"ok-loading":e(y)==="okLoading",onCancel:r[1]||(r[1]=N=>_("close")),onOk:o},{default:t(()=>[a(E,{ref_key:"formRef",ref:d,model:e(b),"label-align":"left",size:"large","auto-label-width":"",rules:l},{default:t(()=>[a(g,{field:"applyDesc",label:"备注:"},{default:t(()=>[a(D,{modelValue:e(b).applyDesc,"onUpdate:modelValue":r[0]||(r[0]=N=>e(b).applyDesc=N),modelModifiers:{trim:!0},placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),K={class:"text-red text-price"},P={class:"text-red text-price"},j={class:"text-red text-price"},L={class:"text-red text-price"},U=x("div",{style:{height:"100px"}},null,-1),G={class:"orderSubmit-footer box-flex jc-fe"},H=C({name:"OrderPlatformSettlementExamineOperate"}),X=C({...H,setup($){const f=F(),{jumpTabName:m}=O(),[_,y]=B(""),{data:s,loading:b}=h(async()=>{const{res:d,err:l}=await M(()=>V.getPlatformSettlementExamineDetail({batchId:f.query.id}));if(!l)return{...d==null?void 0:d.data,invoiceMap:d==null?void 0:d.data.invoiceMap.all.map(o=>({name:o.attName,url:o.attPath,status:"done",uid:o.id,attSize:o.attSize}))}},{invoiceMap:[],settleRecordApply:{}});return(d,l)=>{const o=i("a-tag"),n=i("a-descriptions-item"),c=i("a-descriptions"),r=i("a-card"),D=i("a-upload"),g=i("a-button"),E=i("a-space");return v(),S(T,null,{default:t(()=>[a(r,{title:"结算详情",loading:e(b),bordered:!1,class:"general-card"},{default:t(()=>[a(c,{size:"large",column:3},{default:t(()=>[a(n,{label:"结算团号："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).groupIds),1)]),_:1})]),_:1}),a(n,{label:"供应商："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).settleRecordApply.supName),1)]),_:1})]),_:1}),a(n,{label:"订单同行总费用："},{default:t(()=>[x("span",K,u(e(R)(`${e(s).settleRecordApply.supsigCost??0}`)),1)]),_:1}),a(n,{label:"供应商结算费用："},{default:t(()=>[x("span",P,u(e(R)(`${e(s).settleRecordApply.moneyTotal??0}`)),1)]),_:1}),a(n,{label:"已结算金额："},{default:t(()=>[x("span",j,u(e(R)(`${e(s).settleRecordApply.totalSettledAmount??0}`)),1)]),_:1}),a(n,{label:"本次申请结算金额："},{default:t(()=>[x("span",L,u(e(R)(`${e(s).settleRecordApply.money??0}`)),1)]),_:1}),a(n,{label:"户名："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).settleRecordApply.receiveUserName),1)]),_:1})]),_:1}),a(n,{label:"账号："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).settleRecordApply.receiveNum),1)]),_:1})]),_:1}),a(n,{label:"开户行："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).settleRecordApply.receiveBankName),1)]),_:1})]),_:1}),a(n,{label:"联行号："},{default:t(()=>[a(o,null,{default:t(()=>[p(u(e(s).settleRecordApply.receiveSettleBankNo),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),e(s).invoiceMap.length?(v(),S(r,{key:0,title:"发票信息",bordered:!1,class:"general-card margin-top"},{default:t(()=>[a(D,{"file-list":e(s).invoiceMap,"auto-upload":!1,limit:1,"show-remove-button":!1,"show-retry-button":!1},null,8,["file-list"])]),_:1})):A("",!0),U,x("div",G,[a(E,null,{default:t(()=>[e(f).query.isExamine?(v(),q(I,{key:0},[a(g,{type:"primary",onClick:l[0]||(l[0]=k=>e(y)("ZsExamineSettlementSuccess"))},{default:t(()=>[p("通过")]),_:1}),a(g,{status:"danger",onClick:l[1]||(l[1]=k=>e(y)("ZsExamineSettlementFail"))},{default:t(()=>[p("驳回")]),_:1})],64)):A("",!0),a(g,{onClick:l[2]||(l[2]=()=>e(m)())},{default:t(()=>[p("返回")]),_:1})]),_:1})]),e(_)==="ZsExamineSettlementSuccess"?(v(),S(w,{key:1,data:{id:e(f).query.id},type:"success","is-remake":!1,onClose:l[3]||(l[3]=k=>e(y)("")),onSuccess:l[4]||(l[4]=()=>e(m)())},null,8,["data"])):A("",!0),e(_)==="ZsExamineSettlementFail"?(v(),S(w,{key:2,data:{id:e(f).query.id},type:"fail","is-remake":!0,onClose:l[5]||(l[5]=k=>e(y)("")),onSuccess:l[6]||(l[6]=()=>e(m)())},null,8,["data"])):A("",!0)]),_:1})}}});export{X as default};

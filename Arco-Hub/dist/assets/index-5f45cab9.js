import{d as P,g as M,h as E,i as F,r as n,o as q,l as j,w as a,a as l,b as e,m as z,n as ee,j as le,c as ae,e as T,p as te,q as oe}from"./index-d007178a.js";import{f as h,c as ne,_ as se}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{f as de,A as D}from"./options-aafac76d.js";import{R as I}from"./recruit-3c2f52ae.js";import"./index-13860ba0.js";const $=[{label:"文科",value:"文科"},{label:"理科",value:"理科"},{label:"综合",value:"综合"},{label:"物理",value:"物理"},{label:"历史",value:"历史"}],re=[{label:"本科",value:"本科"},{label:"专科",value:"专科"}],ue=()=>[{title:"序号",width:100,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"省份",dataIndex:"sf",show:!0,align:"center",render:({record:r})=>h(r.sf)},{title:"年份",dataIndex:"nf",show:!0,align:"center",render:({record:r})=>h(r.nf)},{title:"分数",dataIndex:"score",show:!0,align:"center",render:({record:r})=>h(r.score)},{title:"同分人数",dataIndex:"cnt",show:!0,align:"center",render:({record:r})=>h(r.cnt)},{title:"位次",dataIndex:"wc",show:!0,align:"center",render:({record:r})=>h(r.wc)},{title:"科类",dataIndex:"kl",show:!0,align:"center",render:({record:r})=>{var _;return h((_=de($,r.kl))==null?void 0:_.label)}},{title:"分段",dataIndex:"fd",show:!0,align:"center",render:({record:r})=>h(r.fd)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],ie=P({name:"zsAddOneParagraph"}),ce=P({...ie,props:{data:{default:()=>({})}},emits:["close","success"],setup(r,{emit:_}){const g=r,b=M(),[U,i]=E(null),{form:s,formRef:S}=F(()=>({...g.data})),R={sf:{required:!0,message:"请输入省份"},nf:{required:!0,message:"请输入年份"},score:{required:!0,message:"请输入分数"},cnt:{required:!0,message:"请输入同分人数"},wc:{required:!0,message:"请输入位次"},kl:{required:!0,message:"请选择科类"},fd:{required:!0,message:"请选择分段"}},A=()=>{S.value.validate(w=>{w||(g.data.id?d("editOneParagraph"):d("addOneParagraph"))})},d=async w=>{const{err:o}=await z(()=>I[w](s.value),{before:()=>i("okLoading"),after:()=>i(null)});o||(_("success"),_("close"))};return(w,o)=>{const k=n("a-select"),m=n("a-form-item"),p=n("a-grid-item"),v=n("a-input"),K=n("a-grid"),L=n("a-form"),y=n("a-modal");return q(),j(y,{title:e(ne)("一分一段表",!!g.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"80vw","align-center":!1,"mask-closable":!1,"ok-loading":e(U)==="okLoading",onCancel:o[7]||(o[7]=u=>_("close")),onOk:A},{default:a(()=>[l(L,{ref_key:"formRef",ref:S,model:e(s),"label-align":"left",size:"large","auto-label-width":"",rules:R},{default:a(()=>[l(K,{cols:2,"col-gap":24},{default:a(()=>[l(p,null,{default:a(()=>[l(m,{field:"sf",label:"省份:"},{default:a(()=>[l(k,{modelValue:e(s).sf,"onUpdate:modelValue":o[0]||(o[0]=u=>e(s).sf=u),placeholder:"请输入省份","allow-search":"",options:[...e(D),...e(b).provinceList]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"nf",label:"年份:"},{default:a(()=>[l(v,{modelValue:e(s).nf,"onUpdate:modelValue":o[1]||(o[1]=u=>e(s).nf=u),placeholder:"请输入年份"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"score",label:"分数:"},{default:a(()=>[l(v,{modelValue:e(s).score,"onUpdate:modelValue":o[2]||(o[2]=u=>e(s).score=u),placeholder:"请输入分数"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"cnt",label:"同分人数:"},{default:a(()=>[l(v,{modelValue:e(s).cnt,"onUpdate:modelValue":o[3]||(o[3]=u=>e(s).cnt=u),placeholder:"请输入同分人数"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"wc",label:"位次:"},{default:a(()=>[l(v,{modelValue:e(s).wc,"onUpdate:modelValue":o[4]||(o[4]=u=>e(s).wc=u),placeholder:"请输入位次"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"kl",label:"科类:"},{default:a(()=>[l(k,{modelValue:e(s).kl,"onUpdate:modelValue":o[5]||(o[5]=u=>e(s).kl=u),placeholder:"请选择科类","allow-clear":"",options:[...e($)]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(m,{field:"fd",label:"分段:"},{default:a(()=>[l(k,{modelValue:e(s).fd,"onUpdate:modelValue":o[6]||(o[6]=u=>e(s).fd=u),placeholder:"请选择分段","allow-clear":"",options:[...e(re)]},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),me=P({name:"RecruitOneParagraph"}),we=P({...me,setup(r){const{warningModal:_}=oe(),[g,b]=E(null),U=M(),{form:i,resetForm:s}=F(()=>({sf:"",nf:"",score:"",kl:"",fd:""}),()=>w()),{selectRow:S,columnsData:R,visibleColumnsData:A,tableBaseOptions:d,resetData:w,extendTableList:o,setSelectRow:k,changeTableColumn:m,changeTableSize:p}=ee(ue(),()=>y()),v=()=>{_(`确定删除选中的${d.selectedKeys.length}数据吗？`,async f=>{const{err:t}=await z(()=>I.deleteOneParagraph({ids:d.selectedKeys}),{successMsg:"操作成功"});t||(f(!0),d.selectedKeys=[],y())})},{data:K,loading:L,initData:y}=le(async()=>{const{res:f,err:t}=await z(()=>I.getOneParagraphList({...i.value,currentPage:d.pagination.current,pageSize:d.pagination.pageSize,pagingOrNot:"1"}));return t?[]:(d.pagination.total=f.data.totalCount,o(f==null?void 0:f.data.resultList))}),u=async f=>{const{err:t}=await z(()=>I.daoruBatchLine({path:f.at(-1).file}),{after:()=>b(null),before:()=>b("批量上传")});t||y()};return(f,t)=>{const B=n("a-select"),x=n("a-form-item"),C=n("a-grid-item"),N=n("a-input"),G=n("a-grid"),W=n("a-form"),Y=n("icon-plus"),O=n("a-button"),H=n("icon-close"),J=n("icon-upload"),Q=n("a-upload"),X=n("a-space"),Z=n("a-table");return q(),ae("div",null,[l(se,{fold:"","table-columns":e(R),"table-size":e(d).size,onResetSearch:e(s),onSearch:e(w),onChangeTableSize:e(p),onChangeTableColumn:e(m)},{form:a(({collapsed:V})=>[l(W,{model:e(i),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[l(G,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!V},{default:a(()=>[l(C,null,{default:a(()=>[l(x,{field:"sf",label:"省份:"},{default:a(()=>[l(B,{modelValue:e(i).sf,"onUpdate:modelValue":t[0]||(t[0]=c=>e(i).sf=c),placeholder:"请输入省份","allow-search":"",options:[...e(D),...e(U).provinceList]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"年份:"},{default:a(()=>[l(N,{modelValue:e(i).nf,"onUpdate:modelValue":t[1]||(t[1]=c=>e(i).nf=c),placeholder:"请输入年份"},null,8,["modelValue"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"科类:"},{default:a(()=>[l(B,{modelValue:e(i).kl,"onUpdate:modelValue":t[2]||(t[2]=c=>e(i).kl=c),placeholder:"请选择科类","allow-clear":"",options:[...e(D),...e($)]},null,8,["modelValue","options"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"分数:"},{default:a(()=>[l(N,{modelValue:e(i).score,"onUpdate:modelValue":t[3]||(t[3]=c=>e(i).score=c),placeholder:"请输入分数"},null,8,["modelValue"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"分段:"},{default:a(()=>[l(N,{modelValue:e(i).fd,"onUpdate:modelValue":t[4]||(t[4]=c=>e(i).fd=c),placeholder:"请输入分段"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:a(()=>[l(X,null,{default:a(()=>[l(O,{type:"outline",onClick:t[5]||(t[5]=V=>e(b)("zsAddOneParagraph"))},{icon:a(()=>[l(Y)]),default:a(()=>[T(" 新增 ")]),_:1}),l(O,{type:"outline",status:"danger",disabled:!e(d).selectedKeys.length,loading:e(g)==="删除",onClick:v},{icon:a(()=>[l(H)]),default:a(()=>[T(" 删除 ")]),_:1},8,["disabled","loading"]),l(Q,{"list-type":"text","auto-upload":!1,"show-cancel-button":!1,"show-link":!1,"show-file-list":!1,accept:".xlsx,.xls",action:"/",onChange:u},{"upload-button":a(()=>[l(O,{type:"outline",loading:e(g)==="批量上传",status:"warning"},{icon:a(()=>[l(J)]),default:a(()=>[T(" 批量上传 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),table:a(()=>[l(Z,{"selected-keys":e(d).selectedKeys,"onUpdate:selectedKeys":t[6]||(t[6]=V=>e(d).selectedKeys=V),class:"zs-table","row-key":"id",data:e(K),"row-selection":e(d).rowSelection,bordered:e(d).bordered,pagination:e(d).pagination,size:e(d).size,columns:e(A),stripe:e(d).stripe,loading:e(L)},{operate:a(({record:V})=>[l(O,{type:"text",onClick:c=>e(k)(V,()=>e(b)("zsAddOneParagraph"))},{default:a(()=>[T("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(g)==="zsAddOneParagraph"?(q(),j(ce,{key:0,data:e(S),onSuccess:e(y),onClose:t[7]||(t[7]=V=>e(k)({},()=>e(b)(null)))},null,8,["data","onSuccess"])):te("",!0)])}}});export{we as default};

import{d as A,E as G,s as H,M as O,r,o as S,l as M,w as a,f as i,g as e,c as n,t as Y,h as J,i as Q,k as g,G as W,H as X,A as $,S as v,_ as ee}from"./index-8a2cb146.js";import{Z as ae}from"./index-2bbe694f.js";const y=_=>(W("data-v-7b507c7d"),_=_(),X(),_),te={class:"box-flex"},le=y(()=>i("span",{style:{"margin-left":"10px"}},"添加子地区",-1)),oe=y(()=>i("span",{style:{"margin-left":"10px"}},"修改地区",-1)),ne=y(()=>i("span",{style:{"margin-left":"10px"}},"删除地区",-1)),re={class:"flex1",style:{"margin-left":"16px"}},de={class:"box-flex jc-c margin-top"},se=A({name:"Area"}),ie=A({...se,setup(_){const{warningModal:q}=$(),[C,b]=G(null),{form:t,formRef:x,resetForm:N}=H(()=>({id:"",type:"",areaName:"",areaNo:"",parentNo:"",areaDesc:"",abbrev:"",remark:""})),I={areaName:{required:!0,message:"请输入地区名称"},areaNo:{required:!0,message:"请输入地区编码"},abbrev:{required:!0,message:"请输入地区简写"},areaDesc:{required:!0,message:"请输入地区描述"}},{data:m,initData:h}=O(async()=>{const{res:o}=await g(()=>v.getAreaTree());return(o==null?void 0:o.data.areaList)??[]},[]),L=(o,l)=>{o==="添加"?B(l):o==="修改"?V([],{node:l}):U(l.id)},U=o=>{q("确定删除该部门吗？",async l=>{const{err:p}=await g(()=>v.deleteArea({idList:[o]}),{successMsg:"操作成功"});p||(l(!0),h(),o===t.value.id&&N())})},B=async o=>{N(),t.value.parentNo=o.areaNo,t.value.type="add"},V=(o,l)=>{const{children:p,...c}=l.node;t.value=c,t.value.type="edit"},T=async()=>{x.value.validate(o=>{o||(t.value.type==="edit"?k("editArea"):k("addArea"))})},k=async o=>{const{err:l}=await g(()=>v[o](t.value),{before:()=>b("保存"),after:()=>b(null),successMsg:"保存成功"});l||(t.value.type="edit",h())};return(o,l)=>{const p=r("icon-plus"),c=r("a-doption"),R=r("icon-edit"),z=r("icon-lock"),E=r("a-dropdown"),F=r("a-tree"),w=r("a-card"),f=r("a-input"),u=r("a-form-item"),s=r("a-grid-item"),D=r("a-textarea"),K=r("a-button"),P=r("a-grid"),Z=r("a-form");return S(),M(ae,null,{default:a(()=>[i("div",te,[e(w,{class:"general-card",style:{"min-width":"400px"},title:"地区阅览"},{default:a(()=>[n(m).length?(S(),M(F,{key:0,data:n(m),fieldNames:{key:"areaNoAndLevel",title:"areaName",children:"children"},"default-expanded-keys":n(m).length?[n(m)[0].areaNoAndLevel]:[],"block-node":"","show-line":"","default-expand-all":"",selectable:"",onSelect:V},{title:a(d=>[e(E,{trigger:"contextMenu",alignPoint:"",position:"bl","popup-max-height":!1,onSelect:j=>L(j,d)},{content:a(()=>[e(c,{value:"添加"},{default:a(()=>[e(p),le]),_:1}),e(c,{value:"修改"},{default:a(()=>[e(R),oe]),_:1}),e(c,{value:"删除"},{default:a(()=>[e(z),ne]),_:1})]),default:a(()=>[i("span",null,Y(d.areaName),1)]),_:2},1032,["onSelect"])]),_:1},8,["data","default-expanded-keys"])):J("",!0)]),_:1}),i("div",re,[e(w,{class:"general-card",title:"部门信息"},{default:a(()=>[e(Z,{ref_key:"formRef",ref:x,size:"large",layout:"vertical","auto-label-width":"",model:n(t),rules:I},{default:a(()=>[e(P,{cols:2,"col-gap":20},{default:a(()=>[e(s,null,{default:a(()=>[e(u,{label:"父级代码:",field:"parentNo",required:""},{default:a(()=>[e(f,{"model-value":n(t).parentNo,placeholder:"父部门代码",readonly:""},null,8,["model-value"])]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(u,{label:"地区代码:",field:"areaNo",required:""},{default:a(()=>[e(f,{modelValue:n(t).areaNo,"onUpdate:modelValue":l[0]||(l[0]=d=>n(t).areaNo=d),modelModifiers:{trim:!0},placeholder:"部门代码"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(u,{label:"地区名称:",field:"areaName",required:""},{default:a(()=>[e(f,{modelValue:n(t).areaName,"onUpdate:modelValue":l[1]||(l[1]=d=>n(t).areaName=d),modelModifiers:{trim:!0},placeholder:"请输入地区名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(u,{label:"地区简写:",field:"abbrev",required:""},{default:a(()=>[e(f,{modelValue:n(t).abbrev,"onUpdate:modelValue":l[2]||(l[2]=d=>n(t).abbrev=d),modelModifiers:{trim:!0},placeholder:"请输入地区名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(u,{label:"地区描述:",field:"areaDesc",required:""},{default:a(()=>[e(D,{modelValue:n(t).areaDesc,"onUpdate:modelValue":l[3]||(l[3]=d=>n(t).areaDesc=d),modelModifiers:{trim:!0},placeholder:"请输入地区名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(u,{label:"备注:",field:"remark"},{default:a(()=>[e(D,{modelValue:n(t).remark,"onUpdate:modelValue":l[4]||(l[4]=d=>n(t).remark=d),modelModifiers:{trim:!0},placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:2},{default:a(()=>[i("div",de,[e(K,{type:"primary",size:"large",loading:n(C)==="保存",onClick:T},{default:a(()=>[Q("保存")]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])]),_:1})}}});const _e=ee(ie,[["__scopeId","data-v-7b507c7d"]]);export{_e as default};

import{d as z,E as Y,s as ee,r as n,o as g,l as x,w as l,g as e,c as a,i as s,h as N,k as le,u as re,C as oe,D as U,R as ue,a1 as ie,M as se,O as I,e as J,F as Q,j as ne,f as C,G as me,H as pe,X as fe,t as ce,ac as _e,_ as ge}from"./index-8a2cb146.js";import{Z as ve}from"./index-2bbe694f.js";import{Z as W}from"./zsRoutePrice-e3a5f38b.js";import{S as be}from"./supplier-c338fe4b.js";import{L as ye}from"./line-7661aa01.js";const Ve=z({name:"ZsExamineTourism"}),Te=z({...Ve,props:{data:{default:()=>({})}},emits:["close","success"],setup(h,{emit:F}){const O=h,[Z,D]=Y(""),{form:_,formRef:j}=ee(()=>({examine:"",adjustState:"1"})),P={auditOpinion:{required:!0,message:"请输入驳回原因"}},q=F,w=()=>{j.value.validate(A=>{A||r()})},r=async()=>{const{err:A}=await le(()=>be.examineApplicationPrice({..._.value,id:O.data.id}),{before:()=>D("okLoading"),after:()=>D(""),successMsg:"审核成功"});A||(q("success"),q("close"))};return(A,v)=>{const k=n("a-radio"),$=n("a-radio-group"),b=n("a-form-item"),K=n("a-textarea"),R=n("a-form"),G=n("a-modal");return g(),x(G,{top:"10%",width:"500px",title:"线路审核","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":a(Z)==="okLoading",onCancel:v[2]||(v[2]=S=>q("close")),onOk:w},{default:l(()=>[e(R,{ref_key:"formRef",ref:j,model:a(_),"label-align":"left",size:"large","auto-label-width":"",rules:P},{default:l(()=>[e(b,{field:"adjustState",label:"审核:",required:""},{default:l(()=>[e($,{modelValue:a(_).adjustState,"onUpdate:modelValue":v[0]||(v[0]=S=>a(_).adjustState=S)},{default:l(()=>[e(k,{value:"1"},{default:l(()=>[s("通过")]),_:1}),e(k,{value:"4"},{default:l(()=>[s("驳回")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_).adjustState==="4"?(g(),x(b,{key:0,field:"examine",label:"驳回原因:",required:""},{default:l(()=>[e(K,{modelValue:a(_).examine,"onUpdate:modelValue":v[1]||(v[1]=S=>a(_).examine=S),placeholder:"请输入驳回原因"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),B=h=>(me("data-v-a55cb5f5"),h=h(),pe(),h),xe=B(()=>C("div",{style:{padding:"0 10px"}},"-",-1)),he=B(()=>C("div",{style:{padding:"0 10px"}},"-",-1)),qe=B(()=>C("div",{style:{padding:"0 10px"}},"-",-1)),Ae=B(()=>C("div",{style:{height:"100px"}},null,-1)),Se={class:"orderSubmit-footer box-flex jc-fe"},Me=z({name:"LineAdjustmentTourismExamineOperate"}),De=z({...Me,setup(h){const F=re(),{jumpTabName:O}=oe(),[Z,D]=Y(""),_=U(null),j=U(null),P=ue(""),q=U([]),w=U([]),{form:r,formRef:A}=ee(()=>({routeName:"",travelType:"",routeType:"",groupType:"1",isBefore:"1",beforeDays:void 0,idType:[],vehicle:[],travelDays:void 0,adultAgeMin:void 0,adultAgeMax:void 0,ageOfTheElderlyMin:void 0,ageOfTheElderlyMax:105,childrenSAgeMin:void 0,childrenSAgeMax:void 0,arrival:"",supplierId:"",isReturnPoint:"1",isSubstrPoint:"1",addRebate:void 0,rebate:void 0,areaList:[],deposit:void 0,allTimeArr:[],routePrice:{crmsjg:void 0,crtxjg:void 0,crdffcmsj:void 0,crdrfctxj:void 0,crqtjg:void 0,lrmsjg:void 0,lrtxjg:void 0,lrdffcmsj2:void 0,lrdrfctxj:void 0,lrqtjg:void 0,etmsjg:void 0,ettxjg:void 0,etdffcmsj:void 0,etqtjg:void 0,zccrdrfctxj:void 0,zcrtdffcmsj:void 0,zcettxjg:void 0,zcetmsjg:void 0,zcetdrfctxj:void 0,zcetqtjg:void 0,qtjg:void 0,qtjg2:void 0,qtjg3:void 0,qtjg4:void 0,remark:""}})),v=U({routeTripList:[],businessDepartList:[],attachList:[],other:{}}),k=ie(()=>b.value.routeTypeList.filter(o=>o.lineVer===r.value.travelType)),$={routeName:{required:!0,message:"请输入登录名"},travelType:{required:!0,message:"请选择旅行类型"},routeType:{required:!0,message:"请选择线路类型"},deposit:{required:!0,message:"请输入押金"},beforeDays:{required:!0,message:"请输入提前报名天数"},idType:{required:!0,message:"请选择支持证件"},vehicle:{required:!0,message:"请选择交通工具"},travelDays:{required:!0,message:"请输入天数"},adultAge:{required:!0,validator:(o,t)=>{!r.value.adultAgeMin&&!r.value.adultAgeMax&&t("请输入正确的年龄")}},ageOfTheElderly:{required:!0,validator:(o,t)=>{!r.value.ageOfTheElderlyMin&&!r.value.ageOfTheElderlyMax&&t("请输入正确的年龄")}},childrenSAge:{required:!0,validator:(o,t)=>{!r.value.childrenSAgeMin&&!r.value.childrenSAgeMax&&t("请输入正确的年龄")}},supplierId:{required:!0,message:"请选择供应商"},allTimeArr:{required:!0,message:"请选择发团日期"}},{data:b}=se(async()=>{const{err:o,res:t}=await le(()=>ye.getTouristRoutesDetail({id:F.query.id??"",mark:"5"}));return o?{}:(K(t==null?void 0:t.data),t==null?void 0:t.data)},{departType:"",ass:"",regionList:[],travelTypeList:[],supplierList:[],routeTypeList:[]}),K=({travelRoute:o,priceList:t,routeTripList:y,validDateList:u,regionList:i,specialPriceList:L,routePriceTemList:p,attachList:c,visibleDepart:V})=>{const f=o.adultAge.split("-"),E=o.elderlyAge.split("-"),M=o.childAge.split("-");r.value={routeName:o.routeName,travelType:o.travelType,routeType:o.routeType,groupType:o.groupType,isBefore:o.isBefore,beforeDays:o.beforeDays,travelDays:o.travelDays,arrival:o.arrival,supplierId:o.arrival,isReturnPoint:o.isReturnPoint,isSubstrPoint:o.isSubstrPoint,addRebate:o.addRebate,rebate:o.rebate,deposit:o.deposit,adultAgeMin:f[0]*1,adultAgeMax:f[1]*1,ageOfTheElderlyMin:E[0]*1,ageOfTheElderlyMax:E[1]*1,childrenSAgeMin:M[0]*1,childrenSAgeMax:M[1]*1,idType:o.idtype.split(","),vehicle:o.vehicle.split(","),allTimeArr:u.map(m=>fe(m)),areaList:i.map(m=>m.provinceCode),routePrice:t[0]},v.value={other:{routeFeature:o.routeFeature,costIncludes:o.costIncludes,costExcludes:o.costExcludes,selfExpense:o.selfExpense,reminder:o.reminder,visaNotice:o.visaNotice,needingMsg:o.needingMsg,reception:o.reception,totalInfo1:o.totalInfo1,remark:o.remark},routeTripList:y.map(m=>({...m,imgList:m.pictureList.map(T=>({name:T.attName,url:T.attPath,status:"done",uid:T.id,attSize:T.attSize}))})),attachList:c.map(m=>({name:m.attName,url:m.attPath,status:"done",uid:m.id,attSize:m.attSize})),businessDepartList:V.split(",")},q.value=L,w.value=p},R=o=>{P.value=o;const t=q.value.find(u=>u.validDate===o),y=w.value.find(u=>u.validDate===o);_.value.setFormData({...t}),j.value.setFormData({...y})},G=o=>{r.value.travelType=o,r.value.routeType="",r.value.arrival=""},S=o=>{var t;r.value.routeType=o,r.value.arrival=((t=k.value.find(y=>y.lineId===o))==null?void 0:t.lineDesc)??""};return(o,t)=>{const y=n("a-input"),u=n("a-form-item"),i=n("a-grid-item"),L=n("a-select"),p=n("a-input-number"),c=n("a-radio"),V=n("a-radio-group"),f=n("a-checkbox"),E=n("a-checkbox-group"),M=n("a-input-group"),m=n("a-grid"),T=n("a-card"),ae=n("a-tag"),H=n("a-typography-title"),te=n("a-form"),X=n("a-button"),de=n("a-space");return g(),x(ve,null,{default:l(()=>[e(te,{ref_key:"formRef",ref:A,"label-align":"left",size:"large",layout:"vertical","auto-label-width":"","scroll-to-first-error":"",model:a(r),rules:$},{default:l(()=>[e(T,{title:"路由线路时间添加",bordered:!1,class:"general-card"},{default:l(()=>[e(m,{cols:3,"col-gap":12},{default:l(()=>[e(i,null,{default:l(()=>[e(u,{label:"线路名称:",field:"routeName",required:""},{default:l(()=>[e(y,{modelValue:a(r).routeName,"onUpdate:modelValue":t[0]||(t[0]=d=>a(r).routeName=d),modelModifiers:{trim:!0},disabled:!0,placeholder:"请输入线路名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"旅行类型:",field:"travelType",required:""},{default:l(()=>[e(L,{"model-value":a(r).travelType,options:a(b).travelTypeList,disabled:!0,"field-names":{label:"detailName",value:"lineVer"},placeholder:"请输入旅行类型",onChange:G},null,8,["model-value","options"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"线路类型:",field:"routeType",required:""},{default:l(()=>[e(L,{"model-value":a(r).routeType,options:k.value,disabled:!0,"field-names":{label:"linename",value:"lineId"},placeholder:"请选择线路类型",onChange:S},null,8,["model-value","options"])]),_:1})]),_:1}),a(r).travelType==="C00001"?(g(),x(i,{key:0},{default:l(()=>[e(u,{label:"押金:",field:"deposit",required:""},{default:l(()=>[e(p,{modelValue:a(r).deposit,"onUpdate:modelValue":t[1]||(t[1]=d=>a(r).deposit=d),modelModifiers:{trim:!0},disabled:!0,formatter:d=>a(I)(d,""),parser:d=>d.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入押金"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1})):N("",!0),e(i,null,{default:l(()=>[e(u,{label:"成团类别:",field:"groupType",required:""},{default:l(()=>[e(V,{modelValue:a(r).groupType,"onUpdate:modelValue":t[2]||(t[2]=d=>a(r).groupType=d),disabled:!0},{default:l(()=>[e(c,{value:"1"},{default:l(()=>[s("单团")]),_:1}),e(c,{value:"2"},{default:l(()=>[s("散客")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(b).departType!=="2"?(g(),x(i,{key:1},{default:l(()=>[e(u,{label:"是否提前报名:",field:"isBefore",required:""},{default:l(()=>[e(V,{modelValue:a(r).isBefore,"onUpdate:modelValue":t[3]||(t[3]=d=>a(r).isBefore=d),disabled:!0},{default:l(()=>[e(c,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(c,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):N("",!0),e(i,null,{default:l(()=>[e(u,{label:"提前报名天数:",field:"beforeDays",required:""},{default:l(()=>[e(p,{modelValue:a(r).beforeDays,"onUpdate:modelValue":t[4]||(t[4]=d=>a(r).beforeDays=d),modelModifiers:{trim:!0},disabled:!0,formatter:d=>a(I)(d,""),parser:d=>d.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入提前报名天数"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"支持证件:",field:"idType",required:""},{default:l(()=>[e(E,{modelValue:a(r).idType,"onUpdate:modelValue":t[5]||(t[5]=d=>a(r).idType=d),disabled:!0},{default:l(()=>[e(f,{value:"1"},{default:l(()=>[s("身份证")]),_:1}),e(f,{value:"2"},{default:l(()=>[s("户口本")]),_:1}),e(f,{value:"3"},{default:l(()=>[s("护照")]),_:1}),e(f,{value:"4"},{default:l(()=>[s("驾驶证")]),_:1}),e(f,{value:"5"},{default:l(()=>[s("暂住证")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"交通工具:",field:"vehicle",required:""},{default:l(()=>[e(E,{modelValue:a(r).vehicle,"onUpdate:modelValue":t[6]||(t[6]=d=>a(r).vehicle=d),disabled:!0},{default:l(()=>[e(f,{value:"1"},{default:l(()=>[s("飞机")]),_:1}),e(f,{value:"2"},{default:l(()=>[s("火车")]),_:1}),e(f,{value:"3"},{default:l(()=>[s("大巴")]),_:1}),e(f,{value:"4"},{default:l(()=>[s("轮船")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"天数:",field:"travelDays",required:""},{default:l(()=>[e(p,{modelValue:a(r).travelDays,"onUpdate:modelValue":t[7]||(t[7]=d=>a(r).travelDays=d),disabled:!0,formatter:d=>a(I)(d,""),parser:d=>d.replace(/,/g,""),precision:0,"hide-button":"",placeholder:"请输入天数"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"成人价年龄:",field:"adultAge",required:""},{default:l(()=>[e(M,{class:"flex1"},{default:l(()=>[e(p,{modelValue:a(r).adultAgeMin,"onUpdate:modelValue":t[8]||(t[8]=d=>a(r).adultAgeMin=d),disabled:!0,min:0,placeholder:"最小年龄"},null,8,["modelValue"]),xe,e(p,{modelValue:a(r).adultAgeMax,"onUpdate:modelValue":t[9]||(t[9]=d=>a(r).adultAgeMax=d),disabled:!0,min:0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"老人价年龄:",field:"ageOfTheElderly",required:""},{default:l(()=>[e(M,{class:"flex1"},{default:l(()=>[e(p,{modelValue:a(r).ageOfTheElderlyMin,"onUpdate:modelValue":t[10]||(t[10]=d=>a(r).ageOfTheElderlyMin=d),max:105,disabled:!0,min:0,placeholder:"最小年龄"},null,8,["modelValue"]),he,e(p,{modelValue:a(r).ageOfTheElderlyMax,"onUpdate:modelValue":t[11]||(t[11]=d=>a(r).ageOfTheElderlyMax=d),max:105,disabled:!0,min:0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"儿童价年龄:",field:"childrenSAge"},{default:l(()=>[e(M,{class:"flex1"},{default:l(()=>[e(p,{modelValue:a(r).childrenSAgeMin,"onUpdate:modelValue":t[12]||(t[12]=d=>a(r).childrenSAgeMin=d),min:0,disabled:!0,placeholder:"最小年龄"},null,8,["modelValue"]),qe,e(p,{modelValue:a(r).childrenSAgeMax,"onUpdate:modelValue":t[13]||(t[13]=d=>a(r).childrenSAgeMax=d),min:0,disabled:!0,placeholder:"最大年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"目的地:",field:"arrival"},{default:l(()=>[e(y,{modelValue:a(r).arrival,"onUpdate:modelValue":t[14]||(t[14]=d=>a(r).arrival=d),modelModifiers:{trim:!0},readonly:"",disabled:!0,placeholder:"请输入目的地"},null,8,["modelValue"])]),_:1})]),_:1}),a(b).ass==="1"?(g(),J(Q,{key:2},[e(i,null,{default:l(()=>[e(u,{label:"外交供应商:",field:"supplierId"},{default:l(()=>[e(L,{modelValue:a(r).supplierId,"onUpdate:modelValue":t[15]||(t[15]=d=>a(r).supplierId=d),options:a(b).supplierList,disabled:!0,"field-names":{label:"supName",value:"id"},placeholder:"请选择辅助外交供应商"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"是否供应商返点:",field:"isReturnPoint",required:""},{default:l(()=>[e(V,{modelValue:a(r).isReturnPoint,"onUpdate:modelValue":t[16]||(t[16]=d=>a(r).isReturnPoint=d),disabled:!0},{default:l(()=>[e(c,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(c,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"是否营业部扣点:",field:"isSubstrPoint",required:""},{default:l(()=>[e(V,{modelValue:a(r).isSubstrPoint,"onUpdate:modelValue":t[17]||(t[17]=d=>a(r).isSubstrPoint=d),disabled:!0},{default:l(()=>[e(c,{value:"1"},{default:l(()=>[s("是")]),_:1}),e(c,{value:"0"},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"供应商返点(%):",field:"addRebate",required:""},{default:l(()=>[e(p,{modelValue:a(r).addRebate,"onUpdate:modelValue":t[18]||(t[18]=d=>a(r).addRebate=d),modelModifiers:{trim:!0},formatter:d=>a(I)(d,""),parser:d=>d.replace(/,/g,""),precision:2,disabled:!0,"hide-button":"",placeholder:"空默认为不扣供应商点"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(u,{label:"营业部扣点(%):",required:""},{default:l(()=>[e(p,{modelValue:a(r).rebate,"onUpdate:modelValue":t[19]||(t[19]=d=>a(r).rebate=d),modelModifiers:{trim:!0},formatter:d=>a(I)(d,""),parser:d=>d.replace(/,/g,""),precision:2,disabled:!0,"hide-button":"",placeholder:"空默认为不扣营业部点"},null,8,["modelValue","formatter","parser"])]),_:1})]),_:1})],64)):N("",!0)]),_:1})]),_:1}),e(T,{title:"发团日期选择",bordered:!1,class:"general-card margin-top"},{default:l(()=>[e(m,{cols:4,"col-gap":20},{default:l(()=>[e(i,{span:4},{default:l(()=>[e(u,{field:"allTimeArr","hide-label":"","hide-asterisk":""},{default:l(()=>[e(V,{modelValue:P.value,"onUpdate:modelValue":t[20]||(t[20]=d=>P.value=d),onChange:R},{default:l(()=>[(g(!0),J(Q,null,ne(a(r).allTimeArr,d=>(g(),x(c,{key:d,value:d,style:{"margin-bottom":"10px"}},{default:l(()=>[e(ae,{size:"large"},{default:l(()=>[s(ce(a(_e)(d)),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:2},{default:l(()=>[e(H,{heading:5},{default:l(()=>[s("调价前")]),_:1}),e(W,{ref_key:"routePriceRef",ref:_,disabled:"","default-data":a(r).routePrice},null,8,["default-data"])]),_:1}),e(i,{span:2},{default:l(()=>[e(H,{heading:5},{default:l(()=>[s("调价后")]),_:1}),e(W,{ref_key:"newRoutePriceRef",ref:j,disabled:"","default-data":a(r).routePrice},null,8,["default-data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),Ae,C("div",Se,[e(de,null,{default:l(()=>[e(X,{type:"primary",onClick:t[21]||(t[21]=d=>a(D)("ZsExamineTourism"))},{default:l(()=>[s("审核")]),_:1}),e(X,{onClick:t[22]||(t[22]=()=>a(O)())},{default:l(()=>[s("返回")]),_:1})]),_:1})]),a(Z)==="ZsExamineTourism"?(g(),x(Te,{key:0,data:{id:o.$route.query.id},onClose:t[23]||(t[23]=()=>a(D)("")),onSuccess:a(O)},null,8,["data","onSuccess"])):N("",!0)]),_:1})}}});const Ue=ge(De,[["__scopeId","data-v-a55cb5f5"]]);export{Ue as default};

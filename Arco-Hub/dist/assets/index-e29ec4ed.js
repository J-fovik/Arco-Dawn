import{a as H,n as c,p as k,T as J,d as v,q as Q,s as W,v as X,M as Z,x as ee,y as te,r as d,o as p,e as ae,g as a,w as t,c as e,z as b,l as f,i as g,k as h,A as ne,S as T}from"./index-8a2cb146.js";import{D as oe}from"./options-1badfbbd.js";import{f as le}from"./options-aafac76d.js";import{_ as se}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import"./index-2bbe694f.js";const re=()=>{const{getDictionaryItem:M}=H();return[{title:"账号",dataIndex:"userAccount",show:!0,align:"center",render:({record:o})=>c(o.userAccount)},{title:"姓名",dataIndex:"username",show:!0,align:"center",render:({record:o})=>c(o.username)},{title:"组织",dataIndex:"departName",show:!0,align:"center",render:({record:o})=>c(o.departName)},{title:"用户角色",dataIndex:"roleName",show:!0,align:"center",render:({record:o})=>c(o.roleName)},{title:"联系方式",dataIndex:"mobile",show:!0,align:"center",render:({record:o})=>c(o.mobile)},{title:"状态",dataIndex:"state",show:!0,align:"center",render:({record:o})=>{const i=M("supState",o.state);return k("span",{style:`color: ${i.detailCode==="0"?"blue":"red"}`},c(i.detailName))}},{title:"部门类型",dataIndex:"departType",show:!0,align:"center",render:({record:o})=>{const i=le(oe,o.departType);return k(J,{color:i==null?void 0:i.color},{default:()=>c(i==null?void 0:i.label)})}},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},de=v({name:"SystemUserManage"}),ge=v({...de,setup(M){const{vAuthority:o}=Q(),{warningModal:i}=ne(),{form:u,resetForm:I}=W(()=>({userAccount:"",username:"",departName:"",roleCode:""}),()=>N()),{columnsData:U,visibleColumnsData:x,tableBaseOptions:l,resetData:N,extendTableList:z,changeTableColumn:D,changeTableSize:V}=X(re(),()=>w()),{data:$}=Z(async()=>{const{res:r}=await h(()=>T.getRoleList({pagingOrNot:"0"}));return(r==null?void 0:r.data.roleList)??[]}),{data:A,loading:K,initData:w}=ee(async()=>{const{res:r,err:n}=await h(()=>T.getUserList({...u.value,currentPage:l.pagination.current,pageSize:l.pagination.pageSize,pagingOrNot:"1"}));return n?[]:(l.pagination.total=r.data.totalCount,z(r==null?void 0:r.data.userList))}),S=r=>{i(`确定操作选中的${l.selectedKeys.length}数据吗？`,async n=>{const{res:_}=await h(()=>T[r]({idList:l.selectedKeys}));n(!0),_&&(l.selectedKeys=[],w())})};return te(w),(r,n)=>{const _=d("a-input"),y=d("a-form-item"),C=d("a-grid-item"),L=d("a-select"),R=d("a-grid"),O=d("a-form"),E=d("icon-plus"),m=d("a-button"),P=d("icon-close"),B=d("icon-delete"),q=d("icon-loop"),F=d("a-space"),Y=d("a-button-group"),j=d("a-table");return p(),ae("div",null,[a(se,{"table-columns":e(U),"table-size":e(l).size,onResetSearch:e(I),onSearch:e(N),onChangeTableSize:e(V),onChangeTableColumn:e(D)},{form:t(()=>[a(O,{model:e(u),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[a(R,{cols:4,"col-gap":12},{default:t(()=>[a(C,null,{default:t(()=>[a(y,{label:"账号:"},{default:t(()=>[a(_,{modelValue:e(u).userAccount,"onUpdate:modelValue":n[0]||(n[0]=s=>e(u).userAccount=s),modelModifiers:{trim:!0},placeholder:"请输入登录账号"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(y,{label:"姓名:"},{default:t(()=>[a(_,{modelValue:e(u).username,"onUpdate:modelValue":n[1]||(n[1]=s=>e(u).username=s),modelModifiers:{trim:!0},placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(y,{label:"组织:"},{default:t(()=>[a(_,{modelValue:e(u).departName,"onUpdate:modelValue":n[2]||(n[2]=s=>e(u).departName=s),placeholder:"请选择组织"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(y,{label:"角色:"},{default:t(()=>[a(L,{modelValue:e(u).roleCode,"onUpdate:modelValue":n[3]||(n[3]=s=>e(u).roleCode=s),"field-names":{label:"rolename",value:"roleCode"},options:e($),placeholder:"请选择角色"},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:t(()=>[a(F,null,{default:t(()=>[b((p(),f(m,{type:"outline",onClick:n[4]||(n[4]=s=>r.$router.push("/system/userManage/operate"))},{icon:t(()=>[a(E)]),default:t(()=>[g(" 新增 ")]),_:1})),[[e(o),"SystemUserManageAdd"]]),b((p(),f(m,{type:"outline",status:"danger",disabled:!e(l).selectedKeys.length,onClick:n[5]||(n[5]=s=>S("batchDeleteUser"))},{icon:t(()=>[a(P)]),default:t(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[e(o),"SystemUserManageDelete"]]),b((p(),f(m,{type:"outline",status:"danger",disabled:!e(l).selectedKeys.length,onClick:n[6]||(n[6]=s=>S("batchLogoutUser"))},{icon:t(()=>[a(B)]),default:t(()=>[g(" 注销 ")]),_:1},8,["disabled"])),[[e(o),"SystemUserManageLogout"]]),b((p(),f(m,{type:"outline",status:"warning",disabled:!e(l).selectedKeys.length,onClick:n[7]||(n[7]=s=>S("batchResetPassword"))},{icon:t(()=>[a(q)]),default:t(()=>[g(" 密码重置 ")]),_:1},8,["disabled"])),[[e(o),"SystemUserManageReset"]])]),_:1})]),table:t(()=>[a(j,{"selected-keys":e(l).selectedKeys,"onUpdate:selectedKeys":n[8]||(n[8]=s=>e(l).selectedKeys=s),class:"zs-table","row-key":"userId",data:e(A),"row-selection":e(l).rowSelection,bordered:e(l).bordered,pagination:e(l).pagination,size:e(l).size,columns:e(x),stripe:e(l).stripe,loading:e(K)},{operate:t(({record:s})=>[a(Y,null,{default:t(()=>[a(m,{type:"text",status:"success",onClick:G=>r.$router.push(`/system/userManage/operate?id=${s.userId}&isReadOnly=true`)},{default:t(()=>[g("详情")]),_:2},1032,["onClick"]),b((p(),f(m,{type:"text",onClick:G=>r.$router.push(`/system/userManage/operate?id=${s.userId}`)},{default:t(()=>[g("编辑")]),_:2},1032,["onClick"])),[[e(o),"SystemUserManageEdit"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{ge as default};

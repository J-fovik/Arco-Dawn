import{n as p,p as m,O as _,a as te,P as V,d as w,u as M,m as P,v as G,b as O,r as u,o as f,l as E,w as r,g as n,i as R,c as e,k as A,q as ae,E as ne,s as re,y as oe,e as se,f as Z,t as le,z as ie,h as ue,S as de}from"./index-8a2cb146.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{O as q}from"./order-70291d37.js";import"./index-2bbe694f.js";const ce=()=>[{title:"团号",slotName:"groupId",show:!0,ellipsis:!0,tooltip:!0,align:"center"},{title:"供应商",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:o})=>p(o.supName)},{title:"订单同行总费用",dataIndex:"supsigCost",show:!0,align:"right",render:({record:o})=>m("span",{class:"text-red text-price"},_(`${o.supsigCost??0}`))},{title:"供应商结算费用",dataIndex:"moneyTotal",show:!0,align:"right",render:({record:o})=>m("span",{class:"text-red text-price"},_(`${o.moneyTotal??0}`))},{title:"已结算金额",dataIndex:"totalSettledAmount",show:!0,align:"right",render:({record:o})=>m("span",{class:"text-red text-price"},_(`${o.totalSettledAmount??0}`))},{title:"本次申请结算金额",dataIndex:"money",show:!0,align:"right",render:({record:o})=>m("span",{class:"text-red text-price"},_(`${o.money??0}`))},{title:"申请时间",dataIndex:"createTime",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:o})=>p(o.createTime)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],me=()=>{const{getDictionaryItem:o}=te();return[{title:"团号",dataIndex:"groupId",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.groupId)},{title:"供应商",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.supName)},{title:"营业部名称",dataIndex:"departName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.departName)},{title:"线路名称",dataIndex:"routeName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.routeName)},{title:"人数",dataIndex:"totalNumber",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.totalNumber)},{title:"订单同行费",dataIndex:"settleTotal",show:!0,align:"right",width:120,render:({record:t})=>m("span",{class:"text-red text-price"},_(V(t.settleTotal)))},{title:"扣点（%）",dataIndex:"ratio",show:!0,align:"right",render:({record:t})=>m("span",{class:"text-green"},p(t.ratio+"%"))},{title:"供应商金额",dataIndex:"setMoney",show:!0,align:"right",render:({record:t})=>m("span",{class:"text-red text-price"},_(V(t.setMoney)))},{title:"已结算金额",dataIndex:"setValue",show:!0,align:"right",render:({record:t})=>m("span",{class:"text-red text-price"},_(V(t.setValue)))},{title:"结算状态",dataIndex:"settleType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(o("signupSettleType",t.settleType).detailName)},{title:"剩余天数",dataIndex:"setdays",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.setdays)},{title:"创建时间",dataIndex:"createTimeStr",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(t.createTimeStr)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ge=w({name:"ZsGroupOrder"}),_e=w({...ge,props:{data:{default:()=>({})}},emits:["close"],setup(o,{emit:t}){const I=o,y=t,S=M(),x=P(),{visibleColumnsData:d,tableBaseOptions:c}=G(me(),()=>N()),{data:C,initData:N,loading:T}=O(async()=>{const{res:a,err:g}=await A(()=>q.getFinanceList({groupIdList:I.data.groupNo.split(","),currentPage:c.pagination.current,pageSize:c.pagination.pageSize,pagingOrNot:"1"}));return g?[]:(c.pagination.total=a.data.totalCount,a==null?void 0:a.data.dataList)}),v=a=>{x.push(`/order/financeManage/operate/?groupId=${a.groupId}&name=${S.name}`)};return(a,g)=>{const h=u("a-button"),L=u("a-table"),$=u("a-modal");return f(),E($,{width:"1200px","unmount-on-close":"",visible:"",title:"订单列表","mask-closable":!1,onCancel:g[0]||(g[0]=b=>y("close")),footer:!1,"render-to-body":!1},{default:r(()=>[n(L,{class:"zs-table","row-key":"id",data:e(C),bordered:e(c).bordered,size:e(c).size,columns:e(d),stripe:e(c).stripe,loading:e(T)},{operate:r(({record:b})=>[n(h,{type:"text",onClick:B=>v(b)},{default:r(()=>[R("查看")]),_:2},1032,["onClick"])]),_:1},8,["data","bordered","size","columns","stripe","loading"])]),_:1})}}}),xe=Z("span",{class:"mx-3"},"-",-1),he=["onClick"],be=w({name:"OrderFinanceSettlementExamine"}),Se=w({...be,setup(o){const{vAuthority:t}=ae(),I=P(),y=M(),[S,x]=ne(""),{form:d,resetForm:c}=re(()=>({groupId:"",supId:"",startDate:"",endDate:""}),()=>g()),{data:C}=O(async()=>{const{res:i,err:s}=await A(()=>de.getSupplierList({pagingOrNot:"0"}));return s?[]:i==null?void 0:i.data.supplierList},[]),{selectRow:N,columnsData:T,visibleColumnsData:v,tableBaseOptions:a,resetData:g,setSelectRow:h,extendTableList:L,changeTableColumn:$,changeTableSize:b}=G(ce(),()=>k()),{data:B,loading:Y,initData:k}=O(async()=>{const{res:i,err:s}=await A(()=>q.getFinanceSettlementExamineList({...d.value,currentPage:a.pagination.current,pageSize:a.pagination.pageSize,pagingOrNot:"1"}));return s?[]:(a.pagination.total=i.data.totalCount,i==null?void 0:i.data.settleRecordApplyBatchList)}),j=i=>{i.groupNo.indexOf(",")>-1?h(i,()=>x("ZsGroupOrder")):I.push(`/order/financeManage/operate/?groupId=${i.groupNo}&name=${y.name}`)};return oe(k),(i,s)=>{const H=u("a-input"),z=u("a-form-item"),D=u("a-grid-item"),J=u("a-select"),F=u("a-date-picker"),Q=u("a-grid"),W=u("a-form"),U=u("a-button"),X=u("a-button-group"),ee=u("a-table");return f(),se("div",null,[n(pe,{"table-columns":e(T),"table-size":e(a).size,onResetSearch:e(c),onSearch:e(g),onChangeTableSize:e(b),onChangeTableColumn:e($)},{form:r(()=>[n(W,{model:e(d),"label-align":"left",size:"large","auto-label-width":""},{default:r(()=>[n(Q,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:r(()=>[n(D,null,{default:r(()=>[n(z,{field:"groupNo",label:"团号:"},{default:r(()=>[n(H,{modelValue:e(d).groupId,"onUpdate:modelValue":s[0]||(s[0]=l=>e(d).groupId=l),placeholder:"请输入团号"},null,8,["modelValue"])]),_:1})]),_:1}),n(D,null,{default:r(()=>[n(z,{label:"供应商名称:"},{default:r(()=>[n(J,{modelValue:e(d).supId,"onUpdate:modelValue":s[1]||(s[1]=l=>e(d).supId=l),options:e(C),"field-names":{label:"supName",value:"id"},"virtual-list-props":{height:200},"allow-search":"",placeholder:"请选择供应商名称"},null,8,["modelValue","options"])]),_:1})]),_:1}),n(D,null,{default:r(()=>[n(z,{label:"出团日期:"},{default:r(()=>[n(F,{modelValue:e(d).startDate,"onUpdate:modelValue":s[2]||(s[2]=l=>e(d).startDate=l),class:"flex1",placeholder:"出团日期(开始)"},null,8,["modelValue"]),xe,n(F,{modelValue:e(d).endDate,"onUpdate:modelValue":s[3]||(s[3]=l=>e(d).endDate=l),class:"flex1",placeholder:"出团日期(结束)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),table:r(()=>[n(ee,{"selected-keys":e(a).selectedKeys,"onUpdate:selectedKeys":s[4]||(s[4]=l=>e(a).selectedKeys=l),class:"zs-table","row-key":"id",data:e(B),"row-selection":e(a).rowSelection,bordered:e(a).bordered,pagination:e(a).pagination,size:e(a).size,columns:e(v),stripe:e(a).stripe,loading:e(Y)},{groupId:r(({record:l})=>[Z("span",{class:"text-link",onClick:K=>j(l)},le(l.groupNo),9,he)]),operate:r(({record:l})=>[n(X,null,{default:r(()=>[n(U,{type:"text",status:"success",onClick:K=>i.$router.push(`/order/financeSettlementExamine/operate?id=${l.id}`)},{default:r(()=>[R("详情")]),_:2},1032,["onClick"]),ie((f(),E(U,{type:"text",onClick:K=>i.$router.push(`/order/financeSettlementExamine/operate?id=${l.id}&isExamine=true`)},{default:r(()=>[R("审核")]),_:2},1032,["onClick"])),[[e(t),"OrderFinanceSettlementExamineExamine"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(S)==="ZsGroupOrder"?(f(),E(_e,{key:0,data:e(N),onClose:s[5]||(s[5]=l=>e(h)({},()=>e(x)(""))),onSuccess:e(k)},null,8,["data","onSuccess"])):ue("",!0)])}}});export{Se as default};

import{a as Y,n as m,d as x,q as j,s as H,v as J,M as Q,x as W,y as X,r as i,o as f,e as Z,g as n,w as a,c as e,z as S,l as h,i as y,k as C,A as ee,S as te}from"./index-8a2cb146.js";import{C as M}from"./options-c598719d.js";import{f as ae}from"./options-aafac76d.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{B as w}from"./business-b0ce0e8a.js";import"./index-2bbe694f.js";const oe=()=>{const{getDictionaryItem:N}=Y();return[{title:"合同编号",dataIndex:"contractNumber",show:!0,align:"center",render:({record:l})=>m(l.contractNumber)},{title:"营业部名称",dataIndex:"departName",show:!0,align:"center",render:({record:l})=>m(l.departName)},{title:"领用人姓名",dataIndex:"employeeName",show:!0,align:"center",render:({record:l})=>m(l.employeeName)},{title:"旅行类别",dataIndex:"contType",show:!0,align:"center",render:({record:l})=>m(N("travelType",l.contType).detailName)},{title:"合同状态",dataIndex:"state",show:!0,align:"center",render:({record:l})=>{var u;return m((u=ae(M,l.state))==null?void 0:u.label)}},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},le=x({name:"BusinessPageContractManager"}),me=x({...le,setup(N){const{vAuthority:l}=j(),{warningModal:u}=ee(),{form:c,resetForm:z}=H(()=>({contractNumber:"",departName:"",state:"",departNo:""}),()=>T()),{columnsData:V,visibleColumnsData:v,tableBaseOptions:o,resetData:T,extendTableList:k,changeTableColumn:D,changeTableSize:I}=J(oe(),()=>g());Q(async()=>{const{err:s,res:t}=await C(()=>te.getDepartmentList({departType:"1"}));return s?[]:t==null?void 0:t.data},[]);const B=(s,t)=>{u("确定操作数据吗？",async p=>{const{res:d}=await C(()=>w.delRecipient({idList:s=="deleteSelect"?o.selectedKeys:[t]}),{successMsg:"操作成功"});p(!0),d&&(o.selectedKeys=[],g())})},A=()=>{u(`确定操作选中的${o.selectedKeys.length}数据吗？`,async s=>{const{res:t}=await C(()=>w.batchArchiving({idList:o.selectedKeys}),{successMsg:"操作成功"});s(!0),t&&(o.selectedKeys=[],g())})},{data:K,loading:P,initData:g}=W(async()=>{const{res:s,err:t}=await C(()=>w.getPaperContractList({...c.value,currentPage:o.pagination.current,pageSize:o.pagination.pageSize}),{successMsg:""});return t?[]:(o.pagination.total=s.data.totalCount,k(s==null?void 0:s.data.contractList))});return X(g),(s,t)=>{const p=i("a-input"),d=i("a-form-item"),_=i("a-grid-item"),U=i("a-select"),$=i("a-grid"),R=i("a-form"),L=i("icon-plus"),b=i("a-button"),O=i("icon-close"),F=i("icon-import"),E=i("a-space"),q=i("a-button-group"),G=i("a-table");return f(),Z("div",null,[n(ne,{"table-columns":e(V),"table-size":e(o).size,onResetSearch:e(z),onSearch:e(T),onChangeTableSize:e(I),onChangeTableColumn:e(D)},{form:a(({})=>[n(R,{model:e(c),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[n($,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[n(_,null,{default:a(()=>[n(d,{label:"合同编号:"},{default:a(()=>[n(p,{modelValue:e(c).contractNumber,"onUpdate:modelValue":t[0]||(t[0]=r=>e(c).contractNumber=r),placeholder:"请输入合同编号"},null,8,["modelValue"])]),_:1})]),_:1}),n(_,null,{default:a(()=>[n(d,{label:"部门名称:"},{default:a(()=>[n(p,{modelValue:e(c).departName,"onUpdate:modelValue":t[1]||(t[1]=r=>e(c).departName=r),modelModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),n(_,null,{default:a(()=>[n(d,{label:"部门代码:"},{default:a(()=>[n(p,{modelValue:e(c).departNo,"onUpdate:modelValue":t[2]||(t[2]=r=>e(c).departNo=r),modelModifiers:{trim:!0},placeholder:"请输入部门代码"},null,8,["modelValue"])]),_:1})]),_:1}),n(_,null,{default:a(()=>[n(d,{label:"合同状态:"},{default:a(()=>[n(U,{modelValue:e(c).state,"onUpdate:modelValue":t[3]||(t[3]=r=>e(c).state=r),placeholder:"请选择合同状态",options:e(M)},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[n(E,null,{default:a(()=>[S((f(),h(b,{type:"outline",onClick:t[4]||(t[4]=r=>s.$router.push("/business/pageContractManager/operate"))},{icon:a(()=>[n(L)]),default:a(()=>[y(" 发放合同 ")]),_:1})),[[e(l),"BusinessPageContractManagerGrantContract"]]),S((f(),h(b,{type:"outline",status:"danger",disabled:!e(o).selectedKeys.length,onClick:t[5]||(t[5]=r=>B("deleteSelect"))},{icon:a(()=>[n(O)]),default:a(()=>[y(" 删除 ")]),_:1},8,["disabled"])),[[e(l),"BusinessPageContractManagerDelete"]]),S((f(),h(b,{type:"outline",status:"warning",disabled:!e(o).selectedKeys.length,onClick:A},{icon:a(()=>[n(F)]),default:a(()=>[y(" 批量归档 ")]),_:1},8,["disabled"])),[[e(l),"BusinessPageContractManagerBatchFile"]])]),_:1})]),table:a(()=>[n(G,{"selected-keys":e(o).selectedKeys,"onUpdate:selectedKeys":t[6]||(t[6]=r=>e(o).selectedKeys=r),class:"zs-table","row-key":"id",data:e(K),"row-selection":e(o).rowSelection,bordered:e(o).bordered,pagination:e(o).pagination,size:e(o).size,columns:e(v),stripe:e(o).stripe,loading:e(P)},{operate:a(({record:r})=>[n(q,null,{default:a(()=>[n(b,{type:"text",status:"success",onClick:se=>s.$router.push(`/business/pageContractManager/operate?id=${r.id}&isReadOnly=true`)},{default:a(()=>[y("详情")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"])])}}});export{me as default};

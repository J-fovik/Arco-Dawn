import{d as z,h as D,i as $,k as Q,E as W,m as k,r as s,o as S,l as N,w as t,a,b as e,p as B,g as X,n as Z,j as ee,c as ae,e as A,q as te}from"./index-d007178a.js";import{f as T,c as le,_ as oe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{f as R,A as L}from"./options-aafac76d.js";import{P as x}from"./province-5d977221.js";import"./index-13860ba0.js";const E=[{label:"不热门",value:"0"},{label:"热门",value:"1"}],M=[{label:"省",value:"1"},{label:"市",value:"2"},{label:"区",value:"3"}],ne=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"行政区划代码",dataIndex:"code",show:!0,align:"center",render:({record:i})=>T(i.code)},{title:"名称",dataIndex:"name",show:!0,align:"center",render:({record:i})=>T(i.name)},{title:"类型",dataIndex:"type",show:!0,align:"center",render:({record:i})=>{var u;return T((u=R(M,i.type))==null?void 0:u.label)}},{title:"上级名称",dataIndex:"pname",show:!0,align:"center",render:({record:i})=>T(i.pname)},{title:"是否热门",dataIndex:"hot",show:!0,align:"center",render:({record:i})=>{var u;return T((u=R(E,i.hot))==null?void 0:u.label)}},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],se=z({name:"zsAddProvincialUrbanCode"}),de=z({...se,props:{data:{default:()=>({})}},emits:["close","success"],setup(i,{emit:u}){const v=i,[w,p]=D(null),{form:l,formRef:V}=$(()=>({...v.data})),P={name:{required:!0,message:"请输入名称"}},I=()=>{V.value.validate(c=>{c||(v.data.id?o("editCityInfo"):o("addCityInfo"))})},o=async c=>{const{err:n}=await k(()=>x[c](l.value),{before:()=>p("okLoading"),after:()=>p(null)});n||(u("success"),u("close"))};let C=Q([]);W(()=>{h()});const O=c=>{l.value.type=c,C.value=[],l.value.pid="",h()},h=async()=>{const{res:c,err:n}=await k(()=>x.getPidList({type:l.value.type}));if(n)return[];C.value=c.data.map(_=>({label:_.name,value:_.pid}))};return(c,n)=>{const _=s("a-input"),f=s("a-form-item"),g=s("a-grid-item"),b=s("a-select"),m=s("a-grid"),r=s("a-form"),U=s("a-modal");return S(),N(U,{title:e(le)("城市信息",!!v.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"50vw","align-center":!1,"mask-closable":!1,"ok-loading":e(w)==="okLoading",onCancel:n[5]||(n[5]=d=>u("close")),onOk:I},{default:t(()=>[a(r,{ref_key:"formRef",ref:V,model:e(l),"label-align":"left",size:"large","auto-label-width":"",rules:P},{default:t(()=>[a(m,{cols:2,"col-gap":24},{default:t(()=>[a(g,null,{default:t(()=>[a(f,{field:"name",label:"城市名称:"},{default:t(()=>[a(_,{modelValue:e(l).name,"onUpdate:modelValue":n[0]||(n[0]=d=>e(l).name=d),placeholder:"请输入城市名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:t(()=>[a(f,{field:"code",label:"行政区划代码:"},{default:t(()=>[a(_,{modelValue:e(l).code,"onUpdate:modelValue":n[1]||(n[1]=d=>e(l).code=d),placeholder:"请输入行政区划代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,null,{default:t(()=>[a(f,{label:"类型:"},{default:t(()=>[a(b,{modelValue:e(l).type,"onUpdate:modelValue":n[2]||(n[2]=d=>e(l).type=d),placeholder:"请选择类型","allow-clear":"",onChange:O,options:[...e(L),...e(M).map(d=>({...d,disabled:d.value==e(l).type}))]},null,8,["modelValue","options"])]),_:1})]),_:1}),e(l).type!="1"?(S(),N(g,{key:0},{default:t(()=>[a(f,{field:"pid",label:"上级名称:"},{default:t(()=>[a(b,{modelValue:e(l).pid,"onUpdate:modelValue":n[3]||(n[3]=d=>e(l).pid=d),placeholder:"请选择上级名称","allow-clear":"","allow-search":"",options:e(C)},null,8,["modelValue","options"])]),_:1})]),_:1})):B("",!0),a(g,null,{default:t(()=>[a(f,{label:"是否热门:"},{default:t(()=>[a(b,{modelValue:e(l).hot,"onUpdate:modelValue":n[4]||(n[4]=d=>e(l).hot=d),placeholder:"请选择是否热门","allow-clear":"",options:[...e(L),...e(E)]},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),re=z({name:"ProvinceProvincialUrbanCode"}),fe=z({...re,setup(i){const{warningModal:u}=te(),[v,w]=D(null);X();const{form:p,resetForm:l}=$(()=>({name:""}),()=>C()),{selectRow:V,columnsData:P,visibleColumnsData:I,tableBaseOptions:o,resetData:C,extendTableList:O,setSelectRow:h,changeTableColumn:c,changeTableSize:n}=Z(ne(),()=>b()),_=()=>{u(`确定删除选中的${o.selectedKeys.length}数据吗？`,async m=>{const{err:r}=await k(()=>x.deleteCityInfo({ids:o.selectedKeys}),{successMsg:"操作成功"});r||(m(!0),o.selectedKeys=[],b())})},{data:f,loading:g,initData:b}=ee(async()=>{const{res:m,err:r}=await k(()=>x.getCityInfoList({...p.value,currentPage:o.pagination.current,pageSize:o.pagination.pageSize,pagingOrNot:"1"}));return r?[]:(o.pagination.total=m.data.totalCount,O(m==null?void 0:m.data.resultList))});return(m,r)=>{const U=s("a-input"),d=s("a-form-item"),q=s("a-grid-item"),Y=s("a-grid"),F=s("a-form"),j=s("icon-plus"),K=s("a-button"),H=s("icon-close"),G=s("a-space"),J=s("a-table");return S(),ae("div",null,[a(oe,{"table-columns":e(P),"table-size":e(o).size,onResetSearch:e(l),onSearch:e(C),onChangeTableSize:e(n),onChangeTableColumn:e(c)},{form:t(()=>[a(F,{model:e(p),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[a(Y,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:t(()=>[a(q,null,{default:t(()=>[a(d,{label:"城市名称:"},{default:t(()=>[a(U,{modelValue:e(p).name,"onUpdate:modelValue":r[0]||(r[0]=y=>e(p).name=y),placeholder:"请输入城市名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:t(()=>[a(G,null,{default:t(()=>[a(K,{type:"outline",onClick:r[1]||(r[1]=y=>e(w)("zsAddProvincialUrbanCode"))},{icon:t(()=>[a(j)]),default:t(()=>[A(" 新增 ")]),_:1}),a(K,{type:"outline",status:"danger",disabled:!e(o).selectedKeys.length,loading:e(v)==="删除",onClick:_},{icon:t(()=>[a(H)]),default:t(()=>[A(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:t(()=>[a(J,{"selected-keys":e(o).selectedKeys,"onUpdate:selectedKeys":r[2]||(r[2]=y=>e(o).selectedKeys=y),class:"zs-table","row-key":"id",data:e(f),"row-selection":e(o).rowSelection,bordered:e(o).bordered,pagination:e(o).pagination,size:e(o).size,columns:e(I),stripe:e(o).stripe,loading:e(g)},{operate:t(({record:y})=>[a(K,{type:"text",onClick:ie=>e(h)(y,()=>e(w)("zsAddProvincialUrbanCode"))},{default:t(()=>[A("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(v)==="zsAddProvincialUrbanCode"?(S(),N(de,{key:0,data:e(V),onSuccess:e(b),onClose:r[3]||(r[3]=y=>e(h)({},()=>e(w)(null)))},null,8,["data","onSuccess"])):B("",!0)])}}});export{fe as default};

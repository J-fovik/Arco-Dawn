import{d as j,h as $,g as M,i as O,k as H,r as o,o as Z,l as F,w as a,a as t,b as e,e as x,m as z,S as L,n as J,j as Q,c as W,p as X,q as Y}from"./index-d007178a.js";import{A as ee}from"./options-aafac76d.js";import{f as N,c as te,_ as ae}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import"./index-13860ba0.js";const le=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"院校名称",dataIndex:"yxmc",show:!0,align:"center",render:({record:g})=>N(g.yxmc)},{title:"学科名称",dataIndex:"xkmc",show:!0,align:"center",render:({record:g})=>N(g.xkmc)},{title:"排序",dataIndex:"sort",show:!0,align:"center",render:({record:g})=>N(g.sort)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],oe=j({name:"ZsAddThirdPartyRanking"}),ne=j({...oe,props:{data:{default:()=>({})}},emits:["close","success"],setup(g,{emit:h}){const b=g,[v,C]=$(null),p=M(),{form:n,formRef:V}=O(()=>({isZd:"否",isGkjs:"否",...b.data})),K={yxId:{required:!0,message:"请选择院校信息"},xkmc:{required:!0,message:"请选择学科名称"}},A=()=>{V.value.validate(u=>{u||(b.data.id?d("editSchoolSubject"):d("addSchoolSubject"))})},d=async u=>{const{err:l}=await z(()=>L[u](n.value),{before:()=>C("okLoading"),after:()=>C(null)});l||(h("success"),h("close"))},y=H([]),R=async u=>{n.value.yxmc=p.schoolList.filter(r=>r.value==u)[0].label;const{res:l,err:S}=await z(()=>L.getSchoolMajorType({yxId:n.value.yxId}));if(S)return[];const c=l.data.map(r=>({label:r.xkmc,value:r.xkmc?r.xkmc:""}));y.value=c},T=u=>{n.value.xkmc=y.value.filter(l=>l.value==u)[0].label};return(u,l)=>{const S=o("a-select"),c=o("a-form-item"),r=o("a-grid-item"),w=o("a-input"),_=o("a-input-number"),s=o("a-radio"),k=o("a-radio-group"),m=o("a-grid"),I=o("a-form"),D=o("a-modal");return Z(),F(D,{title:e(te)("双一流建设学科",!!b.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"50vw","align-center":!1,"mask-closable":!1,"ok-loading":e(v)==="okLoading",onCancel:l[6]||(l[6]=i=>h("close")),onOk:A},{default:a(()=>[t(I,{ref_key:"formRef",ref:V,model:e(n),"label-align":"left",size:"large","auto-label-width":"",rules:K},{default:a(()=>[t(m,{cols:1,"col-gap":24},{default:a(()=>[t(r,null,{default:a(()=>[t(c,{field:"yxId",label:"院校信息:"},{default:a(()=>[t(S,{modelValue:e(n).yxId,"onUpdate:modelValue":l[0]||(l[0]=i=>e(n).yxId=i),options:e(p).schoolList,"virtual-list-props":{height:200},disabled:!!b.data.id,"allow-search":"","allow-clear":"",placeholder:"请选择院校信息",onChange:R},null,8,["modelValue","options","disabled"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(c,{label:"学科名称:"},{default:a(()=>[t(S,{modelValue:e(n).xkmc,"onUpdate:modelValue":l[1]||(l[1]=i=>e(n).xkmc=i),placeholder:"请选择学科名称","path-mode":"",disabled:!!b.data.id||!e(n).yxId,"allow-search":"","allow-clear":"",options:y.value,onChange:T},null,8,["modelValue","disabled","options"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(c,{field:"lc",label:"轮次:"},{default:a(()=>[t(w,{modelValue:e(n).lc,"onUpdate:modelValue":l[2]||(l[2]=i=>e(n).lc=i),modelModifiers:{trim:!0},placeholder:"请输入轮次"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(c,{field:"sort",label:"排序:"},{default:a(()=>[t(_,{modelValue:e(n).sort,"onUpdate:modelValue":l[3]||(l[3]=i=>e(n).sort=i),placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(c,{field:"isGkjs",label:"公开警示:"},{default:a(()=>[t(k,{modelValue:e(n).isGkjs,"onUpdate:modelValue":l[4]||(l[4]=i=>e(n).isGkjs=i)},{default:a(()=>[t(s,{value:"是"},{default:a(()=>[x("是")]),_:1}),t(s,{value:"否"},{default:a(()=>[x("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(c,{field:"isZd",label:"自定学科:"},{default:a(()=>[t(k,{modelValue:e(n).isZd,"onUpdate:modelValue":l[5]||(l[5]=i=>e(n).isZd=i)},{default:a(()=>[t(s,{value:"是"},{default:a(()=>[x("是")]),_:1}),t(s,{value:"否"},{default:a(()=>[x("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),se=j({name:"SchoolFirstClassSchool"}),me=j({...se,setup(g){const{warningModal:h}=Y(),[b,v]=$(null),C=M(),{form:p,resetForm:n}=O(()=>({yxId:"",xkmc:""}),()=>y()),{selectRow:V,columnsData:K,visibleColumnsData:A,tableBaseOptions:d,resetData:y,extendTableList:R,setSelectRow:T,changeTableColumn:u,changeTableSize:l}=J(le(),()=>w()),S=()=>{h(`确定删除选中的${d.selectedKeys.length}数据吗？`,async _=>{const{err:s}=await z(()=>L.deleteSchoolSubject({ids:d.selectedKeys}),{successMsg:"操作成功"});s||(_(!0),d.selectedKeys=[],w())})},{data:c,loading:r,initData:w}=Q(async()=>{const{res:_,err:s}=await z(()=>L.getSchoolSubjectList({...p.value,currentPage:d.pagination.current,pageSize:d.pagination.pageSize,pagingOrNot:"1"}));if(s)return[];d.pagination.total=_.data.totalCount;const k=_==null?void 0:_.data.resultList.map(m=>(m.sort!==void 0&&m.sort!==null&&(m.sort=Number(m.sort)),m));return R(k)});return(_,s)=>{const k=o("a-select"),m=o("a-form-item"),I=o("a-grid-item"),D=o("a-input"),i=o("a-grid"),B=o("a-form"),P=o("icon-plus"),U=o("a-button"),q=o("icon-close"),G=o("a-space"),E=o("a-table");return Z(),W("div",null,[t(ae,{"table-columns":e(K),"table-size":e(d).size,onResetSearch:e(n),onSearch:e(y),onChangeTableSize:e(l),onChangeTableColumn:e(u)},{form:a(()=>[t(B,{model:e(p),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[t(i,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[t(I,null,{default:a(()=>[t(m,{label:"院校信息:"},{default:a(()=>[t(k,{modelValue:e(p).yxId,"onUpdate:modelValue":s[0]||(s[0]=f=>e(p).yxId=f),"virtual-list-props":{height:200},"allow-search":"","allow-clear":"",options:[...e(ee),...e(C).schoolList],placeholder:"请选择院校信息"},null,8,["modelValue","options"])]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(m,{label:"学科名称:"},{default:a(()=>[t(D,{modelValue:e(p).xkmc,"onUpdate:modelValue":s[1]||(s[1]=f=>e(p).xkmc=f),modelModifiers:{trim:!0},placeholder:"请输入学科名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[t(G,null,{default:a(()=>[t(U,{type:"outline",onClick:s[2]||(s[2]=f=>e(v)("ZsAddFirstClassSchool"))},{icon:a(()=>[t(P)]),default:a(()=>[x(" 新增 ")]),_:1}),t(U,{type:"outline",status:"danger",disabled:!e(d).selectedKeys.length,loading:e(b)==="删除",onClick:S},{icon:a(()=>[t(q)]),default:a(()=>[x(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:a(()=>[t(E,{"selected-keys":e(d).selectedKeys,"onUpdate:selectedKeys":s[3]||(s[3]=f=>e(d).selectedKeys=f),class:"zs-table","row-key":"id",data:e(c),"row-selection":e(d).rowSelection,bordered:e(d).bordered,pagination:e(d).pagination,size:e(d).size,columns:e(A),stripe:e(d).stripe,loading:e(r)},{operate:a(({record:f})=>[t(U,{type:"text",onClick:de=>e(T)(f,()=>e(v)("ZsAddFirstClassSchool"))},{default:a(()=>[x("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(b)==="ZsAddFirstClassSchool"?(Z(),F(ne,{key:0,data:e(V),onSuccess:e(w),onClose:s[4]||(s[4]=f=>e(T)({},()=>e(v)(null)))},null,8,["data","onSuccess"])):X("",!0)])}}});export{me as default};

import{d as x,g as M,h as P,i as q,r as n,o as N,l as F,w as l,a as t,b as e,m as $,S as O,n as Q,j as W,c as X,e as A,p as Y,q as ee}from"./index-d007178a.js";import{f as D,c as te,_ as le}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{A as ae}from"./options-aafac76d.js";import"./index-13860ba0.js";const oe=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"院校名称",dataIndex:"yxmc",show:!0,align:"center",render:({record:c})=>D(c.yxmc)},{title:"一级学科名称",dataIndex:"zymc",show:!0,align:"center",render:({record:c})=>D(c.zymc)},{title:"评估结果",dataIndex:"level",show:!0,align:"center",render:({record:c})=>D(c.level)},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],ne=x({name:"ZsAddRank"}),se=x({...ne,props:{data:{default:()=>({})}},emits:["close","success"],setup(c,{emit:b}){const m=c,S=M(),[y,d]=P(null),{form:r,formRef:h}=q(()=>({...m.data})),C={zymc:{required:!0,message:"请输入专业名称"}},V=()=>{h.value.validate(p=>{p||(m.data.id?a("editSchoolRankList"):a("addSchoolRankList"))})},a=async p=>{const{err:s}=await $(()=>O[p](r.value),{before:()=>d("okLoading"),after:()=>d(null)});s||(b("success"),b("close"))};return(p,s)=>{const U=n("a-select"),_=n("a-form-item"),v=n("a-grid-item"),z=n("a-input"),R=n("a-grid"),T=n("a-form"),I=n("a-modal");return N(),F(I,{title:e(te)("学科排名",!!m.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"500px","align-center":!1,"mask-closable":!1,"ok-loading":e(y)==="okLoading",onCancel:s[3]||(s[3]=i=>b("close")),onOk:V},{default:l(()=>[t(T,{ref_key:"formRef",ref:h,model:e(r),"label-align":"left",size:"large","auto-label-width":"",rules:C},{default:l(()=>[t(R,{cols:1,"col-gap":24},{default:l(()=>[t(v,null,{default:l(()=>[t(_,{field:"yxId",label:"院校名称:"},{default:l(()=>[t(U,{modelValue:e(r).yxId,"onUpdate:modelValue":s[0]||(s[0]=i=>e(r).yxId=i),options:e(S).schoolList,"virtual-list-props":{height:200},disabled:!!m.data.id,"allow-search":"","allow-clear":"",placeholder:"请选择院校名称"},null,8,["modelValue","options","disabled"])]),_:1})]),_:1}),t(v,null,{default:l(()=>[t(_,{field:"zymc",label:"一级学科名称:"},{default:l(()=>[t(z,{modelValue:e(r).zymc,"onUpdate:modelValue":s[1]||(s[1]=i=>e(r).zymc=i),placeholder:"请输入一级学科名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(v,null,{default:l(()=>[t(_,{field:"level",label:"评估结果:"},{default:l(()=>[t(z,{modelValue:e(r).level,"onUpdate:modelValue":s[2]||(s[2]=i=>e(r).level=i),placeholder:"请输入评估结果"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),de=x({name:"SchoolSchoolRankOrg"}),me=x({...de,setup(c){const{warningModal:b}=ee(),m=M(),[S,y]=P(null),{form:d,resetForm:r}=q(()=>({level:"",zymc:"",yxId:""}),()=>s()),{selectRow:h,columnsData:C,visibleColumnsData:V,tableBaseOptions:a,createRowNo:p,resetData:s,extendTableList:U,setSelectRow:_,changeTableColumn:v,changeTableSize:z}=Q(oe(),()=>i()),R=f=>{b(`确定操作选中的${a.selectedKeys.length}数据吗？`,async o=>{const{err:w}=await $(()=>O.deleteSchoolRankList({ids:a.selectedKeys}),{successMsg:"操作成功"});w||(o(!0),a.selectedKeys=[],i())})},{data:T,loading:I,initData:i}=W(async()=>{const{res:f,err:o}=await $(()=>O.getSchoolRankList({...d.value,currentPage:a.pagination.current,pageSize:a.pagination.pageSize,pagingOrNot:"1"}));return o?[]:(a.pagination.total=f.data.totalCount,f==null?void 0:f.data.resultList.map((w,k)=>({sortTableNo:p(k),...w})))});return(f,o)=>{const w=n("a-select"),k=n("a-form-item"),L=n("a-grid-item"),B=n("a-input"),j=n("a-grid"),E=n("a-form"),H=n("icon-plus"),K=n("a-button"),Z=n("icon-close"),G=n("a-space"),J=n("a-table");return N(),X("div",null,[t(le,{fold:"","table-columns":e(C),"table-size":e(a).size,onResetSearch:e(r),onSearch:e(s),onChangeTableSize:e(z),onChangeTableColumn:e(v)},{form:l(({collapsed:u})=>[t(E,{model:e(d),"label-align":"left",size:"large","auto-label-width":""},{default:l(()=>[t(j,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!u},{default:l(()=>[t(L,null,{default:l(()=>[t(k,{label:"院校名称:"},{default:l(()=>[t(w,{modelValue:e(d).yxId,"onUpdate:modelValue":o[0]||(o[0]=g=>e(d).yxId=g),"virtual-list-props":{height:200},"allow-search":"","allow-clear":"",options:[...e(ae),...e(m).schoolList],placeholder:"请输入院校名称"},null,8,["modelValue","options"])]),_:1})]),_:1}),t(L,null,{default:l(()=>[t(k,{label:"一级学科名称:"},{default:l(()=>[t(B,{modelValue:e(d).zymc,"onUpdate:modelValue":o[1]||(o[1]=g=>e(d).zymc=g),placeholder:"请输入一级学科名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(L,null,{default:l(()=>[t(k,{label:"评估结果:"},{default:l(()=>[t(B,{modelValue:e(d).level,"onUpdate:modelValue":o[2]||(o[2]=g=>e(d).level=g),placeholder:"请输入评估结果"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:l(()=>[t(G,null,{default:l(()=>[t(K,{type:"outline",onClick:o[3]||(o[3]=u=>e(y)("zsAddRank"))},{icon:l(()=>[t(H)]),default:l(()=>[A(" 新增 ")]),_:1}),t(K,{type:"outline",status:"danger",disabled:!e(a).selectedKeys.length,loading:e(S)==="删除",onClick:o[4]||(o[4]=u=>R("batchDeleteUser"))},{icon:l(()=>[t(Z)]),default:l(()=>[A(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:l(()=>[t(J,{"selected-keys":e(a).selectedKeys,"onUpdate:selectedKeys":o[5]||(o[5]=u=>e(a).selectedKeys=u),class:"zs-table","row-key":"id",data:e(T),"row-selection":e(a).rowSelection,bordered:e(a).bordered,pagination:e(a).pagination,size:e(a).size,columns:e(V),stripe:e(a).stripe,loading:e(I)},{operate:l(({record:u})=>[t(K,{type:"text",onClick:g=>e(_)(u,()=>e(y)("zsAddRank"))},{default:l(()=>[A("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(S)==="zsAddRank"?(N(),F(se,{key:0,data:e(h),onSuccess:e(i),onClose:o[6]||(o[6]=u=>e(_)({},()=>e(y)(null)))},null,8,["data","onSuccess"])):Y("",!0)])}}});export{me as default};

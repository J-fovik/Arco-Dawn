import{N as le,U as oe,a as $,n as s,p,O as w,P as N,X as re,T as z,d as v,E as F,v as Y,b as q,r as d,o as I,l as S,w as o,g as l,c as e,k as M,q as ne,s as se,e as ie,z as P,i as U,h as de,f as ue,L as pe,A as ce}from"./index-8a2cb146.js";import{_ as me}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{F as ge}from"./finance-4d2c7da5.js";import{O as _e}from"./order-70291d37.js";import"./index-2bbe694f.js";const fe={exportReport:c=>le({method:"post",url:oe.STATISTIC.EXPORT_REPORT,data:c,responseType:"blob"})},be=()=>{const{getDictionaryItem:c}=$();return[{title:"团号",dataIndex:"groupId",show:!0,align:"center",render:({record:t})=>s(t.groupId)},{title:"供应商",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.supName)},{title:"营业部名称",dataIndex:"departName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.departName)},{title:"线路名称",dataIndex:"routeName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.routeName)},{title:"天数",dataIndex:"days",show:!0,align:"center",render:({record:t})=>p(z,{color:"blue"},{default:()=>s(t.days)})},{title:"人数",dataIndex:"totalNumber",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p(z,{color:"blue"},{default:()=>s(t.totalNumber)})},{title:"报名同行费用(元)",dataIndex:"settleTotal",show:!0,align:"right",render:({record:t})=>p("span",{class:"text-red text-price"},w(N(t.settleTotal)))},{title:"扣点（%）",dataIndex:"ratio",show:!0,align:"right",render:({record:t})=>p("span",{class:"text-green"},s(t.ratio+"%"))},{title:"供应商金额",dataIndex:"setMoney",show:!0,align:"right",render:({record:t})=>p("span",{class:"text-red text-price"},w(N(t.setMoney)))},{title:"已结算金额",dataIndex:"setValue",show:!0,align:"right",render:({record:t})=>p("span",{class:"text-red text-price"},w(N(t.setValue)))},{title:"结算状态",dataIndex:"settleType",show:!0,align:"center",render:({record:t})=>p(z,{color:"blue"},{default:()=>s(c("signupSettleType",t.settleType).detailName)})},{title:"创建时间",dataIndex:"createTime",show:!0,align:"center",render:({record:t})=>re(t.createTime,"YYYY-MM-DD")},{title:"操作",width:200,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},xe=()=>{const{getDictionaryItem:c}=$();return[{title:"付款账户名称",dataIndex:"payUserName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.payUserName)},{title:"付款账户",dataIndex:"payNum",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.payNum)},{title:"收款账户名称",dataIndex:"receiveUserName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.receiveUserName)},{title:"收款账户",dataIndex:"receiveNum",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.receiveNum)},{title:"结算金额",dataIndex:"money",show:!0,ellipsis:!0,tooltip:!0,align:"right",render:({record:t})=>p("span",{class:"text-red text-price"},w(N(t.money)))},{title:"手续费",dataIndex:"sxf",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>p("span",{class:"text-red text-price"},w(N(t.sxf)))},{title:"费用分类",dataIndex:"costType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.costType=="1"?"订单费用":t.costType=="2"?"保险费用":"")},{title:"结算状态",dataIndex:"settleType",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(c("signupSettleType",t.settleType).detailName)},{title:"结算方式",dataIndex:"setMode",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.setMode=="1"?"自动":"手动")},{title:"交易流水号",dataIndex:"pylsh",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.pylsh)},{title:"交易时间",dataIndex:"createTime",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:t})=>s(t.createTime)}]},ye=v({name:"ZsSettlementRecords"}),Ie=v({...ye,props:{data:{default:()=>({})}},emits:["close","success"],setup(c,{emit:t}){const x=c,[A,B]=F(null),T=t,{visibleColumnsData:h,tableBaseOptions:a,extendTableList:K}=Y(xe(),()=>k()),{data:D,loading:V,initData:k}=q(async()=>{const{res:n,err:u}=await M(()=>ge.getSettleRecordList({groupNo:x.data.groupId,supName:x.data.supName}));return u?[]:(a.pagination.total=n.data.totalCount,n==null?void 0:n.data.dataList)});return(n,u)=>{const C=d("a-table"),L=d("a-modal");return I(),S(L,{title:"结算记录","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(A)==="okLoading",top:"10%",width:"80vw","ok-text":"返回",onCancel:u[1]||(u[1]=y=>T("close")),onOk:u[2]||(u[2]=y=>T("close"))},{default:o(()=>[l(C,{"selected-keys":e(a).selectedKeys,"onUpdate:selectedKeys":u[0]||(u[0]=y=>e(a).selectedKeys=y),class:"zs-table","row-key":"groupId",data:e(D),"row-selection":e(a).rowSelection,bordered:e(a).bordered,pagination:e(a).pagination,size:e(a).size,columns:e(h),stripe:e(a).stripe,loading:e(V)},null,8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["ok-loading"])}}}),we=ue("span",{class:"mx-3"},"-",-1),Ne=v({name:"StatisticDedicatedCollection"}),De=v({...Ne,setup(c){const{getDictionaryInfo:t}=$(),{vAuthority:x,userInfo:A}=ne(),{warningModal:B}=ce(),[T,h]=F(null),{form:a,resetForm:K}=se(()=>({groupId:"",departName:"",departNo:"",routeName:"",settleType:"",startDate:"",endDate:""}),()=>u()),{selectRow:D,columnsData:V,visibleColumnsData:k,tableBaseOptions:n,resetData:u,setSelectRow:C,extendTableList:L,changeTableColumn:y,changeTableSize:Z}=Y(be(),()=>O()),X=()=>{B("确定导出报表吗",async m=>{const{res:r,err:_}=await M(()=>fe.exportReport({groupId:a.value.groupId,departNo:a.value.departNo,departName:a.value.departName,settleType:a.value.settleType,routeName:a.value.routeName,startDate:a.value.startDate,endDate:a.value.endDate}),{successMsg:"操作成功"});_||(pe(r,"供应商收款报表.xls"),m(!0))})},{data:j,loading:G,initData:O}=q(async()=>{const{res:m,err:r}=await M(()=>_e.getFinanceList({...a.value,currentPage:n.pagination.current,pageSize:n.pagination.pageSize,pagingOrNot:"1"}));return r?[]:(n.pagination.total=m.data.totalCount,m==null?void 0:m.data.dataList)});return(m,r)=>{const _=d("a-input"),f=d("a-form-item"),b=d("a-grid-item"),H=d("a-select"),E=d("a-date-picker"),J=d("a-grid"),Q=d("a-form"),W=d("icon-download"),R=d("a-button"),ee=d("a-space"),te=d("a-button-group"),ae=d("a-table");return I(),ie("div",null,[l(me,{fold:"","table-columns":e(V),"table-size":e(n).size,onResetSearch:e(K),onSearch:e(u),onChangeTableSize:e(Z),onChangeTableColumn:e(y)},{form:o(({collapsed:g})=>[l(Q,{model:e(a),"label-align":"left",size:"large","auto-label-width":""},{default:o(()=>[l(J,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!g},{default:o(()=>[l(b,null,{default:o(()=>[l(f,{label:"团号:"},{default:o(()=>[l(_,{modelValue:e(a).groupId,"onUpdate:modelValue":r[0]||(r[0]=i=>e(a).groupId=i),modelModifiers:{trim:!0},placeholder:"请输入团号"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(f,{label:"部门名称:"},{default:o(()=>[l(_,{modelValue:e(a).departName,"onUpdate:modelValue":r[1]||(r[1]=i=>e(a).departName=i),modelModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(f,{label:"部门代码:"},{default:o(()=>[l(_,{modelValue:e(a).departNo,"onUpdate:modelValue":r[2]||(r[2]=i=>e(a).departNo=i),modelModifiers:{trim:!0},placeholder:"请输入部门代码"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(f,{label:"结算状态:"},{default:o(()=>[l(H,{modelValue:e(a).settleType,"onUpdate:modelValue":r[3]||(r[3]=i=>e(a).settleType=i),placeholder:"请选择结算状态",options:e(t)("signupSettleType"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(f,{label:"线路:"},{default:o(()=>[l(_,{modelValue:e(a).routeName,"onUpdate:modelValue":r[4]||(r[4]=i=>e(a).routeName=i),modelModifiers:{trim:!0},placeholder:"请输入线路"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(f,{label:"出团日期:"},{default:o(()=>[l(E,{modelValue:e(a).startDate,"onUpdate:modelValue":r[5]||(r[5]=i=>e(a).startDate=i),class:"flex1",placeholder:"出团日期(开始)"},null,8,["modelValue"]),we,l(E,{modelValue:e(a).endDate,"onUpdate:modelValue":r[6]||(r[6]=i=>e(a).endDate=i),class:"flex1",placeholder:"出团日期(结束)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:o(()=>[l(ee,null,{default:o(()=>[P((I(),S(R,{type:"outline",status:"warning",onClick:X},{icon:o(()=>[l(W)]),default:o(()=>[U(" 导出报表 ")]),_:1})),[[e(x),"StatisticDedicatedCollectionExport"]])]),_:1})]),table:o(()=>[l(ae,{"selected-keys":e(n).selectedKeys,"onUpdate:selectedKeys":r[7]||(r[7]=g=>e(n).selectedKeys=g),class:"zs-table","row-key":"groupId",data:e(j),"row-selection":e(n).rowSelection,bordered:e(n).bordered,pagination:e(n).pagination,size:e(n).size,columns:e(k),stripe:e(n).stripe,loading:e(G)},{operate:o(({record:g})=>[l(te,null,{default:o(()=>[l(R,{type:"text",status:"success",onClick:i=>m.$router.push(`/statistic/dedicatedCollection/operate?routeId=${g.routeId}&groupId=${g.groupId}`)},{default:o(()=>[U("详情")]),_:2},1032,["onClick"]),P((I(),S(R,{type:"text",onClick:i=>e(C)(g,()=>e(h)("ZsBalanceRecords"))},{default:o(()=>[U("结算记录")]),_:2},1032,["onClick"])),[[e(x),"StatisticDedicatedCollectionRecord"]])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(T)==="ZsBalanceRecords"?(I(),S(Ie,{key:0,data:e(D),onSuccess:e(O),onClose:r[8]||(r[8]=g=>e(C)({},()=>e(h)(null)))},null,8,["data","onSuccess"])):de("",!0)])}}});export{De as default};

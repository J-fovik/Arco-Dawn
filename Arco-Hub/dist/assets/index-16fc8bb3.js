import{P as H,d as k,h as $,g as D,i as N,r as n,o as K,l as O,w as a,a as t,b as e,m as A,S as L,n as G,j as J,c as Q,e as I,p as W,q as X}from"./index-d007178a.js";import{A as Y}from"./options-aafac76d.js";import{f as z,a as ee,c as te,_ as ae}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import"./index-13860ba0.js";const oe=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"院校名称",dataIndex:"yxmc",show:!0,align:"center",render:({record:d})=>z(d.yxmc)},{title:"保研年份",dataIndex:"nf",show:!0,align:"center",render:({record:d})=>z(d.nf)},{title:"推免人数",dataIndex:"cnt",show:!0,align:"center",render:({record:d})=>z(d.cnt)},{title:"推免率",dataIndex:"per",show:!0,align:"center",render:({record:d})=>H("span",{class:"text-red"},d.per?`${ee(d.per)}%`:"--")},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],le=k({name:"ZsAddSecurityResearch"}),ne=k({...le,props:{data:{default:()=>({})}},emits:["close","success"],setup(d,{emit:g}){const c=d,[b,h]=$(null),p=D(),{form:r,formRef:S}=N(()=>({...c.data})),C={yxId:{required:!0,message:"请选择院校信息"},nf:{required:!0,message:"请选择年份"}},v=()=>{S.value.validate(u=>{u||(c.data.id?l("editSecurityResearch"):l("addSecurityResearch"))})},l=async u=>{const{err:s}=await A(()=>L[u](r.value),{before:()=>h("okLoading"),after:()=>h(null)});s||(g("success"),g("close"))};return(u,s)=>{const x=n("a-select"),_=n("a-form-item"),f=n("a-grid-item"),R=n("a-year-picker"),w=n("a-input"),V=n("a-grid"),y=n("a-form"),i=n("a-modal");return K(),O(i,{title:e(te)("保研信息",!!c.data.id),"unmount-on-close":"",visible:"",top:"5%",width:"500px","align-center":!1,"mask-closable":!1,"ok-loading":e(b)==="okLoading",onCancel:s[4]||(s[4]=o=>g("close")),onOk:v},{default:a(()=>[t(y,{ref_key:"formRef",ref:S,model:e(r),"label-align":"left",size:"large","auto-label-width":"",rules:C},{default:a(()=>[t(V,{cols:1,"col-gap":24},{default:a(()=>[t(f,null,{default:a(()=>[t(_,{field:"yxId",label:"院校信息:"},{default:a(()=>[t(x,{modelValue:e(r).yxId,"onUpdate:modelValue":s[0]||(s[0]=o=>e(r).yxId=o),options:e(p).schoolList,"virtual-list-props":{height:200},disabled:!!c.data.id,"allow-search":"",placeholder:"请选择院校信息"},null,8,["modelValue","options","disabled"])]),_:1})]),_:1}),t(f,null,{default:a(()=>[t(_,{field:"nf",label:"保研年份:"},{default:a(()=>[t(R,{modelValue:e(r).nf,"onUpdate:modelValue":s[1]||(s[1]=o=>e(r).nf=o),class:"flex1",disabled:!!c.data.id,placeholder:"请输入保研年份"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),t(f,null,{default:a(()=>[t(_,{field:"cnt",label:"推免人数:"},{default:a(()=>[t(w,{modelValue:e(r).cnt,"onUpdate:modelValue":s[2]||(s[2]=o=>e(r).cnt=o),placeholder:"请输入推免人数"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:a(()=>[t(_,{field:"per",label:"推免率:"},{default:a(()=>[t(w,{modelValue:e(r).per,"onUpdate:modelValue":s[3]||(s[3]=o=>e(r).per=o),placeholder:"请输入推免率"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),se=k({name:"SchoolSchoolRankOrgSecurityResearchManage"}),me=k({...se,setup(d){const{warningModal:g}=X(),[c,b]=$(null),h=D(),{form:p,resetForm:r}=N(()=>({yxId:""}),()=>u()),{selectRow:S,columnsData:C,visibleColumnsData:v,tableBaseOptions:l,resetData:u,extendTableList:s,setSelectRow:x,changeTableColumn:_,changeTableSize:f}=G(oe(),()=>y()),R=()=>{g(`确定删除选中的${l.selectedKeys.length}数据吗？`,async i=>{const{err:o}=await A(()=>L.deleteSecurityResearch({ids:l.selectedKeys}),{successMsg:"操作成功"});o||(i(!0),l.selectedKeys=[],y())})},{data:w,loading:V,initData:y}=J(async()=>{const{res:i,err:o}=await A(()=>L.getSecurityResearchList({...p.value,currentPage:l.pagination.current,pageSize:l.pagination.pageSize,pagingOrNot:"1"}));return o?[]:(l.pagination.total=i.data.totalCount,s(i==null?void 0:i.data.schoolList))});return(i,o)=>{const U=n("a-select"),B=n("a-form-item"),M=n("a-grid-item"),P=n("a-grid"),q=n("a-form"),Z=n("icon-plus"),T=n("a-button"),F=n("icon-close"),j=n("a-space"),E=n("a-table");return K(),Q("div",null,[t(ae,{"table-columns":e(C),"table-size":e(l).size,onResetSearch:e(r),onSearch:e(u),onChangeTableSize:e(f),onChangeTableColumn:e(_)},{form:a(()=>[t(q,{model:e(p),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[t(P,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[t(M,null,{default:a(()=>[t(B,{label:"院校名称:"},{default:a(()=>[t(U,{modelValue:e(p).yxId,"onUpdate:modelValue":o[0]||(o[0]=m=>e(p).yxId=m),"virtual-list-props":{height:200},"allow-search":"",options:[...e(Y),...e(h).schoolList],placeholder:"请输入院校名称"},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[t(j,null,{default:a(()=>[t(T,{type:"outline",onClick:o[1]||(o[1]=m=>e(b)("ZsAddSecurityResearch"))},{icon:a(()=>[t(Z)]),default:a(()=>[I(" 新增 ")]),_:1}),t(T,{type:"outline",status:"danger",disabled:!e(l).selectedKeys.length,loading:e(c)==="删除",onClick:R},{icon:a(()=>[t(F)]),default:a(()=>[I(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:a(()=>[t(E,{"selected-keys":e(l).selectedKeys,"onUpdate:selectedKeys":o[2]||(o[2]=m=>e(l).selectedKeys=m),class:"zs-table","row-key":"id",data:e(w),"row-selection":e(l).rowSelection,bordered:e(l).bordered,pagination:e(l).pagination,size:e(l).size,columns:e(v),stripe:e(l).stripe,loading:e(V)},{operate:a(({record:m})=>[t(T,{type:"text",onClick:re=>e(x)(m,()=>e(b)("ZsAddSecurityResearch"))},{default:a(()=>[I("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(c)==="ZsAddSecurityResearch"?(K(),O(ne,{key:0,data:e(S),onSuccess:e(y),onClose:o[3]||(o[3]=m=>e(x)({},()=>e(b)(null)))},null,8,["data","onSuccess"])):W("",!0)])}}});export{me as default};

import{d as A,u as G,C as H,a as W,E as X,s as J,M as Q,I as L,r as i,o as w,l as q,w as d,g as t,c as o,f as I,i as x,h as $,k as f,G as ee,H as ae,X as P,Y as oe,_ as te}from"./index-8a2cb146.js";import{p as le,l as ne}from"./rules-4aeaef32.js";import{Z as de}from"./index-2bbe694f.js";import{S as D}from"./scenicSpot-07a0c57b.js";const re=c=>(ee("data-v-a312f225"),c=c(),ae(),c),ie=re(()=>I("div",{style:{height:"100px"}},null,-1)),se={class:"orderSubmit-footer box-flex jc-fe"},ue=A({name:"ScenicSpotCooperateManageOperate"}),ce=A({...ue,setup(c){const u=G(),{jumpTabName:_}=H();W();const[M,C]=X(null),{form:e,formRef:v,formPlaceholder:y}=J(()=>({scenicName:"",scenicLevel:"",scenicContacts:"",scenicContactsPhone:void 0,detailAddress:"",country:"",countryCode:"",province:"",provinceCode:"",city:"",cityCode:"",periodCooperateEnd:"",periodCooperateStart:"",fileList:[]})),U={scenicName:{required:!0,message:"请输入景区名称"},scenicLevel:{required:!0,message:"请输入景区级别"},scenicContacts:{required:!0,message:"请输入景区联系人"},scenicContactsPhone:{required:!0,validator:(l,a)=>{l||a("请输入手机号码"),!le(l)&&!ne(l)&&a("请输入正确的手机号码")}},detailAddress:{required:!0,message:"请输入详细地址"},countryCode:{required:!0,message:"请输入所属国家"},periodCooperateStart:{required:!0,message:"请选择合作期限开始日期"},periodCooperateEnd:{required:!0,message:"请选择合作期限结束日期"},fileList:{required:!0,message:"请上传合作详情文件"}},p=async l=>{const{res:a}=await f(()=>oe.getAreaInfo(l));return(a==null?void 0:a.data)??[]},{data:g}=Q(async()=>await p({level:"1"}),[]),{data:V}=L(async()=>await p({parentNo:e.value.countryCode}),{watchSource:()=>e.value.countryCode,defaultValue:[]}),{data:b}=L(async()=>await p({parentNo:e.value.provinceCode}),{watchSource:()=>e.value.provinceCode,defaultValue:[]}),k=l=>{e.value.provinceCode="",e.value.province="",e.value.cityCode="",e.value.city="",e.value.country=g.value.find(a=>a.areaNo==l).areaName},E=l=>{e.value.cityCode="",e.value.city="",e.value.province=V.value.find(a=>a.areaNo==l).areaName},R=l=>{e.value.city=b.value.find(a=>a.areaNo==l).areaName},Y=()=>{v.value.validate(l=>{l||B()})},B=async()=>{const l=e.value.fileList.filter(r=>r.status!="done").map(r=>r.file),a=e.value.fileList.filter(r=>r.status=="done").map(r=>r.uid),{err:s}=await f(()=>D.planeScenicSave({...e.value,periodCooperateStart:P(e.value.periodCooperateStart,"YYYYMMDD",""),periodCooperateEnd:P(e.value.periodCooperateEnd,"YYYYMMDD",""),fileList:l.length==0?null:l,oldFileIdList:a}),{before:()=>C("okLoading"),after:()=>C(null),successMsg:"保存成功"});s||_()},O=async()=>{const{res:l,err:a}=await f(()=>D.getScenicDetail({id:u.query.id}));a||(e.value={...l==null?void 0:l.data,scenicContactsPhone:(l==null?void 0:l.data.scenicContactsPhone)*1},e.value.fileList=l==null?void 0:l.data.cooperateDetailList.map(s=>({name:s.attName,size:s.attSize,url:s.attPath,uid:s.id,status:"done"})))};return u.query.id&&O(),(l,a)=>{const s=i("a-input"),r=i("a-form-item"),z=i("a-input-number"),m=i("a-select"),h=i("a-date-picker"),S=i("a-col"),T=i("a-row"),j=i("a-upload"),F=i("a-form"),K=i("a-card"),N=i("a-button"),Z=i("a-space");return w(),q(de,null,{default:d(()=>[t(K,{title:"景区合作信息维护",bordered:!1,class:"general-card"},{default:d(()=>[t(F,{ref_key:"formRef",ref:v,model:o(e),"label-align":"left",size:"large",style:{width:"800px","padding-left":"100px"},"auto-label-width":"",disabled:!!o(u).query.isReadOnly,rules:U},{default:d(()=>[t(r,{field:"scenicName",label:"景区名称:",required:""},{default:d(()=>[t(s,{modelValue:o(e).scenicName,"onUpdate:modelValue":a[0]||(a[0]=n=>o(e).scenicName=n),modelModifiers:{trim:!0},placeholder:"请输入景区名称"},null,8,["modelValue"])]),_:1}),t(r,{field:"scenicLevel",label:"景区级别:",required:""},{default:d(()=>[t(s,{modelValue:o(e).scenicLevel,"onUpdate:modelValue":a[1]||(a[1]=n=>o(e).scenicLevel=n),modelModifiers:{trim:!0},placeholder:"请输入景区级别"},null,8,["modelValue"])]),_:1}),t(r,{field:"scenicContacts",label:"景区联系人:",required:""},{default:d(()=>[t(s,{modelValue:o(e).scenicContacts,"onUpdate:modelValue":a[2]||(a[2]=n=>o(e).scenicContacts=n),modelModifiers:{trim:!0},placeholder:"请输入景区联系人"},null,8,["modelValue"])]),_:1}),t(r,{field:"scenicContactsPhone",label:"景区联系电话:",required:""},{default:d(()=>[t(z,{modelValue:o(e).scenicContactsPhone,"onUpdate:modelValue":a[3]||(a[3]=n=>o(e).scenicContactsPhone=n),modelModifiers:{trim:!0},placeholder:"请输入景区联系电话"},null,8,["modelValue"])]),_:1}),t(r,{field:"detailAddress",label:"详细地址:",required:""},{default:d(()=>[t(s,{modelValue:o(e).detailAddress,"onUpdate:modelValue":a[4]||(a[4]=n=>o(e).detailAddress=n),modelModifiers:{trim:!0},placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),t(r,{label:"所属国家:",field:"countryCode",required:""},{default:d(()=>[t(m,{modelValue:o(e).countryCode,"onUpdate:modelValue":a[5]||(a[5]=n=>o(e).countryCode=n),"allow-search":"",options:o(g),"field-names":{label:"areaName",value:"areaNo"},"virtual-list-props":{height:200},placeholder:"请选择所属国家",onChange:k},null,8,["modelValue","options"])]),_:1}),t(r,{label:"所属省:",field:"provinceCode"},{default:d(()=>[t(m,{modelValue:o(e).provinceCode,"onUpdate:modelValue":a[6]||(a[6]=n=>o(e).provinceCode=n),options:o(V),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:o(y)("请选择所属省"),onChange:E},null,8,["modelValue","options","placeholder"])]),_:1}),t(r,{label:"所属市:",field:"cityCode"},{default:d(()=>[t(m,{modelValue:o(e).cityCode,"onUpdate:modelValue":a[7]||(a[7]=n=>o(e).cityCode=n),options:o(b),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:o(y)("请选择所属市"),onChange:R},null,8,["modelValue","options","placeholder"])]),_:1}),t(T,{gutter:8},{default:d(()=>[t(S,{span:12},{default:d(()=>[t(r,{field:"periodCooperateStart",label:"合作期限开始:"},{default:d(()=>[t(h,{modelValue:o(e).periodCooperateStart,"onUpdate:modelValue":a[8]||(a[8]=n=>o(e).periodCooperateStart=n),class:"flex1"},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:d(()=>[t(r,{field:"periodCooperateEnd",label:"合作期限结束:"},{default:d(()=>[t(h,{modelValue:o(e).periodCooperateEnd,"onUpdate:modelValue":a[9]||(a[9]=n=>o(e).periodCooperateEnd=n),class:"flex1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(r,{label:"合作详情:",field:"fileList"},{default:d(()=>[t(j,{"file-list":o(e).fileList,"onUpdate:fileList":a[10]||(a[10]=n=>o(e).fileList=n),"auto-upload":!1,accept:".pdf",multiple:"",limit:1,draggable:"","show-retry-button":!1,"show-remove-button":!o(u).query.isReadOnly},null,8,["file-list","show-remove-button"])]),_:1})]),_:1},8,["model","disabled"])]),_:1}),ie,I("div",se,[t(Z,null,{default:d(()=>[o(u).query.isReadOnly?$("",!0):(w(),q(N,{key:0,loading:o(M)==="okLoading",type:"primary",onClick:Y},{default:d(()=>[x("确定")]),_:1},8,["loading"])),t(N,{onClick:a[11]||(a[11]=()=>o(_)())},{default:d(()=>[x("返回")]),_:1})]),_:1})])]),_:1})}}});const Ce=te(ce,[["__scopeId","data-v-a312f225"]]);export{Ce as default};

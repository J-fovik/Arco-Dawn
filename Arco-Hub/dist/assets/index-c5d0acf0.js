import{a as F,n as f,d as D,E as Z,s as P,r as d,o as c,l as _,w as t,g as a,c as e,k as R,q as te,v as ae,x as ne,y as oe,e as le,z as b,i as m,t as se,h as ie,f as re,A as de}from"./index-8a2cb146.js";import{_ as ue}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{L as U}from"./line-7661aa01.js";import"./index-2bbe694f.js";const me=()=>{const{getDictionaryItem:v}=F();return[{title:"线路名称",dataIndex:"routeName",show:!0,slotName:"routeName",align:"center"},{title:"地区",dataIndex:"areaName",show:!0,align:"center",render:({record:n})=>f(n.areaName)},{title:"旅行分类",dataIndex:"travelType",show:!0,align:"center",render:({record:n})=>f(v("travelType",n.travelType).detailName)},{title:"成团类别",dataIndex:"groupType",show:!0,align:"center",render:({record:n})=>f(v("new_group_type",n.groupType).detailName)},{title:"天数",dataIndex:"travelDays",show:!0,align:"center",render:({record:n})=>f(n.travelDays)},{title:"供应商名称",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:n})=>f(n.supName)},{title:"状态",dataIndex:"state",show:!0,align:"center",render:({record:n})=>f(v("traveState",n.state).detailName)},{title:"出团日期开始",dataIndex:"startDate",show:!0,align:"center",render:({record:n})=>f(n.startDate)},{title:"出团日期截止",dataIndex:"endDate",show:!0,align:"center",render:({record:n})=>f(n.endDate)},{title:"操作",width:300,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ce=D({name:"ZsExamineTourism"}),pe=D({...ce,props:{idList:{default:()=>[]}},emits:["close","success"],setup(v,{emit:n}){const $=v,[h,T]=Z(""),{form:x,formRef:i}=P(()=>({auditOpinion:""})),S={auditOpinion:{required:!0,message:"请输入下架原因"}},N=n,E=()=>{i.value.validate(g=>{g||l()})},l=async()=>{const{err:g}=await R(()=>U.examineTourist({idList:$.idList,state:"2",...x.value}),{before:()=>T("okLoading"),after:()=>T(""),successMsg:"驳回成功"});g||(N("success"),N("close"))};return(g,k)=>{const L=d("a-textarea"),z=d("a-form-item"),I=d("a-form"),K=d("a-modal");return c(),_(K,{top:"10%",width:"500px",title:"线路审核","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(h)==="okLoading",onCancel:k[1]||(k[1]=y=>N("close")),onOk:E},{default:t(()=>[a(I,{ref_key:"formRef",ref:i,model:e(x),"label-align":"left",size:"large","auto-label-width":"",rules:S},{default:t(()=>[a(z,{field:"auditOpinion",label:"驳回原因:",required:""},{default:t(()=>[a(L,{modelValue:e(x).auditOpinion,"onUpdate:modelValue":k[0]||(k[0]=y=>e(x).auditOpinion=y),placeholder:"请输入驳回原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),_e=re("span",{class:"mx-3"},"-",-1),fe=D({name:"LineTourismExamine"}),Te=D({...fe,setup(v){const{vAuthority:n}=te(),{getDictionaryInfo:$}=F(),[h,T]=Z(""),{warningModal:x}=de(),{form:i,resetForm:S}=P(()=>({routeName:"",travelType:"",supName:"",areaName:"",state:"",startDate:"",endDate:""}),()=>g()),{columnsData:N,visibleColumnsData:E,tableBaseOptions:l,resetData:g,extendTableList:k,changeTableColumn:L,changeTableSize:z}=ae(me(),()=>y()),{data:I,loading:K,initData:y}=ne(async()=>{const{res:r,err:o}=await R(()=>U.getTouristRoutesExamineList({...i.value,currentPage:l.pagination.current,pageSize:l.pagination.pageSize,pagingOrNot:"1"}));return o?[]:(l.pagination.total=r.data.totalCount,k(r==null?void 0:r.data.travelRouteList))}),j=r=>{window.open(`/trip?id=${r.id}`)},M=r=>{x("确定审核发布数据吗？",async o=>{const{res:V}=await R(()=>U.examineTourist({idList:r,state:"1"}));o(!0),V&&(l.selectedKeys=[],y())})},G=()=>{l.selectedKeys=[],T("")},H=r=>{l.selectedKeys=r,T("ZsExamineTourism")};return oe(y),(r,o)=>{const V=d("a-input"),w=d("a-form-item"),C=d("a-grid-item"),O=d("a-select"),A=d("a-date-picker"),J=d("a-grid"),Q=d("a-form"),B=d("icon-folder"),p=d("a-button"),q=d("a-space"),W=d("a-link"),X=d("a-popover"),Y=d("a-button-group"),ee=d("a-table");return c(),le("div",null,[a(ue,{fold:"","table-columns":e(N),"table-size":e(l).size,onResetSearch:e(S),onSearch:e(g),onChangeTableSize:e(z),onChangeTableColumn:e(L)},{form:t(({collapsed:u})=>[a(Q,{model:e(i),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[a(J,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!u},{default:t(()=>[a(C,null,{default:t(()=>[a(w,{label:"线路:"},{default:t(()=>[a(V,{modelValue:e(i).routeName,"onUpdate:modelValue":o[0]||(o[0]=s=>e(i).routeName=s),modelModifiers:{trim:!0},placeholder:"请输入线路"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(w,{label:"旅行分类:"},{default:t(()=>[a(O,{modelValue:e(i).travelType,"onUpdate:modelValue":o[1]||(o[1]=s=>e(i).travelType=s),options:e($)("travelType"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请选择旅行分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(w,{label:"供应商名称:"},{default:t(()=>[a(V,{modelValue:e(i).supName,"onUpdate:modelValue":o[2]||(o[2]=s=>e(i).supName=s),modelModifiers:{trim:!0},placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(w,{label:"地区:"},{default:t(()=>[a(O,{modelValue:e(i).areaName,"onUpdate:modelValue":o[3]||(o[3]=s=>e(i).areaName=s),placeholder:"请选择地区"},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(w,{label:"状态:"},{default:t(()=>[a(O,{modelValue:e(i).state,"onUpdate:modelValue":o[4]||(o[4]=s=>e(i).state=s),options:e($)("traveState"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请选择状态"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(w,{label:"出团日期:"},{default:t(()=>[a(A,{modelValue:e(i).startDate,"onUpdate:modelValue":o[5]||(o[5]=s=>e(i).startDate=s),class:"flex1",placeholder:"出团开始日期"},null,8,["modelValue"]),_e,a(A,{modelValue:e(i).endDate,"onUpdate:modelValue":o[6]||(o[6]=s=>e(i).endDate=s),class:"flex1",placeholder:"出团截止日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:t(()=>[a(q,null,{default:t(()=>[b((c(),_(p,{type:"outline",status:"success",disabled:!e(l).selectedKeys.length,onClick:o[7]||(o[7]=u=>M(e(l).selectedKeys))},{icon:t(()=>[a(B)]),default:t(()=>[m(" 批量通过 ")]),_:1},8,["disabled"])),[[e(n),"LineTourismExamineBatchSuccess"]]),b((c(),_(p,{type:"outline",status:"danger",disabled:!e(l).selectedKeys.length,onClick:o[8]||(o[8]=u=>e(T)("ZsExamineTourism"))},{icon:t(()=>[a(B)]),default:t(()=>[m(" 批量驳回 ")]),_:1},8,["disabled"])),[[e(n),"LineTourismExamineBatchFail"]])]),_:1})]),table:t(()=>[a(ee,{"selected-keys":e(l).selectedKeys,"onUpdate:selectedKeys":o[9]||(o[9]=u=>e(l).selectedKeys=u),class:"zs-table","row-key":"id",data:e(I),"row-selection":e(l).rowSelection,bordered:e(l).bordered,pagination:e(l).pagination,size:e(l).size,columns:e(E),stripe:e(l).stripe,loading:e(K)},{routeName:t(({record:u})=>[a(W,{onClick:s=>r.$router.push(`/line/addTourismManage/operate?mark=2&id=${u.id}&isReadOnly=true&name=${r.$route.name}`)},{default:t(()=>[m(se(u.routeName),1)]),_:2},1032,["onClick"])]),operate:t(({record:u})=>[a(Y,null,{default:t(()=>[b((c(),_(p,{type:"text",status:"success",onClick:s=>M([u.id])},{default:t(()=>[m("通过")]),_:2},1032,["onClick"])),[[e(n),"LineTourismExamineSuccess"]]),b((c(),_(p,{type:"text",status:"danger",onClick:s=>H([u.id])},{default:t(()=>[m("驳回")]),_:2},1032,["onClick"])),[[e(n),"LineTourismExamineFail"]]),a(X,{position:"br"},{content:t(()=>[a(q,{size:"mini"},{default:t(()=>[a(p,{type:"text",status:"warning",onClick:s=>r.$router.push(`/line/addTourismManage/operate?mark=2&id=${u.id}&isReadOnly=true&name=${r.$route.name}`)},{default:t(()=>[m("查看")]),_:2},1032,["onClick"]),b((c(),_(p,{type:"text",status:"warning",onClick:s=>r.$router.push(`/line/addTourismManage/operate?mark=1&id=${u.id}&name=${r.$route.name}`)},{default:t(()=>[m("编辑")]),_:2},1032,["onClick"])),[[e(n),"LineTourismExamineEdit"]]),b((c(),_(p,{type:"text",status:"warning",onClick:s=>j(u)},{default:t(()=>[m("查看行程单")]),_:2},1032,["onClick"])),[[e(n),"LineTourismExaminePreviewItinerary"]]),b((c(),_(p,{type:"text",status:"warning",onClick:s=>r.$router.push(`/line/addTourismManage/addTime?id=${u.id}&name=${r.$route.name}`)},{default:t(()=>[m("添加时间")]),_:2},1032,["onClick"])),[[e(n),"LineTourismExamineAddTime"]])]),_:2},1024)]),default:t(()=>[a(p,{type:"text",status:"warning"},{default:t(()=>[m("更多操作")]),_:1})]),_:2},1024)]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(h)==="ZsExamineTourism"?(c(),_(pe,{key:0,"id-list":e(l).selectedKeys,onSuccess:e(y),onClose:G},null,8,["id-list","onSuccess"])):ie("",!0)])}}});export{Te as default};

import{d as h,g as O,h as $,i as q,D as J,r as s,o as R,l as B,w as a,a as t,b as e,m as V,n as G,j as N,c as H,e as I,p as Q,q as X}from"./index-d007178a.js";import{f as K,t as Y,c as Z,_ as ee}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{A as te}from"./options-aafac76d.js";import{M as C}from"./major-b28f8c7d.js";import"./index-13860ba0.js";const ae=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"专业名称",dataIndex:"zymc",show:!0,align:"center",render:({record:c})=>K(c.zymc)},{title:"就业地区",dataIndex:"sf",show:!0,align:"center",render:({record:c})=>K(c.sf)},{title:"比例",dataIndex:"percent",show:!0,align:"center",render:({record:c})=>K(c.percent)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],oe=h({name:"zsAddEmployment"}),le=h({...oe,props:{data:{default:()=>({})}},emits:["close","success"],setup(c,{emit:b}){const _=c,y=O(),[m,S]=$(null),{form:d,formRef:v}=q(()=>({..._.data})),x={zymc:{required:!0,message:"请输入专业名称"},sf:{required:!0,message:"请输入就业地区"},zyId:{required:!0,message:"请输入专业ID"},percent:{required:!0,message:"请输入专业ID"},areaSort:{required:!0,message:"请输入排序"}},o=()=>{v.value.validate(p=>{p||(_.data.id?z("editWorkAreas"):z("addWorkAreas"))})},z=async p=>{const{err:r}=await V(()=>C[p](d.value),{before:()=>S("okLoading"),after:()=>S(null)});r||(b("success"),b("close"))};return J(()=>d.value.nBl,p=>{d.value.vBl=100-p}),(p,r)=>{const k=s("a-input"),f=s("a-form-item"),g=s("a-grid-item"),T=s("a-select"),A=s("a-input-number"),w=s("a-grid"),i=s("a-form"),l=s("a-modal");return R(),B(l,{title:e(Z)("就业地区",!!_.data.id),"unmount-on-close":"",visible:"",top:"15%",width:"50vw","align-center":!1,"mask-closable":!1,"ok-loading":e(m)==="okLoading",onCancel:r[4]||(r[4]=n=>b("close")),onOk:o},{default:a(()=>[t(i,{ref_key:"formRef",ref:v,model:e(d),"label-align":"left",size:"large","auto-label-width":"",rules:x},{default:a(()=>[t(w,{cols:2,"col-gap":24},{default:a(()=>[t(g,null,{default:a(()=>[t(f,{field:"zymc",label:"专业名称:"},{default:a(()=>[t(k,{modelValue:e(d).zymc,"onUpdate:modelValue":r[0]||(r[0]=n=>e(d).zymc=n),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"sf",label:"就业地区:"},{default:a(()=>[t(T,{modelValue:e(d).sf,"onUpdate:modelValue":r[1]||(r[1]=n=>e(d).sf=n),placeholder:"请输入就业地区","allow-search":"",options:[...e(te),...e(y).provinceList]},null,8,["modelValue","options"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"percent",label:"比例:"},{default:a(()=>[t(A,{modelValue:e(d).percent,"onUpdate:modelValue":r[2]||(r[2]=n=>e(d).percent=n),formatter:n=>e(Y)(n,""),parser:n=>n.replace(/,/g,""),precision:2,min:0,max:100,"hide-button":"",placeholder:"请输入比例"},null,8,["modelValue","formatter","parser","max"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(f,{field:"areaSort",label:"排序:"},{default:a(()=>[t(k,{modelValue:e(d).areaSort,"onUpdate:modelValue":r[3]||(r[3]=n=>e(d).areaSort=n),placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),ne=h({name:"MajorObtainEmployment"}),me=h({...ne,setup(c){const{warningModal:b}=X(),[_,y]=$(null);O();const{form:m,resetForm:S}=q(()=>({zyId:"",zymc:"",sf:""}),()=>z()),{selectRow:d,columnsData:v,visibleColumnsData:x,tableBaseOptions:o,resetData:z,extendTableList:p,setSelectRow:r,changeTableColumn:k,changeTableSize:f}=G(ae(),()=>w()),g=()=>{b(`确定删除选中的${o.selectedKeys.length}数据吗？`,async i=>{const{err:l}=await V(()=>C.deleteWorkAreas({ids:o.selectedKeys}),{successMsg:"操作成功"});l||(i(!0),o.selectedKeys=[],w())})},{data:T,loading:A,initData:w}=N(async()=>{const{res:i,err:l}=await V(()=>C.getWorkAreasList({...m.value,currentPage:o.pagination.current,pageSize:o.pagination.pageSize,pagingOrNot:"1"}));return l?[]:(o.pagination.total=i.data.totalCount,p(i==null?void 0:i.data.resultList))});return N(async()=>{const{res:i,err:l}=await V(()=>C.getMajorSelect({currentPage:o.pagination.current,pageSize:o.pagination.pageSize,pagingOrNot:"1"}));return l?[]:i.data.resultList.map(n=>({label:n.zymc,value:n.zymc}))}),(i,l)=>{const n=s("a-input"),L=s("a-form-item"),M=s("a-grid-item"),U=s("a-grid"),E=s("a-form"),P=s("icon-plus"),D=s("a-button"),W=s("icon-close"),j=s("a-space"),F=s("a-table");return R(),H("div",null,[t(ee,{"table-columns":e(v),"table-size":e(o).size,onResetSearch:e(S),onSearch:e(z),onChangeTableSize:e(f),onChangeTableColumn:e(k)},{form:a(()=>[t(E,{model:e(m),"label-align":"left",size:"large","auto-label-width":""},{default:a(()=>[t(U,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12},{default:a(()=>[t(M,null,{default:a(()=>[t(L,{field:"zymc",label:"专业名称:"},{default:a(()=>[t(n,{modelValue:e(m).zymc,"onUpdate:modelValue":l[0]||(l[0]=u=>e(m).zymc=u),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(M,null,{default:a(()=>[t(L,{field:"sf",label:"就业地区:"},{default:a(()=>[t(n,{modelValue:e(m).sf,"onUpdate:modelValue":l[1]||(l[1]=u=>e(m).sf=u),placeholder:"请输入就业地区"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:a(()=>[t(j,null,{default:a(()=>[t(D,{type:"outline",onClick:l[2]||(l[2]=u=>e(y)("zsAddEmployment"))},{icon:a(()=>[t(P)]),default:a(()=>[I(" 新增 ")]),_:1}),t(D,{type:"outline",status:"danger",disabled:!e(o).selectedKeys.length,loading:e(_)==="删除",onClick:g},{icon:a(()=>[t(W)]),default:a(()=>[I(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:a(()=>[t(F,{"selected-keys":e(o).selectedKeys,"onUpdate:selectedKeys":l[3]||(l[3]=u=>e(o).selectedKeys=u),class:"zs-table","row-key":"id",data:e(T),"row-selection":e(o).rowSelection,bordered:e(o).bordered,pagination:e(o).pagination,size:e(o).size,columns:e(x),stripe:e(o).stripe,loading:e(A)},{operate:a(({record:u})=>[t(D,{type:"text",onClick:se=>e(r)(u,()=>e(y)("zsAddEmployment"))},{default:a(()=>[I("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(_)==="zsAddEmployment"?(R(),B(le,{key:0,data:e(d),onSuccess:e(w),onClose:l[4]||(l[4]=u=>e(r)({},()=>e(y)(null)))},null,8,["data","onSuccess"])):Q("",!0)])}}});export{me as default};

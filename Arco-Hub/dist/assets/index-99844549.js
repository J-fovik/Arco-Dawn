import{f as b,U as T,d as x,g as O,h as $,i as M,j as K,k as J,r as n,o as Q,l as P,w as o,a as t,b as e,m as w,n as X,c as Z,e as L,p as ee,q as te}from"./index-d007178a.js";import{f as S,c as oe,_ as ae}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-430f1ffc.js";import{A as ne}from"./options-aafac76d.js";import"./index-13860ba0.js";const q={getEveryIssuesList:a=>b({method:"post",url:T.AI.EVERY_ISSUES_LIST,data:a}),addEveryIssues:a=>b({method:"post",url:T.AI.EVERY_ISSUES_ADD,data:a}),editEveryIssues:a=>b({method:"post",url:T.AI.EVERY_ISSUES_EDIT,data:a}),deleteEveryIssues:a=>b({method:"post",url:T.AI.EVERY_ISSUES_DELETE,data:a}),getAiQuestionType:a=>b({method:"post",url:T.AI.GET_QUESTION_AI_TYPE,data:a}),getAiQuestionTwoType:a=>b({method:"post",url:T.AI.GET_QUESTION_AI_TWO_TYPE,data:a})},le=()=>[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"排序",dataIndex:"qsort",show:!0,align:"center",render:({record:a})=>S(a.qsort)},{title:"问题类型",dataIndex:"qtype",show:!0,align:"center",render:({record:a})=>S(a.qtype)},{title:"问题",dataIndex:"question",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:a})=>S(a.question)},{title:"创建时间",dataIndex:"createTime",show:!0,align:"center",render:({record:a})=>S(a.createTime)},{title:"二级分类",dataIndex:"qtypeTwo",show:!0,tooltip:!0,ellipsis:!0,align:"center",render:({record:a})=>S(a.qtypeTwo)},{title:"操作",width:100,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}],se=x({name:"zsAddAssessmentQuestions"}),re=x({...se,props:{data:{default:()=>({})}},emits:["close","success"],setup(a,{emit:I}){const g=a;O();const[v,m]=$(null),{form:i,formRef:C}=M(()=>({...g.data})),z={qtype:{required:!0,message:"请选择问题类型"},question:{required:!0,message:"请输入问题"},qsort:{required:!0,message:"请输入排序"}},U=()=>{C.value.validate(c=>{c||(g.data.id?l("editEveryIssues"):l("addEveryIssues"))})},l=async c=>{const{err:s}=await w(()=>q[c](i.value),{before:()=>m("okLoading"),after:()=>m(null)});s||(I("success"),I("close"))},{data:V}=K(async()=>{const{res:c,err:s}=await w(()=>q.getAiQuestionType({}));return s?[]:c.data.map(f=>f.qtype)}),h=J([]),k=async()=>{const{res:c,err:s}=await w(()=>q.getAiQuestionTwoType({qtype:i.value.qtype}));if(s)return[];const f=c.data.map(p=>({label:p.qtypeTwo,value:p.qtypeTwo?p.qtypeTwo:""}));i.value.qtypeTwo="",h.value=f};return(c,s)=>{const f=n("a-select"),p=n("a-form-item"),y=n("a-grid-item"),A=n("a-input"),R=n("a-input-number"),u=n("a-grid"),r=n("a-form"),E=n("a-modal");return Q(),P(E,{title:e(oe)("大家关心的问题",!!g.data.id),"unmount-on-close":"",visible:"",top:"10%",width:"40vw","align-center":!1,"mask-closable":!1,"ok-loading":e(v)==="okLoading",onCancel:s[4]||(s[4]=d=>I("close")),onOk:U},{default:o(()=>[t(r,{ref_key:"formRef",ref:C,model:e(i),"label-align":"left",size:"large","auto-label-width":"",rules:z},{default:o(()=>[t(u,{cols:2,"col-gap":24},{default:o(()=>[t(y,null,{default:o(()=>[t(p,{label:"问题类型:",field:"qtype"},{default:o(()=>[t(f,{modelValue:e(i).qtype,"onUpdate:modelValue":s[0]||(s[0]=d=>e(i).qtype=d),placeholder:"请选择问题类型","allow-clear":"",options:e(V),onChange:k},null,8,["modelValue","options"])]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(p,{label:"二级分类:"},{default:o(()=>[t(f,{modelValue:e(i).qtypeTwo,"onUpdate:modelValue":s[1]||(s[1]=d=>e(i).qtypeTwo=d),placeholder:"请选择二级分类","path-mode":"","allow-search":"","allow-clear":"",options:h.value},null,8,["modelValue","options"])]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(p,{label:"问题:",field:"question"},{default:o(()=>[t(A,{modelValue:e(i).question,"onUpdate:modelValue":s[2]||(s[2]=d=>e(i).question=d),modelModifiers:{trim:!0},placeholder:"请输入问题"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(p,{label:"排序:",field:"qsort"},{default:o(()=>[t(R,{modelValue:e(i).qsort,"onUpdate:modelValue":s[3]||(s[3]=d=>e(i).qsort=d),placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","ok-loading"])}}}),ie=x({name:"EvaluationConcernedAboutIssues"}),_e=x({...ie,setup(a){const{warningModal:I}=te(),[g,v]=$(null);O();const{form:m,resetForm:i}=M(()=>({qtype:"",question:""}),()=>V()),{selectRow:C,columnsData:z,visibleColumnsData:U,tableBaseOptions:l,resetData:V,extendTableList:h,setSelectRow:k,changeTableColumn:c,changeTableSize:s}=X(le(),()=>A()),f=()=>{I(`确定删除选中的${l.selectedKeys.length}数据吗？`,async u=>{const{err:r}=await w(()=>q.deleteEveryIssues({ids:l.selectedKeys}),{successMsg:"操作成功"});r||(u(!0),l.selectedKeys=[],A())})},{data:p,loading:y,initData:A}=K(async()=>{const{res:u,err:r}=await w(()=>q.getEveryIssuesList({...m.value,currentPage:l.pagination.current,pageSize:l.pagination.pageSize,pagingOrNot:"1"}));return r?[]:(l.pagination.total=u.data.totalCount,h(u==null?void 0:u.data.resultList))}),{data:R}=K(async()=>{const{res:u,err:r}=await w(()=>q.getAiQuestionType({}));return r?[]:u.data.map(E=>E.qtype)});return(u,r)=>{const E=n("a-select"),d=n("a-form-item"),N=n("a-grid-item"),Y=n("a-input"),B=n("a-grid"),F=n("a-form"),G=n("icon-plus"),D=n("a-button"),j=n("icon-close"),W=n("a-space"),H=n("a-table");return Q(),Z("div",null,[t(ae,{"table-columns":e(z),"table-size":e(l).size,onResetSearch:e(i),onSearch:e(V),onChangeTableSize:e(s),onChangeTableColumn:e(c)},{form:o(()=>[t(F,{model:e(m),"label-align":"left",size:"large","auto-label-width":""},{default:o(()=>[t(B,{cols:{md:3,lg:3,xl:3,xxl:3},"col-gap":12},{default:o(()=>[t(N,null,{default:o(()=>[t(d,{label:"问题类型:"},{default:o(()=>[t(E,{modelValue:e(m).qtype,"onUpdate:modelValue":r[0]||(r[0]=_=>e(m).qtype=_),placeholder:"请选择问题类型","allow-clear":"",options:[...e(ne),...e(R)]},null,8,["modelValue","options"])]),_:1})]),_:1}),t(N,null,{default:o(()=>[t(d,{label:"问题:"},{default:o(()=>[t(Y,{modelValue:e(m).question,"onUpdate:modelValue":r[1]||(r[1]=_=>e(m).question=_),modelModifiers:{trim:!0},placeholder:"请输入问题"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),operate:o(()=>[t(W,null,{default:o(()=>[t(D,{type:"outline",onClick:r[2]||(r[2]=_=>e(v)("zsAddConcernedAboutIssues"))},{icon:o(()=>[t(G)]),default:o(()=>[L(" 新增 ")]),_:1}),t(D,{type:"outline",status:"danger",disabled:!e(l).selectedKeys.length,loading:e(g)==="删除",onClick:f},{icon:o(()=>[t(j)]),default:o(()=>[L(" 删除 ")]),_:1},8,["disabled","loading"])]),_:1})]),table:o(()=>[t(H,{"selected-keys":e(l).selectedKeys,"onUpdate:selectedKeys":r[3]||(r[3]=_=>e(l).selectedKeys=_),class:"zs-table","row-key":"id",data:e(p),"row-selection":e(l).rowSelection,bordered:e(l).bordered,pagination:e(l).pagination,size:e(l).size,columns:e(U),stripe:e(l).stripe,loading:e(y)},{operate:o(({record:_})=>[t(D,{type:"text",onClick:ue=>e(k)(_,()=>e(v)("zsAddConcernedAboutIssues"))},{default:o(()=>[L("编辑")]),_:2},1032,["onClick"])]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(g)==="zsAddConcernedAboutIssues"?(Q(),P(re,{key:0,data:e(C),onSuccess:e(A),onClose:r[4]||(r[4]=_=>e(k)({},()=>e(v)(null)))},null,8,["data","onSuccess"])):ee("",!0)])}}});export{_e as default};

import{d as h,u as E,a as P,C as F,E as L,s as K,b as z,I as G,r as d,o as i,l as c,w as n,g as t,c as l,h as f,e as M,i as v,F as W,f as k,k as _,G as J,H as X,_ as Y}from"./index-8a2cb146.js";import{Z as $}from"./index-2bbe694f.js";import{C as ee}from"./options-c598719d.js";import{B as y}from"./business-b0ce0e8a.js";const ae=m=>(J("data-v-70c83748"),m=m(),X(),m),le=ae(()=>k("div",{style:{height:"100px"}},null,-1)),te={class:"orderSubmit-footer box-flex jc-fe"},oe=h({name:"BusinessPageContractManagerOperate"}),re=h({...oe,setup(m){const s=E(),{getDictionaryInfo:R}=P(),{jumpTabName:V}=F(),[T,N]=L(null),{form:a,formRef:g,formPlaceholder:I}=K(()=>({state:"",contractNumber:"",departName:"",departNo:"",employeeName:"",employeeId:"",contType:"",qianZ:"",houZ:"",qjQ:1,qjH:100,remark:""})),w={departName:{required:!0,message:"请输入营业部名称"},employeeName:{required:!0,message:"请选择领用人姓名"},contType:{required:!0,message:"请选择旅游类别"},qianZ:{required:!0,message:"请输入前缀"},houZ:{required:!0,message:"请输入后缀"},qjQ:{required:!0,validator:(o,e)=>{a.value.qjQ||e("请输入区间起点"),a.value.qjQ>a.value.qjH&&e("区间起点不能大于区间终点")}},qjH:{required:!0,validator:(o,e)=>{a.value.qjH||e("请输入区间终点"),a.value.qjH<a.value.qjQ&&e("区间终点不能小于区间起点")}}},{data:b}=z(async()=>{const{err:o,res:e}=await _(()=>y.getDepartsBox({}));if(!o)return e==null?void 0:e.data}),{data:x}=G(async()=>{const{res:o,err:e}=await _(()=>y.getRecipientBox({departNo:a.value.departNo}));return e?[]:(s.query.isReadOnly||(a.value.employeeName="",a.value.employeeId=""),o==null?void 0:o.data)},{watchSource:()=>a.value.departName,defaultValue:[]}),U=o=>{a.value.departNo=b.value.find(e=>e.name==o).code},Z=o=>{a.value.employeeId=x.value.find(e=>e.username==o).userId},O=()=>{g.value.validate(o=>{o||B()})},B=async()=>{const{err:o}=await _(()=>y.isSureContract(a.value),{before:()=>N("okLoading"),after:()=>N(null)});o||V()},D=async()=>{const{res:o,err:e}=await _(()=>y.getRecipientDetail({id:s.query.id}));e||(a.value=o==null?void 0:o.data)};return s.query.isReadOnly&&D(),(o,e)=>{const q=d("a-input"),u=d("a-form-item"),p=d("a-select"),j=d("a-input-number"),S=d("a-space"),H=d("a-textarea"),Q=d("a-form"),A=d("a-card"),C=d("a-button");return i(),c($,null,{default:n(()=>[t(A,{title:"纸质合同详情",bordered:!1,class:"general-card"},{default:n(()=>[t(Q,{ref_key:"formRef",ref:g,model:l(a),"label-align":"left",size:"large",style:{width:"800px","padding-left":"100px"},"auto-label-width":"",disabled:!!l(s).query.isReadOnly,rules:w},{default:n(()=>[l(s).query.isReadOnly?(i(),c(u,{key:0,label:"合同编号:",required:""},{default:n(()=>[t(q,{modelValue:l(a).contractNumber,"onUpdate:modelValue":e[0]||(e[0]=r=>l(a).contractNumber=r),placeholder:"请输入合同编号"},null,8,["modelValue"])]),_:1})):f("",!0),t(u,{field:"departName",label:"营业部名称",required:""},{default:n(()=>[t(p,{modelValue:l(a).departName,"onUpdate:modelValue":e[1]||(e[1]=r=>l(a).departName=r),"virtual-list-props":{height:200},options:l(b),"field-names":{label:"name",value:"name"},"allow-search":"",placeholder:"请选择营业部名称（可搜索）",onChange:U},null,8,["modelValue","options"])]),_:1}),t(u,{field:"employeeName",label:"领用人姓名",required:""},{default:n(()=>[t(p,{modelValue:l(a).employeeName,"onUpdate:modelValue":e[2]||(e[2]=r=>l(a).employeeName=r),options:l(x),"field-names":{label:"username",value:"username"},placeholder:"请选择领用人姓名",onChange:Z},null,8,["modelValue","options"])]),_:1}),t(u,{field:"contType",label:"旅游类别",required:""},{default:n(()=>[t(p,{modelValue:l(a).contType,"onUpdate:modelValue":e[3]||(e[3]=r=>l(a).contType=r),options:l(R)("travelType"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请选择旅游类别"},null,8,["modelValue","options"])]),_:1}),l(s).query.isReadOnly?f("",!0):(i(),M(W,{key:1},[t(u,{field:"qianZ",label:"前缀:",required:""},{default:n(()=>[t(q,{modelValue:l(a).qianZ,"onUpdate:modelValue":e[4]||(e[4]=r=>l(a).qianZ=r),placeholder:"请输入前缀"},null,8,["modelValue"])]),_:1}),t(u,{field:"houZ",label:"后缀:",required:""},{default:n(()=>[t(q,{modelValue:l(a).houZ,"onUpdate:modelValue":e[5]||(e[5]=r=>l(a).houZ=r),placeholder:"请输入后缀"},null,8,["modelValue"])]),_:1}),t(u,{field:"qjQ",label:"区间:",required:""},{default:n(()=>[t(j,{modelValue:l(a).qjQ,"onUpdate:modelValue":e[6]||(e[6]=r=>l(a).qjQ=r),min:0,max:100},null,8,["modelValue"]),t(S,{style:{padding:"10px"}},{default:n(()=>[v("到")]),_:1}),t(j,{modelValue:l(a).qjH,"onUpdate:modelValue":e[7]||(e[7]=r=>l(a).qjH=r),min:0,max:100},null,8,["modelValue"])]),_:1})],64)),l(s).query.isReadOnly?(i(),c(u,{key:2,label:"状态:",required:""},{default:n(()=>[t(p,{modelValue:l(a).state,"onUpdate:modelValue":e[8]||(e[8]=r=>l(a).state=r),placeholder:"请选择状态",options:l(ee)},null,8,["modelValue","options"])]),_:1})):f("",!0),t(u,{field:"remark",label:"备注:"},{default:n(()=>[t(H,{modelValue:l(a).remark,"onUpdate:modelValue":e[9]||(e[9]=r=>l(a).remark=r),placeholder:l(I)("请输入备注")},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model","disabled"])]),_:1}),le,k("div",te,[t(S,null,{default:n(()=>[l(s).query.isReadOnly?f("",!0):(i(),c(C,{key:0,type:"primary",loading:l(T)==="确定",onClick:O},{default:n(()=>[v("确定")]),_:1},8,["loading"])),t(C,{onClick:e[10]||(e[10]=()=>l(V)())},{default:n(()=>[v("返回")]),_:1})]),_:1})])]),_:1})}}});const ie=Y(re,[["__scopeId","data-v-70c83748"]]);export{ie as default};

import{d as N,u as G,D as I,E as M,s as H,b as Y,C as J,r as s,o as K,l as L,w as a,g as e,c as t,i as u,f as P,h as Q,k as f,G as X,H as $,S as _,_ as ee}from"./index-8a2cb146.js";import{Z as ae}from"./index-2bbe694f.js";const le=p=>(X("data-v-8ec81208"),p=p(),$(),p),te=le(()=>P("div",{style:{height:"100px"}},null,-1)),oe={class:"orderSubmit-footer box-flex jc-fe"},de=N({name:"SystemRoleOperate"}),re=N({...de,setup(p){const i=G(),y=I([]),V=I([]),[B,R]=M(!1),[T,v]=M(null),{form:d,formRef:b,formPlaceholder:g}=H(()=>({roleCode:"",rolename:"",roleDesc:"",remark:"",privWrite:"1",privRead:"1",privVerify:"1"})),W={rolename:{required:!0,message:"请输入角色名称"},roleCode:{required:!0,message:"请输入角色代码"},roleDesc:{required:!0,message:"请输入角色说明"}},{data:A}=Y(async()=>{const{res:o}=await f(()=>_.getMenuList({}));return(o==null?void 0:o.data.menuList)??[]}),{jumpTabName:h}=J(),O=async()=>{b.value.validate(o=>{o||(i.query.id?q("editRole"):q("addRole"))})},q=async o=>{const{err:l}=await f(()=>_[o](d.value),{before:()=>v("确定"),after:()=>v(null)});l||!await E()||h()},j=async()=>{const{err:o,res:l}=await f(()=>_.getRoleKeyList({roleId:i.query.id}));R(!1),!o&&(y.value=l==null?void 0:l.data.map(k=>k.menuId))},E=async()=>{const{res:o}=await f(()=>_.editRoleKey({roleId:i.query.id,menuIdList:[...y.value,...V.value]}),{successMsg:"权限更新成功",before:()=>v("确定"),after:()=>v(null)});return!!o},Z=async()=>{const{res:o,err:l}=await f(()=>_.getRoleDetail({id:i.query.id}));l||(d.value=o==null?void 0:o.data)};return i.query.id&&(R(!0),Z(),j()),(o,l)=>{const k=s("a-tree"),x=s("a-card"),n=s("a-grid-item"),C=s("a-input"),c=s("a-form-item"),w=s("a-textarea"),m=s("a-radio"),D=s("a-radio-group"),S=s("a-grid"),z=s("a-form"),U=s("a-button"),F=s("a-space");return K(),L(ae,null,{default:a(()=>[e(S,{cols:5,"col-gap":12},{default:a(()=>[e(n,{span:2},{default:a(()=>[e(x,{class:"general-card",loading:t(B),title:"权限阅览"},{default:a(()=>[e(k,{"checked-keys":y.value,"onUpdate:checkedKeys":l[0]||(l[0]=r=>y.value=r),"half-checked-keys":V.value,"onUpdate:halfCheckedKeys":l[1]||(l[1]=r=>V.value=r),checkable:"","show-line":"","only-check-leaf":"","default-expand-all":!1,fieldNames:{key:"id",title:"title",children:"children",icon:""},data:t(A)},null,8,["checked-keys","half-checked-keys","data"])]),_:1},8,["loading"])]),_:1}),e(n,{span:3},{default:a(()=>[e(x,{class:"general-card",title:"角色信息"},{default:a(()=>[e(z,{model:t(d),ref_key:"formRef",ref:b,size:"large",rules:W,disabled:!!t(i).query.isReadOnly,"auto-label-width":""},{default:a(()=>[e(S,{cols:1,"col-gap":20},{default:a(()=>[e(n,null,{default:a(()=>[e(c,{label:"角色名称:",field:"rolename",required:""},{default:a(()=>[e(C,{modelValue:t(d).rolename,"onUpdate:modelValue":l[2]||(l[2]=r=>t(d).rolename=r),modelModifiers:{trim:!0},placeholder:t(g)("请输入角色名称")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(c,{label:"角色编码:",field:"roleCode",required:""},{default:a(()=>[e(C,{modelValue:t(d).roleCode,"onUpdate:modelValue":l[3]||(l[3]=r=>t(d).roleCode=r),modelModifiers:{trim:!0},placeholder:t(g)("请输入角色编码")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(c,{label:"角色说明:",field:"roleDesc",required:""},{default:a(()=>[e(w,{modelValue:t(d).roleDesc,"onUpdate:modelValue":l[4]||(l[4]=r=>t(d).roleDesc=r),modelModifiers:{trim:!0},placeholder:t(g)("请输入角色名称")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(c,{label:"备注:",field:"remark"},{default:a(()=>[e(w,{modelValue:t(d).remark,"onUpdate:modelValue":l[5]||(l[5]=r=>t(d).remark=r),modelModifiers:{trim:!0},placeholder:t(g)("请输入备注")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(c,{label:"数据写权限:",field:"privWrite",required:""},{default:a(()=>[e(D,{modelValue:t(d).privWrite,"onUpdate:modelValue":l[6]||(l[6]=r=>t(d).privWrite=r)},{default:a(()=>[e(m,{value:"1"},{default:a(()=>[u("全局")]),_:1}),e(m,{value:"2"},{default:a(()=>[u("部门")]),_:1}),e(m,{value:"3"},{default:a(()=>[u("个人")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(c,{label:"数据读权限:",field:"privRead",required:""},{default:a(()=>[e(D,{modelValue:t(d).privRead,"onUpdate:modelValue":l[7]||(l[7]=r=>t(d).privRead=r)},{default:a(()=>[e(m,{value:"1"},{default:a(()=>[u("全局")]),_:1}),e(m,{value:"2"},{default:a(()=>[u("部门")]),_:1}),e(m,{value:"3"},{default:a(()=>[u("个人")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","disabled"])]),_:1})]),_:1})]),_:1}),te,P("div",oe,[e(F,null,{default:a(()=>[t(i).query.isReadOnly?Q("",!0):(K(),L(U,{key:0,loading:t(T)==="确定",type:"primary",onClick:O},{default:a(()=>[u("确定")]),_:1},8,["loading"])),e(U,{onClick:l[8]||(l[8]=()=>t(h)())},{default:a(()=>[u("返回")]),_:1})]),_:1})])]),_:1})}}});const ue=ee(re,[["__scopeId","data-v-8ec81208"]]);export{ue as default};

import{b as G}from"./browser-e933942f.js";import{a as J,n as y,d as h,E as Z,s as E,r as i,o as p,l as _,w as t,g as a,c as e,k as z,i as g,q as se,v as ie,x as re,y as de,e as H,z as k,F as ue,h as P,f as me,ab as pe,A as ce}from"./index-8a2cb146.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_name_ZsSearchTableMould_lang-54cd5f3e.js";import{L as q}from"./line-7661aa01.js";import"./index-2bbe694f.js";const _e=()=>{const{getDictionaryItem:T}=J();return[{title:"线路名称",dataIndex:"routeName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:l})=>y(l.routeName)},{title:"地区",dataIndex:"areaName",show:!0,align:"center",render:({record:l})=>y(l.areaName)},{title:"旅行分类",dataIndex:"travelType",show:!0,align:"center",render:({record:l})=>y(T("travelType",l.travelType).detailName)},{title:"成团类别",dataIndex:"groupType",show:!0,align:"center",render:({record:l})=>y(T("new_group_type",l.groupType).detailName)},{title:"天数",dataIndex:"travelDays",show:!0,align:"center",render:({record:l})=>y(l.travelDays)},{title:"供应商名称",dataIndex:"supName",show:!0,ellipsis:!0,tooltip:!0,align:"center",render:({record:l})=>y(l.supName)},{title:"状态",dataIndex:"state",show:!0,align:"center",render:({record:l})=>y(T("traveState",l.state).detailName)},{title:"出团日期开始",dataIndex:"startDate",show:!0,align:"center",render:({record:l})=>y(l.startDate)},{title:"出团日期截止",dataIndex:"endDate",show:!0,align:"center",render:({record:l})=>y(l.endDate)},{title:"操作",width:300,dataIndex:"operate",slotName:"operate",show:!0,align:"center"}]},ge=h({name:"ZsOffShelf"}),ve=h({...ge,props:{data:{default:()=>({})}},emits:["close","success"],setup(T,{emit:l}){const f=T,[M,w]=Z(""),{form:m,formRef:n}=E(()=>({auditOpinion:""})),L={auditOpinion:{required:!0,message:"请输入下架原因"}},b=l,A=()=>{n.value.validate(r=>{r||O()})},O=async()=>{const{err:r}=await z(()=>q.offShelfTouristRoutes({id:f.data.id,...m.value}),{before:()=>w("okLoading"),after:()=>w(""),successMsg:"下架成功"});r||(b("success"),b("close"))};return(r,c)=>{const x=i("a-textarea"),C=i("a-form-item"),V=i("a-form"),U=i("a-modal");return p(),_(U,{top:"10%",width:"500px",title:"线路下架","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(M)==="okLoading",onCancel:c[1]||(c[1]=$=>b("close")),onOk:A},{default:t(()=>[a(V,{ref_key:"formRef",ref:n,model:e(m),"label-align":"left",size:"large","auto-label-width":"",rules:L},{default:t(()=>[a(C,{field:"auditOpinion",label:"下架原因:",required:""},{default:t(()=>[a(x,{modelValue:e(m).auditOpinion,"onUpdate:modelValue":c[0]||(c[0]=$=>e(m).auditOpinion=$),placeholder:"请输入下架原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),be=h({name:"ZsStopTourism"}),ye=h({...be,props:{data:{default:()=>({})}},emits:["close","success"],setup(T,{emit:l}){const f=T,[M,w]=Z(""),{form:m,formRef:n}=E(()=>({state:"3",auditOpinion:""})),L={auditOpinion:{required:!0,message:"请输入停线原因"}},b=l,A=()=>{n.value.validate(r=>{r||O()})},O=async()=>{const{err:r}=await z(()=>q.stopTouristRoutes({id:f.data.id,...m.value}),{before:()=>w("okLoading"),after:()=>w(""),successMsg:"停线成功"});r||(b("success"),b("close"))};return(r,c)=>{const x=i("a-radio"),C=i("a-radio-group"),V=i("a-form-item"),U=i("a-textarea"),$=i("a-form"),K=i("a-modal");return p(),_(K,{top:"10%",width:"500px",title:"线路下架","unmount-on-close":"",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(M)==="okLoading",onCancel:c[2]||(c[2]=S=>b("close")),onOk:A},{default:t(()=>[a($,{ref_key:"formRef",ref:n,model:e(m),"label-align":"left",size:"large","auto-label-width":"",rules:L},{default:t(()=>[a(V,{field:"state",label:"下架原因:",required:""},{default:t(()=>[a(C,{modelValue:e(m).state,"onUpdate:modelValue":c[0]||(c[0]=S=>e(m).state=S)},{default:t(()=>[a(x,{value:"3"},{default:t(()=>[g("临时停线")]),_:1}),a(x,{value:"4"},{default:t(()=>[g("永久停线")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(V,{field:"auditOpinion",label:"下架原因:",required:""},{default:t(()=>[a(U,{modelValue:e(m).auditOpinion,"onUpdate:modelValue":c[1]||(c[1]=S=>e(m).auditOpinion=S),placeholder:"请输入下架原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["ok-loading"])}}}),ke=me("span",{class:"mx-3"},"-",-1),Te=h({name:"LineAddTourismManage"}),Se=h({...Te,setup(T){const{getDictionaryInfo:l}=J(),{vAuthority:f}=se(),{warningModal:M}=ce(),[w,m]=Z(""),{form:n,resetForm:L}=E(()=>({routeName:"",travelType:"",supName:"",areaName:"",state:"",startDate:"",endDate:"",qrUrl:""}),()=>c()),{selectRow:b,columnsData:A,visibleColumnsData:O,tableBaseOptions:r,resetData:c,extendTableList:x,setSelectRow:C,changeTableColumn:V,changeTableSize:U}=ie(_e(),()=>R()),$=d=>{M("确定删除该数据吗？",async o=>{const{err:I}=await z(()=>q.deleteTouristRoutes({id:d.id}),{successMsg:"操作成功"});I||(o(!0),R())})},{data:K,loading:S,initData:R}=re(async()=>{const{res:d,err:o}=await z(()=>q.getTouristRoutesList({...n.value,currentPage:r.pagination.current,pageSize:r.pagination.pageSize,pagingOrNot:"1"}));return o?[]:(r.pagination.total=d.data.totalCount,x(d==null?void 0:d.data.travelRouteList))}),W=d=>{window.open(`/trip?id=${d.id}`)},X=async(d,o)=>{d?n.value.qrUrl=await G.toDataURL(`${window.location.origin}/trip?id=${o.id}`,{margin:1}):n.value.qrUrl=""},Y=async d=>{const o=await G.toDataURL(`${window.location.origin}/trip?id=${d.id}`,{margin:1});pe(o,d.routeName)};return de(R),(d,o)=>{const I=i("a-input"),D=i("a-form-item"),N=i("a-grid-item"),B=i("a-select"),F=i("a-date-picker"),ee=i("a-grid"),te=i("a-form"),ae=i("icon-plus"),v=i("a-button"),oe=i("a-space"),ne=i("a-image"),Q=i("a-popover"),j=i("a-button-group"),le=i("a-table");return p(),H("div",null,[a(fe,{fold:"","table-columns":e(A),"table-size":e(r).size,onResetSearch:e(L),onSearch:e(c),onChangeTableSize:e(U),onChangeTableColumn:e(V)},{form:t(({collapsed:u})=>[a(te,{model:e(n),"label-align":"left",size:"large","auto-label-width":""},{default:t(()=>[a(ee,{cols:{md:3,lg:3,xl:3,xxl:4},"col-gap":12,collapsed:!u},{default:t(()=>[a(N,null,{default:t(()=>[a(D,{label:"线路:"},{default:t(()=>[a(I,{modelValue:e(n).routeName,"onUpdate:modelValue":o[0]||(o[0]=s=>e(n).routeName=s),modelModifiers:{trim:!0},placeholder:"请输入线路"},null,8,["modelValue"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(D,{label:"旅行分类:"},{default:t(()=>[a(B,{modelValue:e(n).travelType,"onUpdate:modelValue":o[1]||(o[1]=s=>e(n).travelType=s),options:e(l)("travelType"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请选择旅行分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(D,{label:"供应商名称:"},{default:t(()=>[a(I,{modelValue:e(n).supName,"onUpdate:modelValue":o[2]||(o[2]=s=>e(n).supName=s),modelModifiers:{trim:!0},placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(D,{label:"地区:"},{default:t(()=>[a(B,{modelValue:e(n).areaName,"onUpdate:modelValue":o[3]||(o[3]=s=>e(n).areaName=s),placeholder:"请选择地区"},null,8,["modelValue"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(D,{label:"状态:"},{default:t(()=>[a(B,{modelValue:e(n).state,"onUpdate:modelValue":o[4]||(o[4]=s=>e(n).state=s),options:e(l)("traveState"),"field-names":{label:"detailName",value:"detailCode"},placeholder:"请选择状态"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(D,{label:"出团日期:"},{default:t(()=>[a(F,{modelValue:e(n).startDate,"onUpdate:modelValue":o[5]||(o[5]=s=>e(n).startDate=s),class:"flex1",placeholder:"出团开始日期"},null,8,["modelValue"]),ke,a(F,{modelValue:e(n).endDate,"onUpdate:modelValue":o[6]||(o[6]=s=>e(n).endDate=s),class:"flex1",placeholder:"出团截止日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:2},1032,["collapsed"])]),_:2},1032,["model"])]),operate:t(()=>[a(oe,null,{default:t(()=>[k((p(),_(v,{type:"outline",onClick:o[7]||(o[7]=u=>d.$router.push("/line/addTourismManage/operate?mark=0"))},{icon:t(()=>[a(ae)]),default:t(()=>[g(" 新增 ")]),_:1})),[[e(f),"LineAddTourismManageAdd"]])]),_:1})]),table:t(()=>[a(le,{"selected-keys":e(r).selectedKeys,"onUpdate:selectedKeys":o[8]||(o[8]=u=>e(r).selectedKeys=u),class:"zs-table","row-key":"id",data:e(K),"row-selection":e(r).rowSelection,bordered:e(r).bordered,pagination:e(r).pagination,size:e(r).size,columns:e(O),stripe:e(r).stripe,loading:e(S)},{operate:t(({record:u})=>[a(j,null,{default:t(()=>[k((p(),_(v,{type:"text",status:"success",onClick:s=>d.$router.push(`/line/addTourismManage/operate?mark=4&id=${u.id}`)},{default:t(()=>[g("一键复制")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageCopy"]]),a(Q,{onPopupVisibleChange:s=>X(s,u)},{content:t(()=>[a(ne,{src:e(n).qrUrl,width:"100",height:"100"},null,8,["src"])]),default:t(()=>[k((p(),_(v,{type:"text",status:"warning",onClick:s=>Y(u)},{default:t(()=>[g("二维码")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageQrCode"]])]),_:2},1032,["onPopupVisibleChange"]),a(Q,{position:"br"},{content:t(()=>[a(j,null,{default:t(()=>[a(v,{type:"text",status:"success",onClick:s=>d.$router.push(`/line/addTourismManage/operate?mark=2&id=${u.id}&isReadOnly=true`)},{default:t(()=>[g("查看")]),_:2},1032,["onClick"]),k((p(),_(v,{type:"text",status:"danger",onClick:s=>$(u)},{default:t(()=>[g("删除")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageDelete"]]),k((p(),_(v,{type:"text",status:"success",onClick:s=>d.$router.push(`/line/addTourismManage/operate?mark=1&id=${u.id}`)},{default:t(()=>[g("编辑")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageEdit"]]),["0"].includes(u.state)?P("",!0):(p(),H(ue,{key:0},[k((p(),_(v,{type:"text",status:"warning",onClick:s=>e(C)(u,()=>e(m)("ZsOffShelfTourism"))},{default:t(()=>[g("下架")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageOffShelf"]]),k((p(),_(v,{type:"text",status:"danger",onClick:s=>e(C)(u,()=>e(m)("ZsStopTourism"))},{default:t(()=>[g("停线")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageStop"]])],64)),k((p(),_(v,{type:"text",status:"warning",onClick:s=>W(u)},{default:t(()=>[g("查看行程单")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManagePreviewItinerary"]]),k((p(),_(v,{type:"text",onClick:s=>d.$router.push(`/line/addTourismManage/addTime?id=${u.id}`)},{default:t(()=>[g("添加时间")]),_:2},1032,["onClick"])),[[e(f),"LineAddTourismManageAddTime"]])]),_:2},1024)]),default:t(()=>[a(v,{type:"text"},{default:t(()=>[g("更多操作")]),_:1})]),_:2},1024)]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["table-columns","table-size","onResetSearch","onSearch","onChangeTableSize","onChangeTableColumn"]),e(w)==="ZsOffShelfTourism"?(p(),_(ve,{key:0,data:e(b),onSuccess:e(R),onClose:o[9]||(o[9]=u=>e(C)({},()=>e(m)("")))},null,8,["data","onSuccess"])):P("",!0),e(w)==="ZsStopTourism"?(p(),_(ye,{key:1,data:e(b),onSuccess:e(R),onClose:o[10]||(o[10]=u=>e(C)({},()=>e(m)("")))},null,8,["data","onSuccess"])):P("",!0)])}}});export{Se as default};

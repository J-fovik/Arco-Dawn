import{X as j,d as I,E as H,s as W,v as le,b as te,r as i,o as M,l as z,w as l,g as a,c as e,i as S,V as B,k as w,S as q,u as Z,R as G,e as oe,h as J,f as O,_ as X,D as E,C as ne,a as de,M as se,I as ie,J as h,W as re,G as ue,H as me,Y as pe}from"./index-8a2cb146.js";import{p as ce}from"./rules-4aeaef32.js";import{Z as fe}from"./index-2bbe694f.js";const _e=[{title:"线路名称",show:!0,dataIndex:"linename"},{title:"线路创建时间",show:!0,dataIndex:"createTime",render:({record:g})=>j(g.createTime,"YYYY-MM-DD")},{title:"操作",show:!0,width:100,dataIndex:"operate",align:"center",slotName:"operate"}],A=[{title:"序号",width:80,dataIndex:"sortTableNo",show:!0,align:"center"},{title:"线路名称",show:!0,dataIndex:"linename"},{title:"线路说明",show:!0,dataIndex:"lineDesc"},{title:"线路创建时间",show:!0,dataIndex:"createTime",render:({record:g})=>j(g.createTime,"YYYY-MM-DD")}],be=I({name:"ZsSelectLine"}),ye=I({...be,emits:["close","confirm"],setup(g,{emit:b}){const[v,c]=H(null),{form:V}=W(()=>({linename:""})),{selectRow:D,columnsData:C,visibleColumnsData:s,tableBaseOptions:t,resetData:p,extendTableList:r,setSelectRow:x,changeTableColumn:N,changeTableSize:U}=le([A[0],A[1],A[2],A[3]],()=>K()),k=b,{data:f,loading:y,initData:K}=te(async()=>{const{res:R,err:d}=await w(()=>q.getCooperationRouteList({...V.value,currentPage:t.pagination.current,pageSize:t.pagination.pageSize,pagingOrNot:"1"}));return d?[]:(t.pagination.total=R.data.totalCount,r(R==null?void 0:R.data.cooperatelineList))}),P=()=>{if(t.selectedKeys.length===0)return B.warning("请选择至少一条线路");const R=f.value.filter(d=>t.selectedKeys.includes(d.id));k("confirm",R),k("close")};return(R,d)=>{const o=i("a-input"),_=i("a-form-item"),u=i("a-button"),m=i("a-space"),L=i("router-link"),$=i("a-table"),Y=i("a-modal");return M(),z(Y,{top:"10%",width:"1000px","unmount-on-close":"",title:"选择合作线路",visible:"","align-center":!1,"mask-closable":!1,"ok-loading":e(v)==="okLoading",onCancel:d[2]||(d[2]=T=>k("close")),onOk:P},{default:l(()=>[a(m,{align:"start",class:"box-flex"},{default:l(()=>[a(_,{label:"合作线路名称:",style:{width:"400px"}},{default:l(()=>[a(o,{size:"large",modelValue:e(V).linename,"onUpdate:modelValue":d[0]||(d[0]=T=>e(V).linename=T),placeholder:"请输入合作线路名称"},null,8,["modelValue"])]),_:1}),a(u,{size:"large",type:"primary",onClick:e(p)},{default:l(()=>[S("搜索")]),_:1},8,["onClick"])]),_:1}),a($,{"selected-keys":e(t).selectedKeys,"onUpdate:selectedKeys":d[1]||(d[1]=T=>e(t).selectedKeys=T),class:"zs-table","row-key":"id",data:e(f),"row-selection":e(t).rowSelection,bordered:e(t).bordered,pagination:e(t).pagination,size:e(t).size,columns:e(s),stripe:e(t).stripe,loading:e(y)},{operate:l(({record:T})=>[a(m,{size:"mini"},{default:l(()=>[a(L,{to:`/system/supplierBasicManage/operate?id=${T.id}`},{default:l(()=>[a(u,{type:"text"},{default:l(()=>[S("选择")]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:1},8,["selected-keys","data","row-selection","bordered","pagination","size","columns","stripe","loading"])]),_:1},8,["ok-loading"])}}}),ge=I({name:"ZsAddLine"}),ve=I({...ge,props:{isReadOnly:{type:Boolean,default:!1}},setup(g,{expose:b}){b({validateData:()=>!!c.value.length,getFormData:()=>c.value});const v=Z(),c=G([]),[V,D]=H(null),C=p=>{p.forEach(r=>{c.value.some(x=>x.linename===r.linename)||c.value.push(r)})},s=p=>{c.value.splice(p,1)},t=async()=>{const{res:p,err:r}=await w(()=>q.getSupplierCooperationRouteList({id:v.query.id}));r||p!=null&&p.data.supCoopLineList&&(p!=null&&p.data.supCoopLineList.length)&&(c.value=p==null?void 0:p.data.supCoopLineList)};return v.query.id&&t(),(p,r)=>{const x=i("icon-plus"),N=i("a-button"),U=i("a-table"),k=i("a-card");return M(),oe("div",null,[a(k,{title:"线路设定",bordered:!1,class:"general-card margin-top"},{extra:l(()=>[a(N,{type:"outline",disabled:p.isReadOnly,onClick:r[0]||(r[0]=f=>e(D)("合作线路"))},{icon:l(()=>[a(x)]),default:l(()=>[S(" 添加线路 ")]),_:1},8,["disabled"])]),default:l(()=>[a(U,{size:"large",columns:e(_e),data:c.value,pagination:!1,bordered:!1},{operate:l(({rowIndex:f})=>[a(N,{type:"text",disabled:p.isReadOnly,status:"danger",onClick:y=>s(f)},{default:l(()=>[S("删除")]),_:2},1032,["disabled","onClick"])]),_:1},8,["columns","data"])]),_:1}),e(V)==="合作线路"?(M(),z(ye,{key:0,"disabled-data":c.value,onConfirm:C,onClose:r[1]||(r[1]=f=>e(D)(""))},null,8,["disabled-data"])):J("",!0)])}}}),Ve=[{title:"结算比率(%)	",dataIndex:"interestRate",slotName:"interestRate"},{title:"利率生效时间	",dataIndex:"startDate",slotName:"startDate"},{title:"利率失效时间",dataIndex:"endDate",slotName:"endDate"},{title:"操作",dataIndex:"operate",align:"center",width:100,slotName:"operate"}],De={class:"box-flex"},Ne={class:"box-flex"},ke=I({name:"ZsInterestRate"}),Re=I({...ke,props:{isReadOnly:{type:Boolean,default:!1}},setup(g,{expose:b}){b({validateData:()=>c.value.every(s=>s.ratio&&s.startTime&&s.endTime),getFormData:()=>c.value});const v=Z(),c=G([]),V=()=>{c.value.push({ratio:"",startTime:"",endTime:""})},D=s=>{c.value.splice(s,1)},C=async()=>{const{res:s,err:t}=await w(()=>q.getSupplierInterestRateList({id:v.query.id}));t||s!=null&&s.data.subRadioSetList&&(s!=null&&s.data.subRadioSetList.length)&&(c.value=s==null?void 0:s.data.subRadioSetList)};return v.query.id&&C(),(s,t)=>{const p=i("icon-plus"),r=i("a-button"),x=i("a-input-number"),N=i("a-date-picker"),U=i("a-table"),k=i("a-card");return M(),z(k,{title:"利率信息",bordered:!1,class:"general-card margin-top"},{extra:l(()=>[a(r,{type:"outline",disabled:s.isReadOnly,onClick:V},{icon:l(()=>[a(p)]),default:l(()=>[S(" 添加利率 ")]),_:1},8,["disabled"])]),default:l(()=>[a(U,{size:"large",columns:e(Ve),data:c.value,pagination:!1,bordered:!1},{interestRate:l(({record:f})=>[O("div",null,[a(x,{max:100,min:0,disabled:s.isReadOnly,modelValue:f.ratio,"onUpdate:modelValue":y=>f.ratio=y,size:"large",placeholder:"请输入结算比率"},null,8,["disabled","modelValue","onUpdate:modelValue"])])]),startDate:l(({record:f})=>[O("div",De,[a(N,{modelValue:f.startTime,"onUpdate:modelValue":y=>f.startTime=y,size:"large",class:"flex1",disabled:s.isReadOnly,"value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择利率生效时间"},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),endDate:l(({record:f})=>[O("div",Ne,[a(N,{modelValue:f.endTime,"onUpdate:modelValue":y=>f.endTime=y,class:"flex1",size:"large",disabled:s.isReadOnly,"value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择利率失效时间"},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),operate:l(({rowIndex:f})=>[a(r,{type:"text",disabled:s.isReadOnly,status:"danger",onClick:y=>D(f)},{default:l(()=>[S("删除")]),_:2},1032,["disabled","onClick"])]),_:1},8,["columns","data"])]),_:1})}}});const xe=X(Re,[["__scopeId","data-v-9da1a1df"]]),Te=g=>(ue("data-v-f1b04fc5"),g=g(),me(),g),we=Te(()=>O("div",{style:{height:"100px"}},null,-1)),Se={class:"orderSubmit-footer box-flex jc-fe"},Ie=I({name:"SystemSupplierBasicOperate"}),Le=I({...Ie,setup(g){const b=Z(),v=E(),c=E(),{jumpTabName:V}=ne(),{getDictionaryInfo:D}=de(),[C,s]=H(null),{form:t,formRef:p,formPlaceholder:r}=W(()=>({supName:"",supType:"",supLevel:"",province:"",city:"",companyName:"",linkman:"",mobile:"",settleUserName:"",settleNum:"",settleBankName:"",settleBankNo:"",legalPerson:"",permitNo:"",startTime:"",endTime:"",state:"",supDesc:"",supInfo:"",remark:""})),x={supName:{required:!0,message:"请输入供应商名称"},supType:{required:!0,message:"请选择供应商类型"},supLevel:{required:!0,message:"请选择供应商等级"},province:{required:!0,message:"请选择所属省"},city:{required:!0,message:"请选择所属市"},linkman:{required:!0,message:"请输入供应商联系人"},mobile:{required:!0,validator:(d,o)=>{d&&!ce(d)&&o("请输入正确的的手机号")}},permitNo:{required:!0,message:"请输入经营许可证编号"},startTime:{required:!0,message:"请输入签约生效时间"},endTime:{required:!0,validator:(d,o)=>{h(d).isBefore(h(t.value.startTime))&&o("失效时间必须大于签约时间")}}},N=async d=>{const{res:o}=await w(()=>pe.getAreaInfo(d));return(o==null?void 0:o.data)??[]},{data:U}=se(async()=>await N({parentNo:"86"}),[]),{data:k}=ie(async()=>await N({parentNo:t.value.province}),{watchSource:()=>t.value.province,defaultValue:[]}),f=()=>{p.value.validate(d=>{if(d)return B.error("请检查供应商信息填写正确");if(!v.value.validateData())return B.error("请检查利率信息填写正确");if(!c.value.validateData())return B.error("请选择合作线路");b.query.id?y("editSupplier"):y("addSupplier")})},y=async d=>{s("okLoading");const{err:o,res:_}=await w(()=>q[d]({...t.value,areaNo:t.value.city}));if(o)return s("");const[u,m]=await Promise.all([K(_.data.id),P(_.data.id)]);s(""),u&&m&&(B.success("保存成功"),V())},K=async d=>{const{err:o}=await w(()=>q.addSupplierLine({id:d,supName:t.value.supName,supCoopLineList:c.value.getFormData()}));return!o},P=async d=>{const{err:o}=await w(()=>q.addSupplierInterestRate({id:d,supName:t.value.supName,supRadioSetList:v.value.getFormData()}));return!o},R=async()=>{const{res:d,err:o}=await w(()=>q.getSupplierDetail({id:b.query.id}));o||(t.value=d==null?void 0:d.data)};return b.query.id&&R(),(d,o)=>{const _=i("a-input"),u=i("a-form-item"),m=i("a-grid-item"),L=i("a-select"),$=i("a-date-picker"),Y=i("a-textarea"),T=i("a-grid"),Q=i("a-form"),ee=i("a-card"),F=i("a-button"),ae=i("a-space");return M(),z(fe,null,{default:l(()=>[a(ee,{title:e(re)("供应商",!!e(b).query.id),bordered:!1,class:"general-card"},{default:l(()=>[a(Q,{ref_key:"formRef",ref:p,model:e(t),"label-align":"left",size:"large",disabled:!!e(b).query.isReadOnly,"auto-label-width":"",rules:x},{default:l(()=>[a(T,{cols:3,"col-gap":12},{default:l(()=>[a(m,null,{default:l(()=>[a(u,{label:"供应商名称:",field:"supName",required:""},{default:l(()=>[a(_,{modelValue:e(t).supName,"onUpdate:modelValue":o[0]||(o[0]=n=>e(t).supName=n),modelModifiers:{trim:!0},placeholder:"请输入供应商名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商类型:",field:"supType",required:""},{default:l(()=>[a(L,{modelValue:e(t).supType,"onUpdate:modelValue":o[1]||(o[1]=n=>e(t).supType=n),placeholder:"请选择供应商类型",options:e(D)("supType"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商等级:",field:"supLevel",required:""},{default:l(()=>[a(L,{modelValue:e(t).supLevel,"onUpdate:modelValue":o[2]||(o[2]=n=>e(t).supLevel=n),placeholder:"请选择供应商等级",options:e(D)("supLevel"),"field-names":{label:"detailName",value:"detailCode"}},null,8,["modelValue","options"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"所属省:",field:"province",required:""},{default:l(()=>[a(L,{modelValue:e(t).province,"onUpdate:modelValue":o[3]||(o[3]=n=>e(t).province=n),options:e(U),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属省"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"所属市:",field:"city",required:""},{default:l(()=>[a(L,{modelValue:e(t).city,"onUpdate:modelValue":o[4]||(o[4]=n=>e(t).city=n),options:e(k),"field-names":{label:"areaName",value:"areaNo"},"allow-search":"",placeholder:"请选择所属市"},null,8,["modelValue","options"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商实际名称:",field:"companyName"},{default:l(()=>[a(_,{modelValue:e(t).companyName,"onUpdate:modelValue":o[5]||(o[5]=n=>e(t).companyName=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入供应商实际名称")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商联系人:",field:"linkman",required:""},{default:l(()=>[a(_,{modelValue:e(t).linkman,"onUpdate:modelValue":o[6]||(o[6]=n=>e(t).linkman=n),modelModifiers:{trim:!0},placeholder:"请输入供应商联系人"},null,8,["modelValue"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商手机:",field:"mobile",required:""},{default:l(()=>[a(_,{modelValue:e(t).mobile,"onUpdate:modelValue":o[7]||(o[7]=n=>e(t).mobile=n),modelModifiers:{trim:!0},placeholder:"请输入供应商联系人手机号"},null,8,["modelValue"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"户名(公户):",field:"settleUserName"},{default:l(()=>[a(_,{modelValue:e(t).settleUserName,"onUpdate:modelValue":o[8]||(o[8]=n=>e(t).settleUserName=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入供应商户名(公户)")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"账号:",field:"settleNum"},{default:l(()=>[a(_,{modelValue:e(t).settleNum,"onUpdate:modelValue":o[9]||(o[9]=n=>e(t).settleNum=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入账号")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"开户行:",field:"settleBankName"},{default:l(()=>[a(_,{modelValue:e(t).settleBankName,"onUpdate:modelValue":o[10]||(o[10]=n=>e(t).settleBankName=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入开户行")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"联行号:",field:"settleBankNo"},{default:l(()=>[a(_,{modelValue:e(t).settleBankNo,"onUpdate:modelValue":o[11]||(o[11]=n=>e(t).settleBankNo=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入联行号")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"法人:",field:"legalPerson"},{default:l(()=>[a(_,{modelValue:e(t).legalPerson,"onUpdate:modelValue":o[12]||(o[12]=n=>e(t).legalPerson=n),modelModifiers:{trim:!0},placeholder:e(r)("请输入法人")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"经营许可证编号:",field:"permitNo",required:""},{default:l(()=>[a(_,{modelValue:e(t).permitNo,"onUpdate:modelValue":o[13]||(o[13]=n=>e(t).permitNo=n),modelModifiers:{trim:!0},placeholder:"请输入经营许可证编号"},null,8,["modelValue"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"签约生效时间:",field:"startTime",required:""},{default:l(()=>[a($,{modelValue:e(t).startTime,"onUpdate:modelValue":o[14]||(o[14]=n=>e(t).startTime=n),class:"flex1","value-format":"YYYY-MM-DD HH:mm:ss",disabledDate:n=>e(h)(n).isBefore(e(h)()),placeholder:"请选择签约生效时间"},null,8,["modelValue","disabledDate"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"失效时间:",field:"endTime",required:""},{default:l(()=>[a($,{modelValue:e(t).endTime,"onUpdate:modelValue":o[15]||(o[15]=n=>e(t).endTime=n),class:"flex1","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择失效时间",disabledDate:n=>e(h)(n).isBefore(e(h)())},null,8,["modelValue","disabledDate"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"状态:",field:"state"},{default:l(()=>[a(L,{modelValue:e(t).state,"onUpdate:modelValue":o[16]||(o[16]=n=>e(t).state=n),placeholder:e(r)("请选择状态"),"field-names":{label:"detailName",value:"detailCode"},options:e(D)("supState")},null,8,["modelValue","placeholder","options"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商说明:",field:"supDesc"},{default:l(()=>[a(Y,{modelValue:e(t).supDesc,"onUpdate:modelValue":o[17]||(o[17]=n=>e(t).supDesc=n),modelModifiers:{trim:!0},"max-length":200,placeholder:e(r)("请输入供应商说明")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"供应商地址:",field:"supInfo"},{default:l(()=>[a(Y,{modelValue:e(t).supInfo,"onUpdate:modelValue":o[18]||(o[18]=n=>e(t).supInfo=n),modelModifiers:{trim:!0},"max-length":200,placeholder:e(r)("请输入供应商地址")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(m,null,{default:l(()=>[a(u,{label:"备注:",field:"remark"},{default:l(()=>[a(Y,{modelValue:e(t).remark,"onUpdate:modelValue":o[19]||(o[19]=n=>e(t).remark=n),modelModifiers:{trim:!0},"max-length":200,placeholder:e(r)("请输入备注")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["title"]),a(xe,{ref_key:"interestRateRef",ref:v,isReadOnly:!!e(b).query.isReadOnly},null,8,["isReadOnly"]),a(ve,{ref_key:"lineRef",ref:c,isReadOnly:!!e(b).query.isReadOnly},null,8,["isReadOnly"]),we,O("div",Se,[a(ae,null,{default:l(()=>[e(b).query.isReadOnly?J("",!0):(M(),z(F,{key:0,type:"primary",loading:e(C)==="确定",onClick:f},{default:l(()=>[S("确定")]),_:1},8,["loading"])),a(F,{onClick:o[20]||(o[20]=()=>e(V)())},{default:l(()=>[S("返回")]),_:1})]),_:1})])]),_:1})}}});const he=X(Le,[["__scopeId","data-v-f1b04fc5"]]);export{he as default};
